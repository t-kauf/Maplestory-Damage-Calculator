{
  "version": 3,
  "sources": ["results-display.ts"],
  "sourcesContent": ["// Results display functionality\r\n\r\nimport { formatNumber } from '@utils/formatters.js';\r\nimport { StatCalculationService, type DamageResult } from '@ts/services/stat-calculation-service.js';\r\nimport { BaseStats } from '@ts/types/loadout.js';\r\nimport { STAT } from '@ts/types/constants.js';\r\nimport { loadoutStore } from '@ts/store/loadout.store';\r\n\r\n// ============================================================================\r\n// TYPES\r\n// ============================================================================\r\n\r\n/**\r\n * Damage values for equipped item comparison\r\n */\r\nexport interface EquippedDamageValues {\r\n    dpsBoss: number;\r\n    expectedDamageBoss: number;\r\n    dpsNormal: number;\r\n    expectedDamageNormal: number;\r\n}\r\n\r\n/**\r\n * Percent change badge result\r\n */\r\ninterface PercentChangeBadge {\r\n    badge: string;\r\n    valueClass: string;\r\n}\r\n\r\n// ============================================================================\r\n// WINDOW GLOBALS\r\n// ============================================================================\r\n\r\nwindow.calculateEquipmentSlotDPS = calculateEquipmentSlotDPS;\r\nwindow.toggleSubDetails = toggleSubDetails;\r\nwindow.toggleDetails = toggleDetails;\r\n\r\n// ============================================================================\r\n// DISPLAY RESULTS\r\n// ============================================================================\r\n\r\n/**\r\n * Passive gains breakdown structure\r\n */\r\ninterface PassiveGainsData {\r\n    statChanges: Record<string, number>;\r\n    breakdown: Array<{\r\n        passive: string;\r\n        stat: string;\r\n        statDisplay?: string;\r\n        baseValue: number;\r\n        bonusValue: number;\r\n        gain: number;\r\n        isPercent: boolean;\r\n        note?: string;\r\n    }>;\r\n    complexPassives: Array<{\r\n        passive: string;\r\n        stat?: string;\r\n        baseValue?: number;\r\n        bonusValue?: number;\r\n        gain?: number;\r\n        isPercent?: boolean;\r\n        note?: string;\r\n    }>;\r\n    complexStatChanges: Record<string, number>;\r\n}\r\n\r\n/**\r\n * Display damage calculation results as HTML\r\n */\r\nexport function displayResults(\r\n    itemName: string,\r\n    stats: BaseStats,\r\n    uniqueId: string,\r\n    isEquipped: boolean = false,\r\n    equippedDamageValues: EquippedDamageValues | null = null,\r\n    passiveGainsData?: PassiveGainsData\r\n): string {\r\n    // Extract passive gains breakdown from stats\r\n    const passiveGainsBreakdown = passiveGainsData ? { comparison: passiveGainsData } : null;\r\n\r\n    // Use StatCalculationService for consistent damage calculation\r\n    const service = new StatCalculationService(stats);\r\n    const bossResults: DamageResult = service.compute('boss');\r\n    const normalResults: DamageResult = service.compute('normal');\r\n\r\n    const itemClass = isEquipped ? 'equipped-item' : 'comparison-item';\r\n\r\n    const getPercentChangeBadge = (currentValue: number, referenceValue: number): PercentChangeBadge => {\r\n        if (!referenceValue || referenceValue === 0) return { badge: '', valueClass: '' };\r\n        const changePercentage = ((currentValue - referenceValue) / referenceValue) * 100;\r\n        const badgeClass = changePercentage >= 0 ? 'positive' : 'negative';\r\n        const valueClass = changePercentage >= 0 ? 'positive' : 'negative';\r\n        const changeSign = changePercentage >= 0 ? '+' : '';\r\n        const badge = `<span class=\"percent-change-badge ${badgeClass}\">${changeSign}${changePercentage.toFixed(2)}%</span>`;\r\n        return { badge, valueClass };\r\n    };\r\n\r\n    const bossDpsChange = equippedDamageValues\r\n        ? getPercentChangeBadge(bossResults.dps, equippedDamageValues.dpsBoss)\r\n        : { badge: '', valueClass: '' };\r\n    const normalDpsChange = equippedDamageValues\r\n        ? getPercentChangeBadge(normalResults.dps, equippedDamageValues.dpsNormal)\r\n        : { badge: '', valueClass: '' };\r\n    const expectedBossDamagePercentChange = equippedDamageValues\r\n        ? getPercentChangeBadge(bossResults.expectedDamage, equippedDamageValues.expectedDamageBoss).badge\r\n        : '';\r\n    const expectedNormalDamagePercentChange = equippedDamageValues\r\n        ? getPercentChangeBadge(normalResults.expectedDamage, equippedDamageValues.expectedDamageNormal).badge\r\n        : '';\r\n\r\n    // Generate passive gains breakdown HTML\r\n    let passiveGainsHTML = '';\r\n\r\n    if (passiveGainsBreakdown && passiveGainsBreakdown.comparison) {\r\n        const gains = passiveGainsBreakdown.comparison;\r\n\r\n        // Mapping for friendly stat names\r\n        const statDisplayNames: Record<string, string> = {\r\n            'attackSpeed': 'Attack Speed',\r\n            'minDamage': 'Min Damage',\r\n            'maxDamage': 'Max Damage',\r\n            'critRate': 'Critical Rate',\r\n            'critDamage': 'Critical Damage',\r\n            'statDamage': 'Stat Damage',\r\n            'skillDamage': 'Skill Damage',\r\n            'damage': 'Damage',\r\n            'bossDamage': 'Boss Damage',\r\n            'normalDamage': 'Normal Damage',\r\n            'attack': 'Attack',\r\n            'mainStat': 'Main Stat',\r\n            'basicAttackDamage': 'Basic Attack Damage',\r\n            'damageAmp': 'Damage Amplification',\r\n            'finalDamage': 'Final Damage'\r\n        };\r\n\r\n        if (gains.breakdown && gains.breakdown.length > 0) {\r\n            passiveGainsHTML = `\r\n                <div class=\"damage-box\">\r\n                    <h3 onclick=\"toggleSubDetails('passive-gains-${uniqueId}')\">Passive Skill Gains <span id=\"passive-gains-${uniqueId}-icon\">\u25BC</span></h3>\r\n                    <div id=\"passive-gains-${uniqueId}\" class=\"collapsible-section\">\r\n                        ${gains.breakdown.filter(item => item.gain !== 0).map(item => {\r\n                            const statLabel = item.statDisplay || statDisplayNames[item.stat || ''] || item.stat || '';\r\n                            const percentSign = item.isPercent ? '%' : '';\r\n                            const gainSign = item.gain >= 0 ? '+' : '';\r\n                            const fromTo = `${item.baseValue.toFixed(2)}${percentSign} \u2192 ${item.bonusValue.toFixed(2)}${percentSign}`;\r\n                            const note = item.note ? `<div class=\"passive-note\">${item.note}</div>` : '';\r\n                            return `<div class=\"passive-gain-card\">\r\n                                <div class=\"passive-header\">\r\n                                    <span class=\"passive-name\">${item.passive}</span>\r\n                                    <span class=\"passive-gain-value\">${gainSign}${item.gain.toFixed(2)}${percentSign}</span>\r\n                                </div>\r\n                                <div class=\"passive-details\">\r\n                                    <span class=\"passive-stat-label\">${statLabel}</span>\r\n                                    <span class=\"passive-from-to\">${fromTo}</span>\r\n                                </div>\r\n                                ${note}\r\n                            </div>`;\r\n                        }).join('')}\r\n                    </div>\r\n                </div>\r\n            `;\r\n        }\r\n\r\n        if (gains.complexPassives && gains.complexPassives.length > 0) {\r\n            passiveGainsHTML += `\r\n                <div class=\"damage-box\">\r\n                    <h3 onclick=\"toggleSubDetails('complex-passives-${uniqueId}')\">Complex Passives (Not in DPS) <span id=\"complex-passives-${uniqueId}-icon\">\u25BC</span></h3>\r\n                    <div id=\"complex-passives-${uniqueId}\" class=\"collapsible-section\">\r\n                        ${gains.complexPassives.filter(item => item.gain !== 0).map(item => {\r\n                            // If we have gain data, format it with the stat changes\r\n                            if (item.stat && item.gain !== undefined && item.baseValue !== undefined && item.bonusValue !== undefined) {\r\n                                const statName = statDisplayNames[item.stat] || item.stat;\r\n                                const percentSign = item.isPercent ? '%' : '';\r\n                                const gainSign = item.gain >= 0 ? '+' : '';\r\n                                const fromTo = `${item.baseValue.toFixed(2)}${percentSign} \u2192 ${item.bonusValue.toFixed(2)}${percentSign}`;\r\n                                const note = item.note ? `<div class=\"passive-note\">${item.note}</div>` : '';\r\n                                return `<div class=\"passive-gain-card\">\r\n                                    <div class=\"passive-header\">\r\n                                        <span class=\"passive-name\">${item.passive}</span>\r\n                                        <span class=\"passive-gain-value\">${gainSign}${item.gain.toFixed(2)}${percentSign}</span>\r\n                                    </div>\r\n                                    <div class=\"passive-details\">\r\n                                        <span class=\"passive-stat-label\">${statName}</span>\r\n                                        <span class=\"passive-from-to\">${fromTo}</span>\r\n                                    </div>\r\n                                    ${note}\r\n                                </div>`;\r\n                            } else {\r\n                                // Otherwise just show the note\r\n                                const note = item.note || '';\r\n                                return `<div class=\"passive-gain-card\">\r\n                                    <div class=\"passive-header\">\r\n                                        <span class=\"passive-name\">${item.passive}</span>\r\n                                    </div>\r\n                                    ${note ? `<div class=\"passive-note\">${note}</div>` : ''}\r\n                                </div>`;\r\n                            }\r\n                        }).join('')}\r\n                    </div>\r\n                </div>\r\n            `;\r\n        }\r\n    }\r\n\r\n    const html = `\r\n        <div class=\"result-panel ${itemClass}\">\r\n            <h3>${itemName}</h3>\r\n\r\n        <div class=\"expected-damage\">\r\n            <div class=\"label\">DPS (Boss)</div>\r\n            <div class=\"value ${bossDpsChange.valueClass}\">${formatNumber(bossResults.dps)}${bossDpsChange.badge}</div>\r\n        </div>\r\n\r\n        <div class=\"expected-damage\">\r\n            <div class=\"label\">DPS (Normal)</div>\r\n            <div class=\"value ${normalDpsChange.valueClass}\">${formatNumber(normalResults.dps)}${normalDpsChange.badge}</div>\r\n        </div>\r\n\r\n        <div class=\"toggle-details\" onclick=\"toggleDetails('${uniqueId}', event)\">\r\n            Show Detailed Breakdown\r\n        </div>\r\n\r\n        <div id=\"details-${uniqueId}\" class=\"collapsible-section\">\r\n            <div class=\"damage-box\">\r\n                <h3 onclick=\"toggleSubDetails('stats-${uniqueId}')\">Stats Used <span id=\"stats-${uniqueId}-icon\">\u25BC</span></h3>\r\n                <div id=\"stats-${uniqueId}\" class=\"collapsible-section\">\r\n                    <div class=\"damage-row\">\r\n                        <span class=\"damage-label\">Attack:</span>\r\n                        <span class=\"damage-value\">${formatNumber(stats.ATTACK)}</span>\r\n                    </div>\r\n                    <div class=\"damage-row\">\r\n                        <span class=\"damage-label\">Critical Rate:</span>\r\n                        <span class=\"damage-value\">${stats.CRIT_RATE.toFixed(2)}%</span>\r\n                    </div>\r\n                    <div class=\"damage-row\">\r\n                        <span class=\"damage-label\">Critical Damage:</span>\r\n                        <span class=\"damage-value\">${stats.CRIT_DAMAGE.toFixed(2)}%</span>\r\n                    </div>\r\n                    <div class=\"damage-row\">\r\n                        <span class=\"damage-label\">Stat Damage:</span>\r\n                        <span class=\"damage-value\">${stats.STAT_DAMAGE.toFixed(2)}%</span>\r\n                    </div>\r\n                    <div class=\"damage-row\">\r\n                        <span class=\"damage-label\">Damage:</span>\r\n                        <span class=\"damage-value\">${stats.DAMAGE.toFixed(2)}%</span>\r\n                    </div>\r\n                    <div class=\"damage-row\">\r\n                        <span class=\"damage-label\">Boss Monster Damage:</span>\r\n                        <span class=\"damage-value\">${stats.BOSS_DAMAGE.toFixed(2)}%</span>\r\n                    </div>\r\n                    <div class=\"damage-row\">\r\n                        <span class=\"damage-label\">Normal Monster Damage:</span>\r\n                        <span class=\"damage-value\">${stats.NORMAL_DAMAGE.toFixed(2)}%</span>\r\n                    </div>\r\n                    <div class=\"damage-row\">\r\n                        <span class=\"damage-label\">Final Damage:</span>\r\n                        <span class=\"damage-value\">${stats.FINAL_DAMAGE.toFixed(2)}%</span>\r\n                    </div>\r\n                    <div class=\"damage-row\">\r\n                        <span class=\"damage-label\">Damage Amplification:</span>\r\n                        <span class=\"damage-value\">${stats.DAMAGE_AMP.toFixed(2)}</span>\r\n                    </div>\r\n                    <div class=\"damage-row\" style=\"display: none;\">\r\n                        <span class=\"damage-label\">Defense Penetration:</span>\r\n                        <span class=\"damage-value\">${stats.DEF_PEN.toFixed(2)}%</span>\r\n                    </div>\r\n                    <div class=\"damage-row\">\r\n                        <span class=\"damage-label\">Skill Coefficient:</span>\r\n                        <span class=\"damage-value\">${stats.SKILL_COEFFICIENT.toFixed(2)}%</span>\r\n                    </div>\r\n                    <div class=\"damage-row\">\r\n                        <span class=\"damage-label\">Skill Mastery:</span>\r\n                        <span class=\"damage-value\">${stats.MASTERY.toFixed(2)}%</span>\r\n                    </div>\r\n                    <div class=\"damage-row\">\r\n                        <span class=\"damage-label\">Skill Mastery (Boss Only):</span>\r\n                        <span class=\"damage-value\">${stats.BOSS_MASTERY.toFixed(2)}%</span>\r\n                    </div>\r\n                    <div class=\"damage-row\">\r\n                        <span class=\"damage-label\">Attack Speed:</span>\r\n                        <span class=\"damage-value\">${stats.ATTACK_SPEED.toFixed(2)}%</span>\r\n                    </div>\r\n                    <div class=\"damage-row\">\r\n                        <span class=\"damage-label\">Min Damage Multiplier:</span>\r\n                        <span class=\"damage-value\">${stats.MIN_DAMAGE.toFixed(2)}%</span>\r\n                    </div>\r\n                    <div class=\"damage-row\">\r\n                        <span class=\"damage-label\">Max Damage Multiplier:</span>\r\n                        <span class=\"damage-value\">${stats.MAX_DAMAGE.toFixed(2)}%</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            ${passiveGainsHTML}\r\n\r\n            <div class=\"damage-box\">\r\n                <h3 onclick=\"toggleSubDetails('multipliers-${uniqueId}')\">Multipliers Applied <span id=\"multipliers-${uniqueId}-icon\">\u25BC</span></h3>\r\n                <div id=\"multipliers-${uniqueId}\" class=\"collapsible-section\">\r\n                    <div class=\"damage-row\">\r\n                        <span class=\"damage-label\">Damage Amp Multiplier:</span>\r\n                        <span class=\"damage-value\">${bossResults.damageAmpMultiplier.toFixed(4)}x</span>\r\n                    </div>\r\n                    <div class=\"damage-row\">\r\n                        <span class=\"damage-label\">Attack Speed Multiplier:</span>\r\n                        <span class=\"damage-value\">${bossResults.attackSpeedMultiplier.toFixed(4)}x</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"damage-box\">\r\n                <h3 onclick=\"toggleSubDetails('boss-${uniqueId}')\">VS Boss Monsters <span id=\"boss-${uniqueId}-icon\">\u25BC</span></h3>\r\n                <div id=\"boss-${uniqueId}\" class=\"collapsible-section\">\r\n                <div class=\"damage-row\">\r\n                    <span class=\"damage-label\">Expected Damage:</span>\r\n                    <span class=\"damage-value\">${formatNumber(bossResults.expectedDamage)}</span>\r\n                </div>\r\n                <div class=\"damage-row\">\r\n                    <span class=\"damage-label\">Base Damage:</span>\r\n                    <span class=\"damage-value\">${formatNumber(bossResults.baseDamage)}</span>\r\n                </div>\r\n                <div class=\"damage-row\">\r\n                    <span class=\"damage-label\">Non-Crit MIN:</span>\r\n                    <span class=\"damage-value\">${formatNumber(bossResults.nonCritMin)}</span>\r\n                </div>\r\n                <div class=\"damage-row\">\r\n                    <span class=\"damage-label\">Non-Crit AVG:</span>\r\n                    <span class=\"damage-value\">${formatNumber(bossResults.nonCritAvg)}</span>\r\n                </div>\r\n                <div class=\"damage-row\">\r\n                    <span class=\"damage-label\">Non-Crit MAX:</span>\r\n                    <span class=\"damage-value\">${formatNumber(bossResults.nonCritMax)}</span>\r\n                </div>\r\n                <div class=\"damage-row\">\r\n                    <span class=\"damage-label\">Crit MIN:</span>\r\n                    <span class=\"damage-value\">${formatNumber(bossResults.critMin)}</span>\r\n                </div>\r\n                <div class=\"damage-row\">\r\n                    <span class=\"damage-label\">Crit AVG:</span>\r\n                    <span class=\"damage-value\">${formatNumber(bossResults.critAvg)}</span>\r\n                </div>\r\n                <div class=\"damage-row\">\r\n                    <span class=\"damage-label\">Crit MAX:</span>\r\n                    <span class=\"damage-value\">${formatNumber(bossResults.critMax)}</span>\r\n                </div>\r\n            </div>\r\n            </div>\r\n\r\n            <div class=\"damage-box\">\r\n                <h3 onclick=\"toggleSubDetails('normal-${uniqueId}')\">VS Normal Monsters <span id=\"normal-${uniqueId}-icon\">\u25BC</span></h3>\r\n                <div id=\"normal-${uniqueId}\" class=\"collapsible-section\">\r\n                <div class=\"damage-row\">\r\n                    <span class=\"damage-label\">Expected Damage:</span>\r\n                    <span class=\"damage-value\">${formatNumber(normalResults.expectedDamage)}</span>\r\n                </div>\r\n                <div class=\"damage-row\">\r\n                    <span class=\"damage-label\">Base Damage:</span>\r\n                    <span class=\"damage-value\">${formatNumber(normalResults.baseDamage)}</span>\r\n                </div>\r\n                <div class=\"damage-row\">\r\n                    <span class=\"damage-label\">Non-Crit MIN:</span>\r\n                    <span class=\"damage-value\">${formatNumber(normalResults.nonCritMin)}</span>\r\n                </div>\r\n                <div class=\"damage-row\">\r\n                    <span class=\"damage-label\">Non-Crit AVG:</span>\r\n                    <span class=\"damage-value\">${formatNumber(normalResults.nonCritAvg)}</span>\r\n                </div>\r\n                <div class=\"damage-row\">\r\n                    <span class=\"damage-label\">Non-Crit MAX:</span>\r\n                    <span class=\"damage-value\">${formatNumber(normalResults.nonCritMax)}</span>\r\n                </div>\r\n                <div class=\"damage-row\">\r\n                    <span class=\"damage-label\">Crit MIN:</span>\r\n                    <span class=\"damage-value\">${formatNumber(normalResults.critMin)}</span>\r\n                </div>\r\n                <div class=\"damage-row\">\r\n                    <span class=\"damage-label\">Crit AVG:</span>\r\n                    <span class=\"damage-value\">${formatNumber(normalResults.critAvg)}</span>\r\n                </div>\r\n                <div class=\"damage-row\">\r\n                    <span class=\"damage-label\">Crit MAX:</span>\r\n                    <span class=\"damage-value\">${formatNumber(normalResults.critMax)}</span>\r\n                </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    `;\r\n\r\n    return html;\r\n}\r\n\r\n// ============================================================================\r\n// TOGGLE FUNCTIONS\r\n// ============================================================================\r\n\r\n/**\r\n * Toggle sub-details sections\r\n */\r\nexport function toggleSubDetails(id: string): void {\r\n    const section = document.getElementById(id);\r\n    const icon = document.getElementById(`${id}-icon`);\r\n    const header = icon?.parentElement;\r\n\r\n    if (section?.classList.contains('expanded')) {\r\n        section.classList.remove('expanded');\r\n        if (header) header.classList.remove('expanded');\r\n    } else {\r\n        section?.classList.add('expanded');\r\n        if (header) header.classList.add('expanded');\r\n    }\r\n}\r\n\r\n/**\r\n * Toggle details sections\r\n */\r\nexport function toggleDetails(id: string, event?: Event): void {\r\n    const detailsSection = document.getElementById(`details-${id}`);\r\n    const toggleButton = event?.target as HTMLElement;\r\n\r\n    if (detailsSection?.classList.contains('expanded')) {\r\n        detailsSection.classList.remove('expanded');\r\n        if (toggleButton) {\r\n            toggleButton.classList.remove('expanded');\r\n            toggleButton.textContent = 'Show Detailed Breakdown';\r\n        }\r\n    } else {\r\n        detailsSection?.classList.add('expanded');\r\n        if (toggleButton) {\r\n            toggleButton.classList.add('expanded');\r\n            toggleButton.textContent = 'Hide Detailed Breakdown';\r\n        }\r\n    }\r\n}\r\n\r\n// ============================================================================\r\n// CALCULATE EQUIPMENT SLOT DPS\r\n// ============================================================================\r\n\r\n/**\r\n * Calculate DPS for each equipment slot\r\n */\r\nexport function calculateEquipmentSlotDPS(): void {\r\n    const baseStats = loadoutStore.getBaseStats();\r\n    const slotNames = ['head', 'cape', 'chest', 'shoulders', 'legs', 'belt', 'gloves', 'boots', 'ring', 'neck', 'eye-accessory'];\r\n\r\n    // Use StatCalculationService for consistent calculations (auto-fetches weaponAttackBonus from state)\r\n    const baseService = new StatCalculationService(baseStats);\r\n    const baselineDPS = baseService.computeDPS('boss');\r\n\r\n    // Track total stats from all slots for total DPS calculation\r\n    let totalAttackFromSlots = 0;\r\n    let totalStatDamageFromSlots = 0;\r\n    let totalDamageAmpFromSlots = 0;\r\n\r\n    slotNames.forEach(slotId => {\r\n        const attackInput = document.getElementById(`slot-${slotId}-attack`) as HTMLInputElement;\r\n        const mainStatInput = document.getElementById(`slot-${slotId}-main-stat`) as HTMLInputElement;\r\n        const damageAmpInput = document.getElementById(`slot-${slotId}-damage-amp`) as HTMLInputElement;\r\n\r\n        const slotAttack = parseFloat(attackInput?.value) || 0;\r\n        const slotMainStat = parseFloat(mainStatInput?.value) || 0;\r\n        const slotDamageAmp = parseFloat(damageAmpInput?.value) || 0;\r\n\r\n        // Convert main stat to stat damage (100:1 ratio)\r\n        const statDamageFromMainStat = slotMainStat / 100;\r\n\r\n        // Add to totals\r\n        totalAttackFromSlots += slotAttack;\r\n        totalStatDamageFromSlots += statDamageFromMainStat;\r\n        totalDamageAmpFromSlots += slotDamageAmp;\r\n\r\n        // Use StatCalculationService chaining API to calculate DPS without this slot\r\n        // The service handles weapon attack bonus automatically\r\n        const withoutSlotDPS = new StatCalculationService(baseStats)\r\n            .subtract(STAT.ATTACK.id, slotAttack)\r\n            .subtract(STAT.STAT_DAMAGE.id, statDamageFromMainStat)\r\n            .subtract(STAT.DAMAGE_AMP.id, slotDamageAmp)\r\n            .computeDPS('boss');\r\n\r\n        // Calculate percentage gain\r\n        const dpsGainPct = ((baselineDPS - withoutSlotDPS) / baselineDPS * 100);\r\n\r\n        // Display results\r\n        const dpsDisplay = document.getElementById(`slot-${slotId}-dps`);\r\n        if (dpsDisplay) dpsDisplay.textContent = `+${dpsGainPct.toFixed(2)}%`;\r\n    });\r\n\r\n    // Calculate total DPS gain from all slots using chaining API\r\n    const withoutAllSlotsDPS = new StatCalculationService(baseStats)\r\n        .subtract(STAT.ATTACK.id, totalAttackFromSlots)\r\n        .subtract(STAT.STAT_DAMAGE.id, totalStatDamageFromSlots)\r\n        .subtract(STAT.DAMAGE_AMP.id, totalDamageAmpFromSlots)\r\n        .computeDPS('boss');\r\n\r\n    const totalDPSGainPct = ((baselineDPS - withoutAllSlotsDPS) / baselineDPS * 100);\r\n\r\n    // Display total DPS gain\r\n    const totalDPSDisplay = document.getElementById('total-slots-dps');\r\n    if (totalDPSDisplay) totalDPSDisplay.textContent = `+${totalDPSGainPct.toFixed(2)}%`;\r\n}\r\n\r\n// ============================================================================\r\n// TYPE AUGMENTATION\r\n// ============================================================================\r\n\r\ndeclare global {\r\n    interface Window {\r\n        calculateEquipmentSlotDPS: typeof calculateEquipmentSlotDPS;\r\n        toggleSubDetails: typeof toggleSubDetails;\r\n        toggleDetails: typeof toggleDetails;\r\n    }\r\n}\r\n"],
  "mappings": "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",
  "names": []
}
