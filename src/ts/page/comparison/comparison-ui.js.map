{
  "version": 3,
  "sources": ["comparison-ui.ts"],
  "sourcesContent": ["/**\r\n * Comparison Equipment UI - Pure UI Module\r\n *\r\n * This module handles all HTML generation and UI event handling for the\r\n * equipment comparison tab, keeping it separate from business logic.\r\n *\r\n * Responsibilities:\r\n * - Generate all HTML for the comparison tab\r\n * - Attach event listeners\r\n * - Handle user interactions\r\n * - Render calculation results\r\n */\r\n\r\nimport {\r\n    getComparisonItems,\r\n    addComparisonItem,\r\n    updateComparisonItem,\r\n    removeComparisonItem,\r\n    addStatLine,\r\n    removeStatLine,\r\n    calculateAllItemsDamage,\r\n    calculateEquippedDamage,\r\n    EQUIPMENT_SLOTS,\r\n    generateDefaultItemName,\r\n    getSlotConfig\r\n} from './comparison';\r\nimport type { ComparisonItem, EquipmentSlotId, ComparisonStatLine } from '@ts/types/page/gear-lab/gear-lab.types';\r\nimport type { StatId } from '@ts/types/constants';\r\nimport { generateStatTypeOptionsHTML } from '@ts/page/equipment/equipment';\r\nimport { loadoutStore } from '@ts/store/loadout.store';\r\nimport { gearLabStore } from '@ts/store/gear-lab-store';\r\nimport { showToast } from '@ts/utils/notifications';\r\nimport { displayResults } from './results-display';\r\nimport { StatCalculationService } from '@ts/services/stat-calculation-service.js';\r\nimport type { EquipmentSlotData } from '@ts/types/page/equipment/equipment.types';\r\n\r\n// ============================================================================\r\n// STATE\r\n// ============================================================================\r\n\r\n/**\r\n * Current selected slot\r\n */\r\nlet currentSlot: EquipmentSlotId = 'head';\r\n\r\n/**\r\n * Currently active comparison item GUID\r\n */\r\nlet activeItemGuid: string | null = null;\r\n\r\n/**\r\n * Last deleted item for undo functionality\r\n */\r\nlet lastDeletedItem: { slotId: EquipmentSlotId; item: ComparisonItem } | null = null;\r\n\r\n/**\r\n * Undo timeout ID\r\n */\r\nlet undoTimeout: number | null = null;\r\n\r\n// ============================================================================\r\n// HTML GENERATION\r\n// ============================================================================\r\n\r\n/**\r\n * Generate slot selector options HTML\r\n */\r\nfunction generateSlotSelectorOptionsHTML(): string {\r\n    return Object.values(EQUIPMENT_SLOTS).map(slot =>\r\n        `<option value=\"${slot.id}\">${slot.name}</option>`\r\n    ).join('');\r\n}\r\n\r\n/**\r\n * Generate the complete HTML for the comparison tab\r\n */\r\nexport function generateComparisonHTML(): string {\r\n    return `\r\n        <!-- Slot Selector with Improved Visual Hierarchy -->\r\n        <div class=\"comparison-slot-selector-wrapper\">\r\n            <div class=\"comparison-slot-selector-inner\">\r\n                <label for=\"comparison-slot-selector\" class=\"comparison-slot-label\">Equipment Slot</label>\r\n                <select id=\"comparison-slot-selector\" class=\"comparison-slot-select\" aria-label=\"Select equipment slot to compare\">\r\n                    ${generateSlotSelectorOptionsHTML()}\r\n                </select>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Two Column Layout with Improved Spacing -->\r\n        <div class=\"comparison-columns-wrapper\">\r\n            <!-- Equipped Item Card -->\r\n            <div class=\"comparison-column\">\r\n                <h3 class=\"comparison-column-header comparison-column-header--equipped\">Currently Equipped</h3>\r\n                <div class=\"equipped-item-card\">\r\n                    <div class=\"equipped-card-header\">\r\n                        <div class=\"equipped-card-title-row\">\r\n                            <span class=\"equipped-card-title\">Equipped Item</span>\r\n                            <span class=\"equipped-card-subtitle\">(stats in base setup)</span>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"equipped-inputs-row\">\r\n                        <div class=\"input-group equipped-input-group\">\r\n                            <label for=\"equipped-name\" class=\"equipped-label\">Name</label>\r\n                            <input type=\"text\" id=\"equipped-name\" value=\"Current Item\" aria-label=\"Equipped item name\" maxlength=\"50\" readonly>\r\n                        </div>\r\n                        <div class=\"input-group equipped-input-group\">\r\n                            <label for=\"equipped-attack\" class=\"equipped-label\">Attack</label>\r\n                            <input type=\"number\" id=\"equipped-attack\" value=\"0\" aria-label=\"Equipped item attack value\" readonly>\r\n                        </div>\r\n                        <div id=\"equipped-main-stat-container\" class=\"input-group equipped-input-group\" style=\"display: none;\">\r\n                            <label for=\"equipped-main-stat\" class=\"equipped-label\">Main Stat</label>\r\n                            <input type=\"number\" step=\"1\" id=\"equipped-main-stat\" value=\"0\" aria-label=\"Equipped item main stat value\" readonly>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"equipped-stats-header\">\r\n                        <label class=\"equipped-stats-label\">Additional Stats</label>\r\n                        <button id=\"equipped-add-stat-btn\" class=\"comparison-action-btn comparison-action-btn--add\" aria-label=\"Add stat to equipped item\" disabled style=\"opacity: 0.5; cursor: not-allowed;\">\r\n                            <svg viewBox=\"0 0 16 16\" fill=\"currentColor\" aria-hidden=\"true\">\r\n                                <path d=\"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z\"/>\r\n                            </svg>\r\n                            <span>Add Stat</span>\r\n                        </button>\r\n                    </div>\r\n                    <div id=\"equipped-stats-container\" class=\"equipped-stats-container\"></div>\r\n                </div>\r\n            </div>\r\n\r\n            <!-- Comparison Items Column -->\r\n            <div class=\"comparison-column\">\r\n                <h3 class=\"comparison-column-header comparison-column-header--comparison\">Comparison Items</h3>\r\n                <!-- Tab Navigation with Enhanced Accessibility -->\r\n                <div id=\"comparison-tabs-container\" class=\"comparison-tabs-container\" role=\"tablist\" aria-label=\"Comparison item tabs\">\r\n                    <button class=\"comparison-add-tab-btn\" data-type=\"add-button\" aria-label=\"Add new comparison item\">\r\n                        <svg viewBox=\"0 0 16 16\" fill=\"currentColor\" aria-hidden=\"true\">\r\n                            <path d=\"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z\"/>\r\n                        </svg>\r\n                        <span>Add Item</span>\r\n                    </button>\r\n                </div>\r\n                <!-- Comparison Items Content -->\r\n                <div id=\"comparison-items-container\" class=\"comparison-items-container\" role=\"presentation\"></div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Calculate Button with Enhanced Styling -->\r\n        <button class=\"comparison-calculate-btn\" aria-label=\"Calculate damage for all comparison items\">\r\n            <svg viewBox=\"0 0 16 16\" fill=\"currentColor\" aria-hidden=\"true\">\r\n                <path d=\"M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 1 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z\"/>\r\n            </svg>\r\n            <span>Calculate All</span>\r\n        </button>\r\n\r\n        <!-- Results Section with Improved Visual Separation -->\r\n        <div class=\"comparison-results-section\">\r\n            <h3 class=\"comparison-results-title\">Comparison Results</h3>\r\n            <div id=\"results-container\" class=\"comparison-results-grid\">\r\n                <!-- Results will be populated by JavaScript -->\r\n            </div>\r\n            <div id=\"results-loading-spinner\" class=\"comparison-loading-spinner\" style=\"display: none;\" aria-live=\"polite\" aria-busy=\"false\">\r\n                <div class=\"spinner\"></div>\r\n                <p class=\"loading-text\">Calculating damage...</p>\r\n            </div>\r\n        </div>\r\n    `;\r\n}\r\n\r\n// ============================================================================\r\n// UI RENDERING\r\n// ============================================================================\r\n\r\n/**\r\n * Render the equipped item display\r\n */\r\nfunction renderEquippedItem(): void {\r\n    const equipmentData = loadoutStore.getEquipmentData();\r\n    const slotData = equipmentData[currentSlot];\r\n    const slotConfig = getSlotConfig(currentSlot);\r\n\r\n    // Update header\r\n    const nameInput = document.getElementById('equipped-name') as HTMLInputElement;\r\n    const attackInput = document.getElementById('equipped-attack') as HTMLInputElement;\r\n    const mainStatContainer = document.getElementById('equipped-main-stat-container') as HTMLElement;\r\n    const mainStatInput = document.getElementById('equipped-main-stat') as HTMLInputElement;\r\n\r\n    // Use slot data name or default\r\n    if (nameInput) nameInput.value = slotData?.name || 'Equipped Item';\r\n    if (attackInput) attackInput.value = slotData?.attack?.toString() || '0';\r\n\r\n    // Show/hide main stat input based on slot config\r\n    if (mainStatContainer && mainStatInput) {\r\n        if (slotConfig?.hasMainStat) {\r\n            mainStatContainer.style.display = '';\r\n            mainStatInput.value = slotData?.mainStat?.toString() || '0';\r\n        } else {\r\n            mainStatContainer.style.display = 'none';\r\n        }\r\n    }\r\n\r\n    // Render stat lines from actual equipped item\r\n    const statsContainer = document.getElementById('equipped-stats-container');\r\n    if (statsContainer) {\r\n        statsContainer.innerHTML = '';\r\n\r\n        // Show up to 3 stat lines from the equipped item (or more if added)\r\n        const statLines = slotData?.statLines || [];\r\n\r\n        // Show at least 3 rows (empty if no data), or more if user added more stats\r\n        const minRows = Math.max(3, statLines.length);\r\n        for (let i = 0; i < minRows; i++) {\r\n            const statLine = statLines[i];\r\n            const statDiv = document.createElement('div');\r\n            statDiv.className = 'equipped-stat-row';\r\n            statDiv.dataset.statIndex = i.toString();\r\n            statDiv.style.cssText = 'display: grid; grid-template-columns: 1fr 80px 32px; gap: 8px; margin-bottom: 6px; align-items: end;';\r\n            statDiv.innerHTML = `\r\n                <div class=\"input-group\">\r\n                    <label style=\"font-size: 0.8em;\">Stat</label>\r\n                    <select class=\"equipped-stat-type\" data-stat-index=\"${i}\" disabled style=\"opacity: 0.5; cursor: not-allowed;\">\r\n                        ${generateStatTypeOptionsHTML()}\r\n                    </select>\r\n                </div>\r\n                <div class=\"input-group\">\r\n                    <label style=\"font-size: 0.8em;\">Value</label>\r\n                    <input type=\"number\" step=\"0.1\" class=\"equipped-stat-value\" data-stat-index=\"${i}\" value=\"${statLine?.value || 0}\" readonly>\r\n                </div>\r\n                <button class=\"equipped-stat-remove\" data-stat-index=\"${i}\" aria-label=\"Remove stat line\" title=\"Remove stat line\" disabled style=\"opacity: 0.5; cursor: not-allowed;\">\r\n                    <svg viewBox=\"0 0 16 16\" fill=\"currentColor\">\r\n                        <path d=\"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z\"/>\r\n                    </svg>\r\n                </button>\r\n            `;\r\n            statsContainer.appendChild(statDiv);\r\n\r\n            // Set the stat type select value if we have data\r\n            if (statLine) {\r\n                const typeSelect = statDiv.querySelector('.equipped-stat-type') as HTMLSelectElement;\r\n                if (typeSelect) typeSelect.value = statLine.type;\r\n            }\r\n        }\r\n    }\r\n\r\n    // No longer attaching event listeners since inputs are now readonly\r\n    // attachEquippedItemEventListeners();\r\n}\r\n\r\n/**\r\n * Render comparison items for the current slot\r\n */\r\nfunction renderComparisonItems(): void {\r\n    const items = getComparisonItems(currentSlot);\r\n    const tabsContainer = document.getElementById('comparison-tabs-container');\r\n    const itemsContainer = document.getElementById('comparison-items-container');\r\n\r\n    if (!tabsContainer || !itemsContainer) return;\r\n\r\n    // Clear existing items (preserve add button)\r\n    const addButton = tabsContainer.querySelector('[data-type=\"add-button\"]');\r\n    tabsContainer.innerHTML = '';\r\n    if (addButton) {\r\n        tabsContainer.appendChild(addButton);\r\n    }\r\n    itemsContainer.innerHTML = '';\r\n\r\n    // Show empty state if no items\r\n    if (items.length === 0) {\r\n        renderEmptyState(itemsContainer);\r\n        return;\r\n    }\r\n\r\n    // Render each item\r\n    items.forEach((item, index) => {\r\n        // Create tab\r\n        const tabButton = document.createElement('button');\r\n        tabButton.className = 'comparison-tab-button';\r\n        tabButton.dataset.guid = item.guid;\r\n        tabButton.setAttribute('role', 'tab');\r\n        tabButton.setAttribute('aria-selected', 'false');\r\n        tabButton.setAttribute('aria-controls', `comparison-item-${item.guid}`);\r\n        tabButton.onclick = () => switchToItem(item.guid);\r\n\r\n        const nameSpan = document.createElement('span');\r\n        nameSpan.className = 'tab-item-name';\r\n        nameSpan.textContent = item.name;\r\n\r\n        const removeButton = document.createElement('button');\r\n        removeButton.className = 'comparison-tab-remove';\r\n        removeButton.setAttribute('aria-label', `Remove ${item.name}`);\r\n        removeButton.onclick = (e) => {\r\n            e.stopPropagation();\r\n            deleteItem(item.guid);\r\n        };\r\n        removeButton.innerHTML = `\r\n            <svg viewBox=\"0 0 16 16\" fill=\"currentColor\" aria-hidden=\"true\">\r\n                <path d=\"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z\"/>\r\n            </svg>\r\n        `;\r\n\r\n        tabButton.appendChild(nameSpan);\r\n        tabButton.appendChild(removeButton);\r\n        tabsContainer.insertBefore(tabButton, addButton);\r\n\r\n        // Create item card\r\n        const itemCard = createItemCard(item, index + 1);\r\n        itemsContainer.appendChild(itemCard);\r\n    });\r\n\r\n    // Select first item by default\r\n    if (items.length > 0 && !activeItemGuid) {\r\n        switchToItem(items[0].guid);\r\n    } else if (activeItemGuid) {\r\n        switchToItem(activeItemGuid);\r\n    }\r\n}\r\n\r\n/**\r\n * Create an item card element\r\n */\r\nfunction createItemCard(item: ComparisonItem, itemNumber: number): HTMLElement {\r\n    const itemDiv = document.createElement('div');\r\n    itemDiv.id = `comparison-item-${item.guid}`;\r\n    itemDiv.dataset.guid = item.guid;\r\n    itemDiv.className = 'comparison-item-card';\r\n    itemDiv.style.display = 'none';\r\n    itemDiv.setAttribute('role', 'tabpanel');\r\n    itemDiv.setAttribute('aria-labelledby', `comparison-tab-${item.guid}`);\r\n\r\n    itemDiv.innerHTML = `\r\n        <div class=\"comparison-card-inner\">\r\n            <div class=\"comparison-card-header\">\r\n                <div class=\"comparison-inputs-row\">\r\n                    <div class=\"input-group comparison-input-group\">\r\n                        <label for=\"item-${item.guid}-name\">Name</label>\r\n                        <input type=\"text\" id=\"item-${item.guid}-name\" value=\"${item.name}\"\r\n                            maxlength=\"50\" aria-label=\"Item name\" data-guid=\"${item.guid}\">\r\n                    </div>\r\n                    <div class=\"input-group comparison-input-group\">\r\n                        <label for=\"item-${item.guid}-attack\">Attack</label>\r\n                        <input type=\"number\" id=\"item-${item.guid}-attack\" value=\"${item.attack}\"\r\n                            aria-label=\"Item attack value\" data-guid=\"${item.guid}\">\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div id=\"item-${item.guid}-stats-container\" class=\"comparison-stats-container\"></div>\r\n\r\n            <div class=\"comparison-card-actions\">\r\n                <button class=\"comparison-action-btn comparison-action-btn--add\" aria-label=\"Add stat to item\" data-guid=\"${item.guid}\">\r\n                    <svg viewBox=\"0 0 16 16\" fill=\"currentColor\" aria-hidden=\"true\">\r\n                        <path d=\"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z\"/>\r\n                    </svg>\r\n                    <span>Add Stat</span>\r\n                </button>\r\n                <!--<button class=\"comparison-action-btn comparison-action-btn--equip\" aria-label=\"Equip this item\" data-guid=\"${item.guid}\">\r\n                    <svg viewBox=\"0 0 16 16\" fill=\"currentColor\" aria-hidden=\"true\">\r\n                        <path d=\"M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 1 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z\"/>\r\n                    </svg>\r\n                    <span>Equip</span>\r\n                </button>-->\r\n            </div>\r\n        </div>\r\n    `;\r\n\r\n    // Render stat lines\r\n    const statsContainer = itemDiv.querySelector(`#item-${item.guid}-stats-container`) as HTMLElement;\r\n    if (statsContainer) {\r\n        item.statLines.forEach((statLine, index) => {\r\n            const statDiv = createStatLineElement(item.guid, statLine, index);\r\n            statsContainer.appendChild(statDiv);\r\n        });\r\n    }\r\n\r\n    // Attach event listeners using querySelector on the created element\r\n    // to ensure we find the elements in the updated DOM\r\n    attachItemEventListeners(itemDiv);\r\n\r\n    return itemDiv;\r\n}\r\n\r\n/**\r\n * Create a stat line element\r\n */\r\nfunction createStatLineElement(itemGuid: string, statLine: ComparisonStatLine, index: number): HTMLElement {\r\n    const statDiv = document.createElement('div');\r\n    statDiv.id = `item-${itemGuid}-stat-${index}`;\r\n    statDiv.className = 'comparison-stat-row';\r\n    statDiv.style.cssText = '--animation-order: ' + index;\r\n\r\n    statDiv.innerHTML = `\r\n        <div class=\"input-group comparison-stat-group\">\r\n            <label for=\"item-${itemGuid}-stat-${index}-type\" class=\"comparison-stat-label\">Stat Type</label>\r\n            <select id=\"item-${itemGuid}-stat-${index}-type\" aria-label=\"Stat type\" data-guid=\"${itemGuid}\" data-stat-index=\"${index}\">\r\n                ${generateStatTypeOptionsHTML()}\r\n            </select>\r\n        </div>\r\n        <div class=\"input-group comparison-stat-group\">\r\n            <label for=\"item-${itemGuid}-stat-${index}-value\" class=\"comparison-stat-label\">Value</label>\r\n            <input type=\"number\" step=\"0.1\" id=\"item-${itemGuid}-stat-${index}-value\" value=\"${statLine.value}\" aria-label=\"Stat value\" data-guid=\"${itemGuid}\" data-stat-index=\"${index}\">\r\n        </div>\r\n        <button class=\"comparison-stat-remove\" aria-label=\"Remove stat\" data-guid=\"${itemGuid}\" data-stat-index=\"${index}\">\r\n            <svg viewBox=\"0 0 16 16\" fill=\"currentColor\" aria-hidden=\"true\">\r\n                <path d=\"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z\"/>\r\n            </svg>\r\n        </button>\r\n    `;\r\n\r\n    // Set initial values\r\n    const typeSelect = statDiv.querySelector(`#item-${itemGuid}-stat-${index}-type`) as HTMLSelectElement;\r\n    const valueInput = statDiv.querySelector(`#item-${itemGuid}-stat-${index}-value`) as HTMLInputElement;\r\n\r\n    if (typeSelect) typeSelect.value = statLine.type;\r\n    if (valueInput) valueInput.value = statLine.value.toString();\r\n\r\n    // Attach event listeners\r\n    if (typeSelect) {\r\n        typeSelect.addEventListener('change', () => updateStatLineFromDOM(itemGuid, index));\r\n    }\r\n    if (valueInput) {\r\n        valueInput.addEventListener('input', () => updateStatLineFromDOM(itemGuid, index));\r\n    }\r\n\r\n    // Remove button\r\n    const removeButton = statDiv.querySelector('.comparison-stat-remove') as HTMLButtonElement;\r\n    if (removeButton) {\r\n        removeButton.onclick = () => deleteStatLine(itemGuid, index);\r\n    }\r\n\r\n    return statDiv;\r\n}\r\n\r\n/**\r\n * Render empty state\r\n */\r\nfunction renderEmptyState(container: HTMLElement): void {\r\n    container.innerHTML = `\r\n        <div class=\"comparison-empty-state\">\r\n            <div class=\"comparison-empty-icon\">\r\n                <svg viewBox=\"0 0 16 16\" fill=\"currentColor\" aria-hidden=\"true\">\r\n                    <path d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z\"/>\r\n                    <path d=\"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z\"/>\r\n                </svg>\r\n            </div>\r\n            <p class=\"comparison-empty-text\">No comparison items yet</p>\r\n            <p class=\"comparison-empty-subtext\">Add items to compare with your equipped gear</p>\r\n        </div>\r\n    `;\r\n}\r\n\r\n// ============================================================================\r\n// EVENT HANDLERS\r\n// ============================================================================\r\n\r\n/**\r\n * Attach event listeners to the comparison UI\r\n */\r\nfunction attachEventListeners(): void {\r\n    // Slot selector\r\n    const slotSelector = document.getElementById('comparison-slot-selector') as HTMLSelectElement;\r\n    if (slotSelector) {\r\n        slotSelector.addEventListener('change', (e) => {\r\n            const target = e.target as HTMLSelectElement;\r\n            switchSlot(target.value as EquipmentSlotId);\r\n        });\r\n    }\r\n\r\n    // Add item button\r\n    const addButton = document.querySelector('[data-type=\"add-button\"]') as HTMLButtonElement;\r\n    if (addButton) {\r\n        addButton.onclick = handleAddItem;\r\n    }\r\n\r\n    // Calculate button\r\n    const calculateButton = document.querySelector('.comparison-calculate-btn') as HTMLButtonElement;\r\n    if (calculateButton) {\r\n        calculateButton.onclick = handleCalculate;\r\n    }\r\n}\r\n\r\n/**\r\n * Attach event listeners to an item card\r\n */\r\nfunction attachItemEventListeners(itemDiv: HTMLElement): void {\r\n    const guid = itemDiv.dataset.guid;\r\n    if (!guid) return;\r\n\r\n    // Name input\r\n    const nameInput = itemDiv.querySelector(`#item-${guid}-name`) as HTMLInputElement;\r\n    if (nameInput) {\r\n        nameInput.addEventListener('input', () => {\r\n            updateItemName(guid, nameInput.value);\r\n            updateTabName(guid, nameInput.value);\r\n        });\r\n    }\r\n\r\n    // Attack input\r\n    const attackInput = itemDiv.querySelector(`#item-${guid}-attack`) as HTMLInputElement;\r\n    if (attackInput) {\r\n        attackInput.addEventListener('input', () => {\r\n            updateItemAttack(guid, parseFloat(attackInput.value) || 0);\r\n            triggerAutoCalculate();\r\n        });\r\n    }\r\n\r\n    // Add stat button\r\n    const addStatButton = itemDiv.querySelector(`[data-guid=\"${guid}\"].comparison-action-btn--add`) as HTMLButtonElement;\r\n    if (addStatButton) {\r\n        addStatButton.onclick = () => handleAddStatLine(guid);\r\n    }\r\n\r\n    // Equip button\r\n    const equipButton = itemDiv.querySelector(`[data-guid=\"${guid}\"].comparison-action-btn--equip`) as HTMLButtonElement;\r\n    if (equipButton) {\r\n        equipButton.onclick = () => handleEquipItem(guid);\r\n    }\r\n}\r\n\r\n/**\r\n * Handle add item button click\r\n */\r\nfunction handleAddItem(): void {\r\n    const items = getComparisonItems(currentSlot);\r\n    const defaultName = generateDefaultItemName(currentSlot, items.length);\r\n\r\n    const newItem = addComparisonItem(currentSlot, {\r\n        name: defaultName,\r\n        attack: 0,\r\n        mainStat: 0,\r\n        statLines: []\r\n    });\r\n\r\n    // Re-render items\r\n    renderComparisonItems();\r\n\r\n    // Switch to the new item\r\n    switchToItem(newItem.guid);\r\n\r\n    // Auto-calculate\r\n    triggerAutoCalculate();\r\n}\r\n\r\n/**\r\n * Handle add stat line button click\r\n */\r\nfunction handleAddStatLine(guid: string): void {\r\n    const item = getComparisonItems(currentSlot).find(i => i.guid === guid);\r\n    if (!item) return;\r\n\r\n    // Add empty stat line\r\n    addStatLine(currentSlot, guid, { type: 'attack', value: 0 });\r\n\r\n    // Re-render the item's stat lines\r\n    renderItemStatLines(guid);\r\n\r\n    // Auto-calculate\r\n    triggerAutoCalculate();\r\n}\r\n\r\n/**\r\n * Handle equip button click\r\n */\r\nfunction handleEquipItem(guid: string): void {\r\n    const item = getComparisonItems(currentSlot).find(i => i.guid === guid);\r\n    if (!item) return;\r\n\r\n    // Update equipment slot with item data\r\n    gearLabStore.updateEquipmentSlot(currentSlot, {\r\n        attack: item.attack,\r\n        mainStat: item.mainStat,\r\n        damageAmp: 0\r\n    });\r\n\r\n    // Remove the comparison item\r\n    removeComparisonItem(currentSlot, guid);\r\n\r\n    // Re-render\r\n    renderComparisonItems();\r\n    renderEquippedItem();\r\n\r\n    showToast(`Equipped ${item.name}`, true);\r\n}\r\n\r\n/**\r\n * Handle calculate button click\r\n */\r\nfunction handleCalculate(): void {\r\n    const resultsContainer = document.getElementById('results-container');\r\n    const loadingSpinner = document.getElementById('results-loading-spinner');\r\n\r\n    if (!resultsContainer || !loadingSpinner) return;\r\n\r\n    // Show loading spinner, hide results\r\n    loadingSpinner.style.display = 'flex';\r\n    loadingSpinner.setAttribute('aria-busy', 'true');\r\n    resultsContainer.style.display = 'none';\r\n\r\n    // Use double requestAnimationFrame to ensure spinner is rendered before blocking calculation\r\n    requestAnimationFrame(() => {\r\n        requestAnimationFrame(() => {\r\n            try {\r\n                // Calculate results\r\n                const results = calculateAllItemsDamage(currentSlot);\r\n                const equippedResult = calculateEquippedDamage(currentSlot);\r\n\r\n                // Clear results container\r\n                resultsContainer.innerHTML = '';\r\n\r\n                // Extract equipped damage values for comparison\r\n                const equippedDamageValues = equippedResult ? {\r\n                    dpsBoss: 0,\r\n                    expectedDamageBoss: 0,\r\n                    dpsNormal: 0,\r\n                    expectedDamageNormal: 0\r\n                } : null;\r\n\r\n                // Calculate equipped damage values from the equipped result stats\r\n                if (equippedResult && equippedDamageValues) {\r\n                    const service = new StatCalculationService(equippedResult.stats);\r\n                    const bossResults = service.compute('boss');\r\n                    const normalResults = service.compute('normal');\r\n                    equippedDamageValues.dpsBoss = bossResults.dps;\r\n                    equippedDamageValues.expectedDamageBoss = bossResults.expectedDamage;\r\n                    equippedDamageValues.dpsNormal = normalResults.dps;\r\n                    equippedDamageValues.expectedDamageNormal = normalResults.expectedDamage;\r\n                }\r\n\r\n                // Render equipped result (no comparison needed)\r\n                if (equippedResult) {\r\n                    resultsContainer.innerHTML += displayResults(equippedResult.name, equippedResult.stats, 'equipped', true, null);\r\n                }\r\n\r\n                // Render comparison item results with equipped damage values for comparison\r\n                results.forEach(result => {\r\n                    resultsContainer.innerHTML += displayResults(\r\n                        result.name,\r\n                        result.stats,\r\n                        result.guid,\r\n                        false,\r\n                        equippedDamageValues,\r\n                        result.passiveGains\r\n                    );\r\n                });\r\n\r\n                // Hide loading spinner, show results\r\n                loadingSpinner.style.display = 'none';\r\n                loadingSpinner.setAttribute('aria-busy', 'false');\r\n                resultsContainer.style.display = 'grid';\r\n            } catch (error) {\r\n                console.error('Calculation failed:', error);\r\n                loadingSpinner.style.display = 'none';\r\n                loadingSpinner.setAttribute('aria-busy', 'false');\r\n                resultsContainer.style.display = 'grid';\r\n                resultsContainer.innerHTML = `\r\n                    <div class=\"calculation-error\" style=\"grid-column: 1 / -1; padding: var(--comp-space-lg); text-align: center;\">\r\n                        <p style=\"color: var(--text-secondary); margin: 0;\">Calculation failed. Please try again.</p>\r\n                    </div>\r\n                `;\r\n            }\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n * Trigger auto-calculate with debounce\r\n */\r\nlet autoCalculateTimeout: number | null = null;\r\nfunction triggerAutoCalculate(): void {\r\n    if (autoCalculateTimeout) {\r\n        clearTimeout(autoCalculateTimeout);\r\n    }\r\n\r\n    autoCalculateTimeout = window.setTimeout(() => {\r\n        handleCalculate();\r\n    }, 500);\r\n}\r\n\r\n/**\r\n * Switch to a different slot\r\n */\r\nfunction switchSlot(slotId: EquipmentSlotId): void {\r\n    // Save current slot selection\r\n    localStorage.setItem('lastSelectedComparisonSlot', slotId);\r\n\r\n    // Update current slot\r\n    currentSlot = slotId;\r\n    activeItemGuid = null;\r\n\r\n    // Update selector\r\n    const slotSelector = document.getElementById('comparison-slot-selector') as HTMLSelectElement;\r\n    if (slotSelector) {\r\n        slotSelector.value = slotId;\r\n    }\r\n\r\n    // Re-render\r\n    renderEquippedItem();\r\n    renderComparisonItems();\r\n\r\n    // Auto-calculate results for new slot\r\n    handleCalculate();\r\n}\r\n\r\n/**\r\n * Switch to a specific item tab\r\n */\r\nfunction switchToItem(guid: string): void {\r\n    activeItemGuid = guid;\r\n\r\n    // Hide all items\r\n    const allItems = document.querySelectorAll('.comparison-item-card');\r\n    allItems.forEach(item => {\r\n        (item as HTMLElement).style.display = 'none';\r\n    });\r\n\r\n    // Deactivate all tabs\r\n    const allTabs = document.querySelectorAll('.comparison-tab-button');\r\n    allTabs.forEach(tab => {\r\n        tab.classList.remove('active');\r\n        tab.setAttribute('aria-selected', 'false');\r\n    });\r\n\r\n    // Show selected item\r\n    const selectedItem = document.getElementById(`comparison-item-${guid}`);\r\n    if (selectedItem) {\r\n        selectedItem.style.display = 'block';\r\n    }\r\n\r\n    // Activate selected tab\r\n    const selectedTab = document.querySelector(`[data-guid=\"${guid}\"].comparison-tab-button`);\r\n    if (selectedTab) {\r\n        selectedTab.classList.add('active');\r\n        selectedTab.setAttribute('aria-selected', 'true');\r\n    }\r\n}\r\n\r\n/**\r\n * Delete an item\r\n */\r\nfunction deleteItem(guid: string): void {\r\n    const items = getComparisonItems(currentSlot);\r\n    const item = items.find(i => i.guid === guid);\r\n    if (!item) return;\r\n\r\n    // Store for undo\r\n    lastDeletedItem = { slotId: currentSlot, item };\r\n\r\n    // Remove from store\r\n    removeComparisonItem(currentSlot, guid);\r\n\r\n    // Clear any existing undo timeout\r\n    if (undoTimeout) {\r\n        clearTimeout(undoTimeout);\r\n    }\r\n\r\n    // Re-render\r\n    renderComparisonItems();\r\n\r\n    // Show undo button\r\n    showUndoButton(item.name);\r\n\r\n    // Set undo timeout\r\n    undoTimeout = window.setTimeout(() => {\r\n        hideUndoButton();\r\n        lastDeletedItem = null;\r\n    }, 10000);\r\n}\r\n\r\n/**\r\n * Show the undo button\r\n */\r\nfunction showUndoButton(itemName: string): void {\r\n    // Remove existing undo button if present\r\n    hideUndoButton();\r\n\r\n    // Create undo button\r\n    const undoButton = document.createElement('button');\r\n    undoButton.id = 'comparison-undo-btn';\r\n    undoButton.className = 'comparison-undo-btn';\r\n    undoButton.innerHTML = `\r\n        <svg viewBox=\"0 0 16 16\" fill=\"currentColor\" aria-hidden=\"true\">\r\n            <path fill-rule=\"evenodd\" d=\"M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2v1z\"/>\r\n            <path d=\"M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466z\"/>\r\n        </svg>\r\n        <span>Undo</span>\r\n    `;\r\n    undoButton.onclick = handleUndo;\r\n\r\n    // Find a good place to insert it - after the calculate button\r\n    const calculateButton = document.querySelector('.comparison-calculate-btn');\r\n    if (calculateButton && calculateButton.parentElement) {\r\n        calculateButton.parentElement.insertBefore(undoButton, calculateButton.nextSibling);\r\n    }\r\n}\r\n\r\n/**\r\n * Hide the undo button\r\n */\r\nfunction hideUndoButton(): void {\r\n    const undoButton = document.getElementById('comparison-undo-btn');\r\n    if (undoButton) {\r\n        undoButton.remove();\r\n    }\r\n}\r\n\r\n/**\r\n * Handle undo button click\r\n */\r\nfunction handleUndo(): void {\r\n    if (!lastDeletedItem) return;\r\n\r\n    // Restore the item\r\n    addComparisonItem(lastDeletedItem.slotId, lastDeletedItem.item);\r\n\r\n    // Switch to that slot if different\r\n    if (lastDeletedItem.slotId !== currentSlot) {\r\n        switchSlot(lastDeletedItem.slotId);\r\n    }\r\n\r\n    // Clear the deleted item and timeout\r\n    lastDeletedItem = null;\r\n    if (undoTimeout) {\r\n        clearTimeout(undoTimeout);\r\n        undoTimeout = null;\r\n    }\r\n\r\n    // Hide the undo button\r\n    hideUndoButton();\r\n\r\n    // Re-render\r\n    renderComparisonItems();\r\n\r\n    // Show confirmation\r\n    showToast('Item restored', true);\r\n}\r\n\r\n/**\r\n * Delete a stat line\r\n */\r\nfunction deleteStatLine(guid: string, statIndex: number): void {\r\n    removeStatLine(currentSlot, guid, statIndex);\r\n\r\n    // Re-render the item's stat lines\r\n    renderItemStatLines(guid);\r\n\r\n    // Auto-calculate\r\n    triggerAutoCalculate();\r\n}\r\n\r\n/**\r\n * Update item name\r\n */\r\nfunction updateItemName(guid: string, name: string): void {\r\n    updateComparisonItem(currentSlot, guid, { name });\r\n}\r\n\r\n/**\r\n * Update item attack\r\n */\r\nfunction updateItemAttack(guid: string, attack: number): void {\r\n    updateComparisonItem(currentSlot, guid, { attack });\r\n}\r\n\r\n/**\r\n * Update stat line from DOM\r\n */\r\nfunction updateStatLineFromDOM(guid: string, statIndex: number): void {\r\n    // Find the stat line element and use scoped queries\r\n    const statLineElement = document.getElementById(`item-${guid}-stat-${statIndex}`);\r\n    if (!statLineElement) return;\r\n\r\n    const typeSelect = statLineElement.querySelector(`#item-${guid}-stat-${statIndex}-type`) as HTMLSelectElement;\r\n    const valueInput = statLineElement.querySelector(`#item-${guid}-stat-${statIndex}-value`) as HTMLInputElement;\r\n\r\n    if (!typeSelect || !valueInput) return;\r\n\r\n    const item = getComparisonItems(currentSlot).find(i => i.guid === guid);\r\n    if (!item) return;\r\n\r\n    // Update the stat line in the array\r\n    const updatedStatLines = [...item.statLines];\r\n    updatedStatLines[statIndex] = {\r\n        type: typeSelect.value as StatId,\r\n        value: parseFloat(valueInput.value) || 0\r\n    };\r\n\r\n    updateComparisonItem(currentSlot, guid, { statLines: updatedStatLines });\r\n}\r\n\r\n/**\r\n * Update tab name\r\n */\r\nfunction updateTabName(guid: string, name: string): void {\r\n    const tab = document.querySelector(`[data-guid=\"${guid}\"].comparison-tab-button`);\r\n    if (tab) {\r\n        const nameSpan = tab.querySelector('.tab-item-name');\r\n        if (nameSpan) {\r\n            nameSpan.textContent = name;\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Render stat lines for a specific item\r\n */\r\nfunction renderItemStatLines(guid: string): void {\r\n    const item = getComparisonItems(currentSlot).find(i => i.guid === guid);\r\n    if (!item) return;\r\n\r\n    const statsContainer = document.getElementById(`item-${guid}-stats-container`) as HTMLElement;\r\n    if (!statsContainer) return;\r\n\r\n    statsContainer.innerHTML = '';\r\n\r\n    item.statLines.forEach((statLine, index) => {\r\n        const statDiv = createStatLineElement(guid, statLine, index);\r\n        statsContainer.appendChild(statDiv);\r\n    });\r\n}\r\n\r\n// ============================================================================\r\n// INITIALIZATION\r\n// ============================================================================\r\n\r\n/**\r\n * Initialize the comparison UI\r\n */\r\nexport function initializeComparisonUI(): void {\r\n    const container = document.getElementById('optimization-item-comparison');\r\n    if (!container) {\r\n        console.error('Comparison container not found');\r\n        return;\r\n    }\r\n\r\n    // Generate HTML\r\n    container.innerHTML = generateComparisonHTML();\r\n\r\n    // Load saved slot selection\r\n    const savedSlot = localStorage.getItem('lastSelectedComparisonSlot') as EquipmentSlotId;\r\n    if (savedSlot && EQUIPMENT_SLOTS[savedSlot]) {\r\n        currentSlot = savedSlot;\r\n    }\r\n\r\n    // Update slot selector\r\n    const slotSelector = document.getElementById('comparison-slot-selector') as HTMLSelectElement;\r\n    if (slotSelector) {\r\n        slotSelector.value = currentSlot;\r\n    }\r\n\r\n    // Attach event listeners\r\n    attachEventListeners();\r\n\r\n    // Render initial state\r\n    renderEquippedItem();\r\n    renderComparisonItems();\r\n\r\n    // Auto-calculate results on initialization\r\n    handleCalculate();\r\n}\r\n\r\n/**\r\n * Check for pending slot navigation (call when Item Comparison tab is shown)\r\n */\r\nexport function checkPendingSlotNavigation(): void {\r\n    const storedSlot = sessionStorage.getItem('selectedEquipmentSlot') as EquipmentSlotId;\r\n    if (storedSlot && EQUIPMENT_SLOTS[storedSlot]) {\r\n        sessionStorage.removeItem('selectedEquipmentSlot');\r\n        switchSlot(storedSlot);\r\n    } else {\r\n        // No pending navigation, just refresh results\r\n        handleCalculate();\r\n    }\r\n}\r\n\r\n// Export for global access\r\n(window as any).checkPendingSlotNavigation = checkPendingSlotNavigation;\r\n"],
  "mappings": "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",
  "names": []
}
