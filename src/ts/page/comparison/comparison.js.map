{
  "version": 3,
  "sources": ["comparison.ts"],
  "sourcesContent": ["/**\r\n * Comparison Equipment - Pure Logic Module\r\n *\r\n * This module contains all business logic for comparison equipment,\r\n * separate from UI rendering and event handling.\r\n *\r\n * Responsibilities:\r\n * - Validation of comparison items\r\n * - Damage calculations\r\n * - Data transformations\r\n * - Import/export utilities\r\n */\r\n\r\nimport type { ComparisonItem, ComparisonStatLine, EquipmentSlotId } from '@ts/types/page/gear-lab/gear-lab.types';\r\nimport { gearLabStore } from '@ts/store/gear-lab-store';\r\nimport { StatCalculationService } from '@ts/services/stat-calculation-service';\r\nimport { BaseStats, STAT } from '@ts/types';\r\nimport { loadoutStore } from '@ts/store/loadout.store';\r\nimport { calculatePassiveGainsForItem } from '@ts/services/item-comparison.service';\r\nimport type { StatId } from '@ts/types/constants';\r\n\r\n// ============================================================================\r\n// TYPE DEFINITIONS\r\n// ============================================================================\r\n\r\n/**\r\n * Result of a damage calculation for a comparison item\r\n */\r\nexport interface ComparisonCalculationResult {\r\n    guid: string;\r\n    name: string;\r\n    bossDPS: number;\r\n    normalDPS: number;\r\n    bossExpectedDamage: number;\r\n    normalExpectedDamage: number;\r\n    stats: BaseStats;\r\n    passiveGains?: {\r\n        statChanges: Record<string, number>;\r\n        breakdown: Array<{\r\n            passive: string;\r\n            stat: string;\r\n            statDisplay?: string;\r\n            baseValue: number;\r\n            bonusValue: number;\r\n            gain: number;\r\n            isPercent: boolean;\r\n            note?: string;\r\n        }>;\r\n        complexPassives: Array<{\r\n            passive: string;\r\n            stat?: string;\r\n            baseValue?: number;\r\n            bonusValue?: number;\r\n            gain?: number;\r\n            isPercent?: boolean;\r\n            note?: string;\r\n        }>;\r\n        complexStatChanges: Record<string, number>;\r\n    };\r\n}\r\n\r\n/**\r\n * Equipment slot configuration\r\n */\r\nexport interface EquipmentSlotConfig {\r\n    id: EquipmentSlotId;\r\n    name: string;\r\n    hasMainStat: boolean;\r\n}\r\n\r\n// ============================================================================\r\n// CONSTANTS\r\n// ============================================================================\r\n\r\n/**\r\n * Equipment slot configurations\r\n */\r\nexport const EQUIPMENT_SLOTS: Record<EquipmentSlotId, EquipmentSlotConfig> = {\r\n    head: { id: 'head', name: 'Head', hasMainStat: false },\r\n    cape: { id: 'cape', name: 'Cape', hasMainStat: false },\r\n    chest: { id: 'chest', name: 'Chest', hasMainStat: false },\r\n    shoulders: { id: 'shoulders', name: 'Shoulders', hasMainStat: false },\r\n    legs: { id: 'legs', name: 'Legs', hasMainStat: false },\r\n    belt: { id: 'belt', name: 'Belt', hasMainStat: false },\r\n    gloves: { id: 'gloves', name: 'Gloves', hasMainStat: false },\r\n    boots: { id: 'boots', name: 'Boots', hasMainStat: false },\r\n    ring: { id: 'ring', name: 'Ring', hasMainStat: true },\r\n    neck: { id: 'neck', name: 'Neck', hasMainStat: true },\r\n    'eye-accessory': { id: 'eye-accessory', name: 'Eye Accessory', hasMainStat: true }\r\n};\r\n\r\n/**\r\n * Maximum number of stat lines allowed per item\r\n */\r\nexport const MAX_STAT_LINES = 10;\r\n\r\n// ============================================================================\r\n// VALIDATION\r\n// ============================================================================\r\n\r\n/**\r\n * Validate a comparison item\r\n * @param item - Item to validate\r\n * @returns True if valid, false otherwise\r\n */\r\nexport function validateComparisonItem(item: ComparisonItem): boolean {\r\n    if (!item.guid || typeof item.guid !== 'string') return false;\r\n    if (!item.name || typeof item.name !== 'string') return false;\r\n    if (typeof item.attack !== 'number' || item.attack < 0) return false;\r\n    if (typeof item.mainStat !== 'number' || item.mainStat < 0) return false;\r\n    if (!Array.isArray(item.statLines)) return false;\r\n\r\n    // Validate stat lines\r\n    for (const statLine of item.statLines) {\r\n        if (typeof statLine.type !== 'string') return false;\r\n        if (typeof statLine.value !== 'number') return false;\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n/**\r\n * Validate a stat line\r\n * @param statLine - Stat line to validate\r\n * @returns True if valid, false otherwise\r\n */\r\nexport function validateStatLine(statLine: ComparisonStatLine): boolean {\r\n    return typeof statLine.type === 'string' && typeof statLine.value === 'number';\r\n}\r\n\r\n// ============================================================================\r\n// DATA RETRIEVAL\r\n// ============================================================================\r\n\r\n/**\r\n * Get comparison items for a slot\r\n * @param slotId - Equipment slot ID\r\n * @returns Array of comparison items\r\n */\r\nexport function getComparisonItems(slotId: EquipmentSlotId): ComparisonItem[] {\r\n    return gearLabStore.getComparisonItems(slotId);\r\n}\r\n\r\n/**\r\n * Get a specific comparison item\r\n * @param slotId - Equipment slot ID\r\n * @param guid - Item GUID\r\n * @returns Item data or null if not found\r\n */\r\nexport function getComparisonItem(slotId: EquipmentSlotId, guid: string): ComparisonItem | null {\r\n    return gearLabStore.getComparisonItem(slotId, guid);\r\n}\r\n\r\n/**\r\n * Get equipped item data for a slot from the loadout store\r\n * @param slotId - Equipment slot ID\r\n * @returns Equipment data with attack, mainStat, and statLines, or null if slot is empty\r\n */\r\nexport function getEquippedItemData(slotId: EquipmentSlotId): {\r\n    attack: number;\r\n    mainStat: number;\r\n    statLines: Array<{ type: string; value: number }>;\r\n} | null {\r\n    const equipmentData = loadoutStore.getEquipmentData();\r\n    const slotData = equipmentData[slotId];\r\n    if (!slotData) return null;\r\n\r\n    // Convert StatLine[] to generic format expected by calculation service\r\n    const statLines = (slotData.statLines || []).map(sl => ({\r\n        type: sl.type,\r\n        value: sl.value\r\n    }));\r\n\r\n    return {\r\n        attack: slotData.attack,\r\n        mainStat: slotData.mainStat || 0,\r\n        statLines\r\n    };\r\n}\r\n\r\n// ============================================================================\r\n// ITEM OPERATIONS\r\n// ============================================================================\r\n\r\n/**\r\n * Add a new comparison item\r\n * @param slotId - Equipment slot ID\r\n * @param item - Item data (without guid)\r\n * @returns The created item with generated guid\r\n */\r\nexport function addComparisonItem(\r\n    slotId: EquipmentSlotId,\r\n    item: Omit<ComparisonItem, 'guid'>\r\n): ComparisonItem {\r\n    return gearLabStore.addComparisonItem(slotId, item);\r\n}\r\n\r\n/**\r\n * Update a comparison item\r\n * @param slotId - Equipment slot ID\r\n * @param guid - Item GUID\r\n * @param data - Partial item data to update\r\n * @returns True if successful, false otherwise\r\n */\r\nexport function updateComparisonItem(\r\n    slotId: EquipmentSlotId,\r\n    guid: string,\r\n    data: Partial<ComparisonItem>\r\n): boolean {\r\n    return gearLabStore.updateComparisonItem(slotId, guid, data);\r\n}\r\n\r\n/**\r\n * Remove a comparison item\r\n * @param slotId - Equipment slot ID\r\n * @param guid - Item GUID\r\n * @returns True if successful, false otherwise\r\n */\r\nexport function removeComparisonItem(slotId: EquipmentSlotId, guid: string): boolean {\r\n    return gearLabStore.removeComparisonItem(slotId, guid);\r\n}\r\n\r\n/**\r\n * Clear all comparison items for a slot\r\n * @param slotId - Equipment slot ID\r\n */\r\nexport function clearComparisonItems(slotId: EquipmentSlotId): void {\r\n    gearLabStore.clearComparisonItems(slotId);\r\n}\r\n\r\n// ============================================================================\r\n// STAT LINE OPERATIONS\r\n// ============================================================================\r\n\r\n/**\r\n * Add a stat line to a comparison item\r\n * @param slotId - Equipment slot ID\r\n * @param guid - Item GUID\r\n * @param statLine - Stat line data\r\n * @returns True if successful, false otherwise\r\n */\r\nexport function addStatLine(\r\n    slotId: EquipmentSlotId,\r\n    guid: string,\r\n    statLine: ComparisonStatLine\r\n): boolean {\r\n    const item = getComparisonItem(slotId, guid);\r\n    if (!item) return false;\r\n\r\n    // Check max stat lines\r\n    if (item.statLines.length >= MAX_STAT_LINES) {\r\n        console.warn(`Maximum ${MAX_STAT_LINES} stat lines allowed per item`);\r\n        return false;\r\n    }\r\n\r\n    return gearLabStore.addComparisonItemStatLine(slotId, guid, statLine);\r\n}\r\n\r\n/**\r\n * Remove a stat line from a comparison item\r\n * @param slotId - Equipment slot ID\r\n * @param guid - Item GUID\r\n * @param statLineIndex - Index of stat line to remove\r\n * @returns True if successful, false otherwise\r\n */\r\nexport function removeStatLine(\r\n    slotId: EquipmentSlotId,\r\n    guid: string,\r\n    statLineIndex: number\r\n): boolean {\r\n    return gearLabStore.removeComparisonItemStatLine(slotId, guid, statLineIndex);\r\n}\r\n\r\n// ============================================================================\r\n// DAMAGE CALCULATIONS\r\n// ============================================================================\r\n\r\n/**\r\n * Calculate damage for a comparison item\r\n * @param slotId - Equipment slot ID\r\n * @param item - Comparison item data\r\n * @returns Calculation result\r\n */\r\nexport function calculateItemDamage(\r\n    slotId: EquipmentSlotId,\r\n    item: ComparisonItem\r\n): ComparisonCalculationResult {\r\n    // Get base stats and context\r\n    const baseStats = loadoutStore.getBaseStats();\r\n    const currentClass = loadoutStore.getSelectedClass();\r\n    const characterLevel = loadoutStore.getCharacterLevel();\r\n\r\n    // Calculate using StatCalculationService\r\n    const service = new StatCalculationService(baseStats);\r\n\r\n    // Remove equipped item stats from this slot to ensure clean comparison\r\n    const equippedData = getEquippedItemData(slotId);\r\n    if (equippedData) {\r\n        // Subtract equipped item's attack and main stat\r\n        service.subtract(STAT.ATTACK.id, equippedData.attack);\r\n        service.subtract(STAT.PRIMARY_MAIN_STAT.id, equippedData.mainStat);\r\n\r\n        // Subtract equipped item's stat lines\r\n        equippedData.statLines.forEach(statLine => {\r\n            service.subtract(statLine.type, statLine.value);\r\n        });\r\n    }\r\n\r\n    // Add comparison item attack and main stat\r\n    service.add(STAT.ATTACK.id, item.attack);\r\n    service.add(STAT.PRIMARY_MAIN_STAT.id, item.mainStat);\r\n\r\n    // Add comparison item stat lines\r\n    item.statLines.forEach(statLine => {\r\n        service.add(statLine.type, statLine.value);\r\n    });\r\n\r\n    // Calculate passive gains from job skill levels\r\n    let passiveGains: ComparisonCalculationResult['passiveGains'] = undefined;\r\n\r\n    if (currentClass) {\r\n        const passiveResult = calculatePassiveGainsForItem(item, {\r\n            currentClass,\r\n            characterLevel,\r\n            baseStats\r\n        });\r\n\r\n        // Apply non-complex passive stat gains\r\n        Object.entries(passiveResult.statChanges).forEach(([stat, value]) => {\r\n            if (value !== 0) {\r\n                service.add(stat, value);\r\n            }\r\n        });\r\n\r\n        // Store passive gains for UI display (including complex passives)\r\n        if (passiveResult.breakdown.length > 0 || passiveResult.complexPassives.length > 0) {\r\n            passiveGains = {\r\n                statChanges: passiveResult.statChanges,\r\n                breakdown: passiveResult.breakdown,\r\n                complexPassives: passiveResult.complexPassives,\r\n                complexStatChanges: passiveResult.complexStatChanges\r\n            };\r\n        }\r\n    }\r\n\r\n    const bossResult = service.compute('boss');\r\n    const normalResult = service.compute('normal');\r\n\r\n    return {\r\n        guid: item.guid,\r\n        name: item.name,\r\n        bossDPS: bossResult.dps,\r\n        normalDPS: normalResult.dps,\r\n        bossExpectedDamage: bossResult.expectedDamage,\r\n        normalExpectedDamage: normalResult.expectedDamage,\r\n        stats: service.getStats(),\r\n        passiveGains\r\n    };\r\n}\r\n\r\n/**\r\n * Calculate damage for all comparison items in a slot\r\n * @param slotId - Equipment slot ID\r\n * @returns Array of calculation results\r\n */\r\nexport function calculateAllItemsDamage(slotId: EquipmentSlotId): ComparisonCalculationResult[] {\r\n    const items = getComparisonItems(slotId);\r\n    return items.map(item => calculateItemDamage(slotId, item));\r\n}\r\n\r\n/**\r\n * Calculate equipped item damage\r\n *\r\n * IMPORTANT: Base stats include the equipped item's direct stat contributions\r\n * (attack, main stat, stat lines) but do NOT automatically include passive gains\r\n * from skill level bonuses. We need to calculate and apply those passive gains\r\n * explicitly, just like we do for comparison items.\r\n *\r\n * @param slotId - Equipment slot ID\r\n * @returns Calculation result or null if no equipped data\r\n */\r\nexport function calculateEquippedDamage(slotId: EquipmentSlotId): ComparisonCalculationResult | null {\r\n    const equippedData = getEquippedItemData(slotId);\r\n    if (!equippedData) return null;\r\n\r\n    const baseStats = loadoutStore.getBaseStats();\r\n    const currentClass = loadoutStore.getSelectedClass();\r\n    const characterLevel = loadoutStore.getCharacterLevel();\r\n\r\n    // Base stats include the equipped item's direct stat contribution\r\n    const service = new StatCalculationService(baseStats);\r\n\r\n    // Calculate passive gains from equipped item's job skill levels (if any)\r\n    let passiveGains: ComparisonCalculationResult['passiveGains'] = undefined;\r\n\r\n    if (currentClass && characterLevel != null) {\r\n        // Convert equipped data to ComparisonItem format for passive calculation\r\n        const equippedAsComparisonItem: ComparisonItem = {\r\n            guid: 'equipped',\r\n            name: 'Equipped Item',\r\n            attack: equippedData.attack,\r\n            mainStat: equippedData.mainStat,\r\n            statLines: equippedData.statLines.map(sl => ({\r\n                type: sl.type as StatId,\r\n                value: sl.value\r\n            }))\r\n        };\r\n\r\n        const passiveResult = calculatePassiveGainsForItem(equippedAsComparisonItem, {\r\n            currentClass,\r\n            characterLevel,\r\n            baseStats\r\n        });\r\n\r\n        // Apply non-complex passive stat gains\r\n        Object.entries(passiveResult.statChanges).forEach(([stat, value]) => {\r\n            if (value !== 0) {\r\n                service.add(stat, value);\r\n            }\r\n        });\r\n\r\n        // Store passive gains for UI display (including complex passives)\r\n        if (passiveResult.breakdown.length > 0 || passiveResult.complexPassives.length > 0) {\r\n            passiveGains = {\r\n                statChanges: passiveResult.statChanges,\r\n                breakdown: passiveResult.breakdown,\r\n                complexPassives: passiveResult.complexPassives,\r\n                complexStatChanges: passiveResult.complexStatChanges\r\n            };\r\n        }\r\n    }\r\n\r\n    const bossResult = service.compute('boss');\r\n    const normalResult = service.compute('normal');\r\n\r\n    return {\r\n        guid: 'equipped',\r\n        name: 'Equipped Item',\r\n        bossDPS: bossResult.dps,\r\n        normalDPS: normalResult.dps,\r\n        bossExpectedDamage: bossResult.expectedDamage,\r\n        normalExpectedDamage: normalResult.expectedDamage,\r\n        stats: service.getStats(),\r\n        passiveGains\r\n    };\r\n}\r\n\r\n// ============================================================================\r\n// UTILITY FUNCTIONS\r\n// ============================================================================\r\n\r\n/**\r\n * Get slot configuration by ID\r\n * @param slotId - Equipment slot ID\r\n * @returns Slot configuration or null if not found\r\n */\r\nexport function getSlotConfig(slotId: EquipmentSlotId): EquipmentSlotConfig | null {\r\n    return EQUIPMENT_SLOTS[slotId] || null;\r\n}\r\n\r\n/**\r\n * Get all slot configurations\r\n * @returns Array of all slot configurations\r\n */\r\nexport function getAllSlotConfigs(): EquipmentSlotConfig[] {\r\n    return Object.values(EQUIPMENT_SLOTS);\r\n}\r\n\r\n/**\r\n * Generate a default item name for a new comparison item\r\n * @param slotId - Equipment slot ID\r\n * @param itemCount - Current number of items in the slot\r\n * @returns Default item name\r\n */\r\nexport function generateDefaultItemName(slotId: EquipmentSlotId, itemCount: number): string {\r\n    return `Item ${itemCount + 1}`;\r\n}\r\n\r\n// ============================================================================\r\n// EQUIP CONFIRMATION MODAL\r\n// ============================================================================\r\n\r\n/**\r\n * Result of equip stat changes calculation\r\n */\r\nexport interface EquipStatChanges {\r\n    directStats: {\r\n        old: Record<string, number>;\r\n        new: Record<string, number>;\r\n        diff: Record<string, number>;\r\n    };\r\n    passiveGains: {\r\n        old: ReturnType<typeof calculatePassiveGainsForItem>;\r\n        new: ReturnType<typeof calculatePassiveGainsForItem>;\r\n        diff: Record<string, number>;\r\n    };\r\n    hasAnyChanges: boolean;\r\n}\r\n\r\n/**\r\n * Calculate stat changes between old equipped item and new comparison item\r\n * @param slotId - Equipment slot ID\r\n * @param newItem - Comparison item to equip\r\n * @returns Stat changes including passive gains\r\n */\r\nexport function calculateEquipStatChanges(\r\n    slotId: EquipmentSlotId,\r\n    newItem: ComparisonItem\r\n): EquipStatChanges {\r\n    const baseStats = loadoutStore.getBaseStats();\r\n    const currentClass = loadoutStore.getSelectedClass();\r\n    const characterLevel = loadoutStore.getCharacterLevel();\r\n\r\n    // Get old equipped item\r\n    const equippedData = getEquippedItemData(slotId);\r\n\r\n    // Calculate direct stats for old item\r\n    const oldDirectStats: Record<string, number> = {};\r\n    if (equippedData) {\r\n        oldDirectStats[STAT.ATTACK.id] = equippedData.attack;\r\n        oldDirectStats[STAT.PRIMARY_MAIN_STAT.id] = equippedData.mainStat;\r\n        equippedData.statLines.forEach(statLine => {\r\n            oldDirectStats[statLine.type] = (oldDirectStats[statLine.type] || 0) + statLine.value;\r\n        });\r\n    }\r\n\r\n    // Calculate direct stats for new item\r\n    const newDirectStats: Record<string, number> = {};\r\n    newDirectStats[STAT.ATTACK.id] = newItem.attack;\r\n    newDirectStats[STAT.PRIMARY_MAIN_STAT.id] = newItem.mainStat;\r\n    newItem.statLines.forEach(statLine => {\r\n        newDirectStats[statLine.type] = (newDirectStats[statLine.type] || 0) + statLine.value;\r\n    });\r\n\r\n    // Calculate passive gains for old item\r\n    const oldPassiveGains = equippedData && currentClass\r\n        ? calculatePassiveGainsForItem(\r\n            {\r\n                guid: 'old',\r\n                name: 'Old Item',\r\n                attack: equippedData.attack,\r\n                mainStat: equippedData.mainStat,\r\n                statLines: equippedData.statLines.map(sl => ({\r\n                    type: sl.type as StatId,\r\n                    value: sl.value\r\n                }))\r\n            },\r\n            { currentClass, characterLevel, baseStats }\r\n        )\r\n        : { statChanges: {}, breakdown: [], complexPassives: [], complexStatChanges: {} };\r\n\r\n    // Calculate passive gains for new item\r\n    const newPassiveGains = currentClass\r\n        ? calculatePassiveGainsForItem(\r\n            newItem,\r\n            { currentClass, characterLevel, baseStats }\r\n        )\r\n        : { statChanges: {}, breakdown: [], complexPassives: [], complexStatChanges: {} };\r\n\r\n    // Calculate direct stats diff ONLY (no passive gains)\r\n    const directDiff: Record<string, number> = {};\r\n    Object.keys({ ...oldDirectStats, ...newDirectStats }).forEach(stat => {\r\n        const oldValue = oldDirectStats[stat] || 0;\r\n        const newValue = newDirectStats[stat] || 0;\r\n        directDiff[stat] = newValue - oldValue;\r\n    });\r\n\r\n    // Calculate passive gains diff (separate from direct stats)\r\n    const passiveDiff: Record<string, number> = {};\r\n    Object.keys({ ...oldPassiveGains.statChanges, ...newPassiveGains.statChanges }).forEach(stat => {\r\n        const oldValue = oldPassiveGains.statChanges[stat] || 0;\r\n        const newValue = newPassiveGains.statChanges[stat] || 0;\r\n        passiveDiff[stat] = newValue - oldValue;\r\n    });\r\n\r\n    const hasAnyChanges =\r\n        Object.values(directDiff).some(v => v !== 0) ||\r\n        Object.values(passiveDiff).some(v => v !== 0) ||\r\n        oldPassiveGains.breakdown.length > 0 ||\r\n        newPassiveGains.breakdown.length > 0;\r\n\r\n    return {\r\n        directStats: {\r\n            old: oldDirectStats,\r\n            new: newDirectStats,\r\n            diff: directDiff\r\n        },\r\n        passiveGains: {\r\n            old: oldPassiveGains,\r\n            new: newPassiveGains,\r\n            diff: passiveDiff\r\n        },\r\n        hasAnyChanges\r\n    };\r\n}\r\n\r\n/**\r\n * Format stat name for display\r\n */\r\nfunction formatStatForDisplay(statId: string): string {\r\n    // Find the STAT entry with matching ID\r\n    const statEntry = Object.values(STAT).find(stat => stat.id === statId);\r\n    return statEntry?.label || statId;\r\n}\r\n\r\n/**\r\n * Check if a stat should display as a percentage\r\n */\r\nfunction isStatPercentage(statId: string): boolean {\r\n    // Raw value stats (not shown as percentage): HitChance, MaxHp, Attack, MainStat, Defense, Skill Levels\r\n    return !['hitChance', 'maxHp', 'attack', 'mainStat', 'defense', 'skillLevel1st', 'skillLevel2nd', 'skillLevel3rd', 'skillLevel4th', 'skillLevelAll'].includes(statId);\r\n}\r\n\r\n/**\r\n * Create stat comparison table HTML for equip modal\r\n */\r\nfunction createEquipStatComparisonTable(statChanges: EquipStatChanges): string {\r\n    const { directStats: { old: oldDirect, new: newDirect, diff: directDiff }, passiveGains } = statChanges;\r\n\r\n    // Use pre-calculated passive diff from calculateEquipStatChanges\r\n    const { diff: passiveDiff } = passiveGains;\r\n\r\n    // Filter direct stats to only show affected ones (where diff != 0)\r\n    const affectedDirectStats = Object.entries(directDiff).filter(([stat, diff]) => diff !== 0);\r\n\r\n    // Filter passive stats to only show affected ones\r\n    const affectedPassiveStats = Object.entries(passiveDiff).filter(([stat, diff]) => diff !== 0);\r\n\r\n    const hasDirectChanges = affectedDirectStats.length > 0;\r\n    const hasPassiveChanges = affectedPassiveStats.length > 0;\r\n\r\n    // Create direct stats table\r\n    const createDirectStatsTable = () => {\r\n        if (!hasDirectChanges) {\r\n            return '<div style=\"text-align: center; color: var(--text-secondary); padding: 20px;\">No direct stat changes</div>';\r\n        }\r\n\r\n        let rows = '';\r\n        affectedDirectStats.forEach(([stat, diffValue]) => {\r\n            const oldValue = oldDirect[stat] || 0;\r\n            const newValue = newDirect[stat] || 0;\r\n            const isPercent = isStatPercentage(stat);\r\n\r\n            const formatValue = (val: number): string => {\r\n                const displayValue = val.toFixed(2).replace(/\\.00$/, '');\r\n                return `${displayValue}${isPercent ? '%' : ''}`;\r\n            };\r\n\r\n            const oldClass = oldValue > 0 ? 'stat-value-negative' : 'stat-value-neutral';\r\n            const newClass = newValue > 0 ? 'stat-value-positive' : 'stat-value-neutral';\r\n            const diffClass = diffValue > 0 ? 'stat-value-positive' : diffValue < 0 ? 'stat-value-negative' : 'stat-value-neutral';\r\n\r\n            rows += `\r\n                <tr>\r\n                    <td>${formatStatForDisplay(stat)}</td>\r\n                    <td class=\"${oldClass}\">${formatValue(oldValue)}</td>\r\n                    <td class=\"${newClass}\">${formatValue(newValue)}</td>\r\n                    <td class=\"${diffClass}\">${diffValue > 0 ? '+' : ''}${formatValue(diffValue)}</td>\r\n                </tr>\r\n            `;\r\n        });\r\n\r\n        return `\r\n            <table class=\"stat-table\">\r\n                <thead>\r\n                    <tr>\r\n                        <th>Stat</th>\r\n                        <th>Losing</th>\r\n                        <th>Gaining</th>\r\n                        <th>Net Change</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    ${rows}\r\n                </tbody>\r\n            </table>\r\n        `;\r\n    };\r\n\r\n    // Create passive stats table\r\n    const createPassiveStatsTable = () => {\r\n        if (!hasPassiveChanges) {\r\n            return '<div style=\"text-align: center; color: var(--text-secondary); padding: 20px;\">No passive stat changes</div>';\r\n        }\r\n\r\n        let rows = '';\r\n        affectedPassiveStats.forEach(([stat, diffValue]) => {\r\n            const oldValue = passiveGains.old.statChanges[stat] || 0;\r\n            const newValue = passiveGains.new.statChanges[stat] || 0;\r\n            const isPercent = isStatPercentage(stat);\r\n\r\n            const formatValue = (val: number): string => {\r\n                const displayValue = val.toFixed(2).replace(/\\.00$/, '');\r\n                return `${displayValue}${isPercent ? '%' : ''}`;\r\n            };\r\n\r\n            const oldClass = oldValue > 0 ? 'stat-value-negative' : 'stat-value-neutral';\r\n            const newClass = newValue > 0 ? 'stat-value-positive' : 'stat-value-neutral';\r\n            const diffClass = diffValue > 0 ? 'stat-value-positive' : diffValue < 0 ? 'stat-value-negative' : 'stat-value-neutral';\r\n\r\n            rows += `\r\n                <tr>\r\n                    <td>${formatStatForDisplay(stat)}</td>\r\n                    <td class=\"${oldClass}\">${formatValue(oldValue)}</td>\r\n                    <td class=\"${newClass}\">${formatValue(newValue)}</td>\r\n                    <td class=\"${diffClass}\">${diffValue > 0 ? '+' : ''}${formatValue(diffValue)}</td>\r\n                </tr>\r\n            `;\r\n        });\r\n\r\n        return `\r\n            <table class=\"stat-table\">\r\n                <thead>\r\n                    <tr>\r\n                        <th>Passive Stat</th>\r\n                        <th>Losing</th>\r\n                        <th>Gaining</th>\r\n                        <th>Net Change</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    ${rows}\r\n                </tbody>\r\n            </table>\r\n        `;\r\n    };\r\n\r\n    return `\r\n        <div class=\"modal-tabs\">\r\n            <button class=\"modal-tab active\" data-tab=\"direct\" onclick=\"window.switchEquipModalTab('direct')\">\r\n                Direct Stats (${affectedDirectStats.length})\r\n            </button>\r\n            <button class=\"modal-tab\" data-tab=\"passive\" onclick=\"window.switchEquipModalTab('passive')\">\r\n                Passive Stats (${affectedPassiveStats.length})\r\n            </button>\r\n        </div>\r\n\r\n        <div class=\"modal-tab-content active\" id=\"modal-tab-direct\">\r\n            <div class=\"stat-comparison-table\">\r\n                ${createDirectStatsTable()}\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"modal-tab-content\" id=\"modal-tab-passive\">\r\n            <div class=\"stat-comparison-table\">\r\n                ${createPassiveStatsTable()}\r\n            </div>\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Show equip confirmation modal\r\n * @param slotId - Equipment slot ID\r\n * @param newItem - Comparison item to equip\r\n * @returns Promise with user choice\r\n */\r\nexport function showEquipConfirmModal(\r\n    slotId: EquipmentSlotId,\r\n    newItem: ComparisonItem\r\n): Promise<'yes' | 'no' | 'cancel'> {\r\n    return new Promise((resolve) => {\r\n        // Remove any existing modal\r\n        const existingModal = document.getElementById('equip-comparison-modal');\r\n        if (existingModal) {\r\n            existingModal.remove();\r\n        }\r\n\r\n        // Calculate stat changes\r\n        const statChanges = calculateEquipStatChanges(slotId, newItem);\r\n\r\n        // Create modal overlay\r\n        const overlay = document.createElement('div');\r\n        overlay.id = 'equip-comparison-modal';\r\n        overlay.className = 'modal-overlay';\r\n\r\n        // Create modal box\r\n        const modalBox = document.createElement('div');\r\n        modalBox.className = 'modal-box';\r\n\r\n        // Get slot config for display name\r\n        const slotConfig = getSlotConfig(slotId);\r\n        const slotName = slotConfig?.name || slotId;\r\n\r\n        // Create title\r\n        const title = document.createElement('h2');\r\n        title.className = 'modal-title';\r\n        title.textContent = `Equip ${newItem.name}`;\r\n\r\n        // Create message\r\n        const message = document.createElement('p');\r\n        message.className = 'modal-message';\r\n        message.innerHTML = `\r\n            Are you sure you want to equip <strong>${newItem.name}</strong> to the <strong>${slotName}</strong> slot?<br>\r\n            <br>\r\n            This will:\r\n            <ul style=\"text-align: left; margin: 12px 0; padding-left: 24px;\">\r\n                <li>Subtract the stats of your currently equipped item from base stats</li>\r\n                <li>Add the stats of ${newItem.name} to base stats</li>\r\n                <li>Convert your old equipped item into a comparison item</li>\r\n            </ul>\r\n        `;\r\n\r\n        // Create stat comparison table\r\n        const tableContainer = document.createElement('div');\r\n        tableContainer.className = 'stat-comparison-table';\r\n        tableContainer.innerHTML = createEquipStatComparisonTable(statChanges);\r\n\r\n        // Create button container\r\n        const buttonContainer = document.createElement('div');\r\n        buttonContainer.className = 'modal-buttons';\r\n\r\n        // Create Yes button\r\n        const yesBtn = document.createElement('button');\r\n        yesBtn.className = 'modal-btn btn-yes';\r\n        yesBtn.textContent = 'Equip - Apply Stats';\r\n        yesBtn.onclick = () => {\r\n            overlay.remove();\r\n            wrappedResolve('yes');\r\n        };\r\n\r\n        // Create Cancel button\r\n        const cancelBtn = document.createElement('button');\r\n        cancelBtn.className = 'modal-btn btn-cancel';\r\n        cancelBtn.textContent = 'Cancel';\r\n        cancelBtn.onclick = () => {\r\n            overlay.remove();\r\n            wrappedResolve('cancel');\r\n        };\r\n\r\n        // Assemble modal\r\n        buttonContainer.appendChild(yesBtn);\r\n        buttonContainer.appendChild(cancelBtn);\r\n\r\n        modalBox.appendChild(title);\r\n        modalBox.appendChild(message);\r\n        modalBox.appendChild(tableContainer);\r\n        modalBox.appendChild(buttonContainer);\r\n\r\n        overlay.appendChild(modalBox);\r\n        document.body.appendChild(overlay);\r\n\r\n        // Add tab switching function to window\r\n        (window as any).switchEquipModalTab = (tabName: 'direct' | 'passive') => {\r\n            // Update tab buttons\r\n            document.querySelectorAll('.modal-tab').forEach(tab => {\r\n                if (tab instanceof HTMLElement && tab.dataset.tab === tabName) {\r\n                    tab.classList.add('active');\r\n                } else {\r\n                    tab.classList.remove('active');\r\n                }\r\n            });\r\n\r\n            // Update tab content\r\n            document.querySelectorAll('.modal-tab-content').forEach(content => {\r\n                if (content instanceof HTMLElement && content.id === `modal-tab-${tabName}`) {\r\n                    content.classList.add('active');\r\n                } else {\r\n                    content.classList.remove('active');\r\n                }\r\n            });\r\n        };\r\n\r\n        // Clean up window function on modal close\r\n        const originalResolve = resolve;\r\n        const wrappedResolve = (value: 'yes' | 'no' | 'cancel') => {\r\n            delete (window as any).switchEquipModalTab;\r\n            originalResolve(value);\r\n        };\r\n\r\n        // Handle ESC key\r\n        const escHandler = (e: KeyboardEvent) => {\r\n            if (e.key === 'Escape') {\r\n                overlay.remove();\r\n                document.removeEventListener('keydown', escHandler);\r\n                wrappedResolve('cancel');\r\n            }\r\n        };\r\n        document.addEventListener('keydown', escHandler);\r\n\r\n        // Focus on Yes button by default\r\n        yesBtn.focus();\r\n    });\r\n}\r\n"],
  "mappings": "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",
  "names": []
}
