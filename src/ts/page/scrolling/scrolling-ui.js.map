{
  "version": 3,
  "sources": ["scrolling-ui.ts"],
  "sourcesContent": ["/**\n * Scroll Optimizer UI - Pure UI Layer\n *\n * Handles all HTML generation and UI event handling for the scrolling optimizer tab.\n */\n\nimport { formatNumber } from '@ts/utils/formatters.js';\nimport { getScrollsForLevel, calculateScrollDamageGain } from '@ts/page/scrolling/scrolling.js';\nimport { gearLabStore } from '@ts/store/gear-lab-store.js';\nimport { loadoutStore } from '@ts/store/loadout.store.js';\nimport { VALID_EQUIPMENT_SLOTS } from '@ts/types/page/gear-lab/gear-lab.types.js';\nimport type { EquipmentSlotId, EquipmentSlotData } from '@ts/types/page/gear-lab/gear-lab.types.js';\nimport type {\n    ScrollStrategy,\n    SimulationResult,\n    ScrollLevel,\n    EnhancementBonus,\n    ScrollRunResult\n} from '@ts/types/page/scrolling/scrolling.types.js';\nimport { STAT } from '@ts/types/constants.js';\nimport { StatCalculationService } from '@ts/services/stat-calculation-service.js';\n\n// Re-import simulation functions from logic layer\nimport {\n    simulateScrollWithResets,\n    createL65Strategies,\n    createL85Strategies\n} from '@ts/page/scrolling/scrolling.js';\nimport { debounce } from '@ts/utils/event-emitter';\n\n// ============================================================================\n// STATE\n// ============================================================================\n\nlet currentScrollLevel: ScrollLevel = '85';\n\n// ============================================================================\n// HTML GENERATION\n// ============================================================================\n\n/**\n * Generate HTML for scroll level info display\n */\nfunction generateScrollLevelInfoHTML(level: ScrollLevel, enhancementBonus: EnhancementBonus): string {\n    const bonusDisplay = enhancementBonus.total > 0\n        ? `<br><strong class=\"scrolling-level-info__bonus\">Enhancement Bonus: +${(enhancementBonus.total * 100).toFixed(0)}% success rate</strong>`\n        : '';\n\n    if (level === '65') {\n        const scrolls = getScrollsForLevel('65');\n        const l65_70_rate = ((scrolls.L65_70.baseSuccess + enhancementBonus.total) * 100).toFixed(0);\n        const l65_30_rate = ((scrolls.L65_30.baseSuccess + enhancementBonus.total) * 100).toFixed(0);\n\n        return `\n            <strong>Level 65 Scrolls:</strong>${bonusDisplay}<br>\n            \u2022 70%: <strong>${l65_70_rate}%</strong> effective rate (+100 ATK, 250 spell trace)<br>\n            \u2022 30%: <strong>${l65_30_rate}%</strong> effective rate (+200 ATK, +0.1% Damage Amp, 300 spell trace)\n        `;\n    } else {\n        const scrolls = getScrollsForLevel('85');\n        const l85_70_rate = ((scrolls.L85_70.baseSuccess + enhancementBonus.total) * 100).toFixed(0);\n        const l85_30_rate = ((scrolls.L85_30.baseSuccess + enhancementBonus.total) * 100).toFixed(0);\n        const l85_15_rate = ((scrolls.L85_15.baseSuccess + enhancementBonus.total) * 100).toFixed(0);\n\n        return `\n            <strong>Level 85 Scrolls:</strong>${bonusDisplay}<br>\n            \u2022 70%: <strong>${l85_70_rate}%</strong> effective rate (+200 ATK, +0.2% Damage Amp, 500 spell trace)<br>\n            \u2022 30%: <strong>${l85_30_rate}%</strong> effective rate (+400 ATK, +0.4% Damage Amp, 650 spell trace)<br>\n            \u2022 15%: <strong>${l85_15_rate}%</strong> effective rate (+800 ATK, +0.8% Damage Amp, 800 spell trace)\n        `;\n    }\n}\n\n/**\n * Generate HTML for My Slot Performance tab\n */\nfunction generateMySlotPerformanceHTML(): string {\n    return `\n        <div class=\"scrolling-banner\">\n            <div class=\"optimization-info-banner__text\">\n                <strong>Equipment Slot Analysis:</strong> Track individual equipment slot values in isolation. Each slot's DPS gain is calculated by comparing damage WITH that slot's stats vs damage WITH zero stats from that slot.\n            </div>\n        </div>\n\n        <!-- Summary Header -->\n        <div class=\"slot-summary-header\">\n            <div class=\"summary-metric\">\n                <div class=\"summary-metric-label\">Total Attack</div>\n                <div class=\"summary-metric-value atk\" id=\"total-attack\">0</div>\n            </div>\n            <div class=\"summary-metric\">\n                <div class=\"summary-metric-label\">Total Main Stat</div>\n                <div class=\"summary-metric-value main\" id=\"total-main\">0</div>\n            </div>\n            <div class=\"summary-metric\">\n                <div class=\"summary-metric-label\">Total Dmg Amp</div>\n                <div class=\"summary-metric-value amp\" id=\"total-amp\">0%</div>\n            </div>\n            <div class=\"summary-metric\">\n                <div class=\"summary-metric-label\">Total DPS Gain</div>\n                <div class=\"summary-metric-value dps\" id=\"total-dps\">0%</div>\n            </div>\n        </div>\n\n        <div id=\"equipment-slots-grid\" class=\"scrolling-slots-grid\">\n            <!-- Slot cards generated by JavaScript -->\n        </div>\n    `;\n}\n\n/**\n * Generate HTML for Simulation tab\n */\nfunction generateSimulationHTML(): string {\n    return `\n        <div class=\"scrolling-banner\">\n            <div class=\"optimization-info-banner__text\">\n                <strong>Scroll Optimizer:</strong> Simulates different scrolling strategies using Level 65 scrolls to find the optimal approach. The damage gain shows how much your DPS will increase from the average scroll results.\n            </div>\n        </div>\n\n        <div class=\"scrolling-inputs-grid\">\n            <div class=\"input-group\">\n                <label>Number of Simulations</label>\n                <input type=\"number\" id=\"scroll-simulations\" value=\"1000\" min=\"100\" max=\"10000\" step=\"100\">\n            </div>\n        </div>\n\n        <div class=\"scrolling-enhancements\">\n            <div class=\"scrolling-enhancements__grid\">\n                <label class=\"scrolling-premium__label\">\n                    <input type=\"checkbox\" id=\"scroll-premium-membership\" class=\"scrolling-premium__checkbox\" onchange=\"window.updateScrollLevelInfo()\">\n                    <span class=\"scrolling-premium__text\">\n                        Premium\n                        <span class=\"scrolling-premium__badge\">+2%</span>\n                    </span>\n                </label>\n\n                <div class=\"scrolling-guild\">\n                    <span class=\"scrolling-guild__icon\">\u2694\uFE0F</span>\n                    <span class=\"scrolling-guild__label\">Guild Skill</span>\n                    <div class=\"scrolling-guild__slider-container\">\n                        <input type=\"range\" id=\"scroll-guild-skill\" class=\"scrolling-guild__slider\" min=\"0\" max=\"3\" step=\"1\" value=\"0\"\n                               oninput=\"window.updateGuildSkillDisplay(); window.updateScrollLevelInfo();\"\n                               data-value=\"0\">\n                    </div>\n                    <span id=\"guild-skill-value\" class=\"scrolling-guild__value\">0%</span>\n                </div>\n            </div>\n        </div>\n\n        <div class=\"scrolling-level-selector\">\n            <label class=\"scrolling-level-selector__label\">Scroll Level</label>\n            <div class=\"scrolling-level-selector__options\">\n                <label class=\"scrolling-level-radio\">\n                    <input type=\"radio\" name=\"scroll-level\" value=\"65\" onchange=\"window.updateScrollLevelInfo()\">\n                    <span>Level 65 Scrolls</span>\n                </label>\n                <label class=\"scrolling-level-radio\">\n                    <input type=\"radio\" name=\"scroll-level\" value=\"85\" checked onchange=\"window.updateScrollLevelInfo()\">\n                    <span>Level 85 Scrolls</span>\n                </label>\n            </div>\n            <div id=\"scroll-level-info\" class=\"scrolling-level-info\">\n                <!-- Info populated by JavaScript -->\n            </div>\n        </div>\n\n        <button class=\"calculate-btn scrolling-run-btn\" onclick=\"window.runScrollSimulation()\" id=\"scroll-run-btn\">Run Simulation</button>\n\n        <div id=\"scroll-progress-container\" class=\"scrolling-progress\" style=\"display: none;\">\n            <div class=\"scrolling-progress__track\">\n                <div id=\"scroll-progress-bar\" class=\"scrolling-progress__bar\"></div>\n            </div>\n            <p id=\"scroll-progress-text\" class=\"scrolling-progress__text\"></p>\n        </div>\n\n        <div id=\"scroll-results-container\" class=\"scrolling-results\">\n            <!-- Results populated by JavaScript -->\n        </div>\n    `;\n}\n\n/**\n * Generate the complete HTML for the scrolling optimizer tab\n */\nexport function generateScrollingHTML(): string {\n    return `\n        <div class=\"tab-navigation\">\n            <button id=\"scrolling-tab-button\" class=\"tab-button active\" onclick=\"window.switchScrollingSubTab('my-slot-performance')\">My Slot Performance</button>\n            <button id=\"scrolling-tab-button\" class=\"tab-button\" onclick=\"window.switchScrollingSubTab('simulation')\">Simulation</button>\n        </div>\n\n        <!-- My Slot Performance Sub-Tab -->\n        <div id=\"scrolling-my-slot-performance\" class=\"scrolling-subtab active\">\n            ${generateMySlotPerformanceHTML()}\n        </div>\n\n        <!-- Simulation Sub-Tab -->\n        <div id=\"scrolling-simulation\" class=\"scrolling-subtab\" style=\"display: none;\">\n            ${generateSimulationHTML()}\n        </div>\n    `;\n}\n\n// ============================================================================\n// UI FUNCTIONS\n// ============================================================================\n\n/**\n * Update Guild Skill display value\n */\nexport function updateGuildSkillDisplay(): void {\n    const slider = document.getElementById('scroll-guild-skill') as HTMLInputElement;\n    const display = document.getElementById('guild-skill-value');\n    if (slider && display) {\n        const value = slider.value;\n        display.textContent = value + '%';\n\n        // Update styling based on value\n        if (parseInt(value) > 0) {\n            display.classList.add('boosted');\n        } else {\n            display.classList.remove('boosted');\n        }\n\n        // Update slider data attribute for CSS styling\n        slider.setAttribute('data-value', value);\n\n        // Update tick marks\n        const ticks = document.querySelectorAll('.scrolling-guild__tick');\n        ticks.forEach((tick, index) => {\n            if (index <= parseInt(value)) {\n                tick.classList.add('active');\n            } else {\n                tick.classList.remove('active');\n            }\n        });\n    }\n}\n\n/**\n * Update scroll level info display\n */\nexport function updateScrollLevelInfo(): void {\n    const levelRadio = document.querySelector<HTMLInputElement>('input[name=\"scroll-level\"]:checked');\n    const level = (levelRadio?.value || '65') as ScrollLevel;\n    currentScrollLevel = level;\n\n    const infoDiv = document.getElementById('scroll-level-info');\n    if (!infoDiv) return;\n\n    const enhancementBonus = getEnhancementBonus();\n    infoDiv.innerHTML = generateScrollLevelInfoHTML(level, enhancementBonus);\n}\n\n/**\n * Get enhancement bonus from UI\n */\nfunction getEnhancementBonus(): EnhancementBonus {\n    const premiumCheckbox = document.getElementById('scroll-premium-membership') as HTMLInputElement;\n    const guildSlider = document.getElementById('scroll-guild-skill') as HTMLInputElement;\n\n    const premium = premiumCheckbox && premiumCheckbox.checked ? 0.02 : 0;\n    const guild = guildSlider ? (parseInt(guildSlider.value) / 100) : 0;\n\n    return {\n        premium,\n        guild,\n        total: premium + guild\n    };\n}\n\n/**\n * Switch scrolling sub-tabs\n */\nexport function switchScrollingSubTab(tabName: string): void {\n    const allSubTabContent = document.querySelectorAll('.scrolling-subtab');\n    const allSubTabButtons = document.querySelectorAll('#scrolling-tab-button');\n\n    // Hide all subtabs\n    allSubTabContent.forEach(tab => {\n        tab.classList.remove('active');\n        (tab as HTMLElement).style.display = 'none';\n    });\n\n    // Remove active from all buttons\n    allSubTabButtons.forEach(btn => {\n        btn.classList.remove('active');\n    });\n\n    // Show selected subtab\n    const selectedTab = document.getElementById(`scrolling-${tabName}`);\n    if (selectedTab) {\n        selectedTab.classList.add('active');\n        selectedTab.style.display = 'block';\n    }\n\n    // Activate button\n    allSubTabButtons.forEach(btn => {\n        const onclickAttr = btn.getAttribute('onclick');\n        if (onclickAttr && onclickAttr.includes(`'${tabName}'`)) {\n            btn.classList.add('active');\n        }\n    });\n\n    // Render content\n    if (tabName === 'my-slot-performance') {\n        renderMySlotPerformance();\n    } else if (tabName === 'simulation') {\n        renderSimulation();\n    }\n}\n\n/**\n * Render My Slot Performance tab\n */\nfunction renderMySlotPerformance(): void {\n    const container = document.getElementById('scrolling-my-slot-performance');\n    if (!container) return;\n\n    container.innerHTML = generateMySlotPerformanceHTML();\n\n    // Initialize equipment slots after DOM is ready\n    setTimeout(() => {\n        initializeEquipmentSlots();\n        loadEquipmentSlots();\n    }, 0);\n}\n\nfunction initializeEquipmentSlots() {\n    const slots = ['Head', 'Cape', 'Chest', 'Shoulders', 'Legs', 'Belt', 'Gloves', 'Boots', 'Ring', 'Neck', 'Eye Accessory'];\n    const container = document.getElementById('equipment-slots-grid');\n    if (!container) return;\n\n    let html = '';\n    slots.forEach((slotName) => {\n        const slotId = slotName.toLowerCase().replace(/\\s+/g, '-');\n        html += `\n            <div class=\"slot-card\" data-slot-id=\"${slotId}\">\n                <div class=\"slot-card-header\">\n                    <div class=\"slot-name\">${slotName}</div>\n                    <div class=\"slot-dps\" id=\"slot-${slotId}-dps\">+0.00%</div>\n                </div>\n                <div class=\"slot-inputs\">\n                    <div class=\"slot-input-row\">\n                        <label class=\"slot-input-label atk\">ATTACK</label>\n                        <input type=\"number\" class=\"slot-input\" id=\"slot-${slotId}-attack\" data-slot=\"${slotId}\" step=\"0.1\" min=\"0\" value=\"0\">\n                    </div>\n                    <div class=\"slot-input-row\">\n                        <label class=\"slot-input-label main\">MAIN STAT</label>\n                        <input type=\"number\" class=\"slot-input\" id=\"slot-${slotId}-main-stat\" data-slot=\"${slotId}\" step=\"1\" min=\"0\" value=\"0\">\n                    </div>\n                    <div class=\"slot-input-row\">\n                        <label class=\"slot-input-label amp\">DAMAGE AMP</label>\n                        <input type=\"number\" class=\"slot-input\" id=\"slot-${slotId}-damage-amp\" data-slot=\"${slotId}\" step=\"0.1\" min=\"0\" value=\"0\">\n                    </div>\n                </div>\n            </div>\n        `;\n    });\n\n    container.innerHTML = html;\n\n    // Attach input listeners for real-time calculation\n    setTimeout(() => {\n        slots.forEach(slot => {\n            const slotId = slot.toLowerCase().replace(/\\s+/g, '-');\n            const attackInput = document.getElementById(`slot-${slotId}-attack`);\n            const mainStatInput = document.getElementById(`slot-${slotId}-main-stat`);\n            const damageAmpInput = document.getElementById(`slot-${slotId}-damage-amp`);\n\n            if (attackInput) {\n                attackInput.addEventListener('input', (e) => handleSlotInputChange(slotId as EquipmentSlotId));\n            }\n            if (mainStatInput) {\n                mainStatInput.addEventListener('input', (e) => handleSlotInputChange(slotId as EquipmentSlotId));\n            }\n            if (damageAmpInput) {\n                damageAmpInput.addEventListener('input', (e) => handleSlotInputChange(slotId as EquipmentSlotId));\n            }\n        });\n\n        // Initial calculation\n        updateAllSlotCalculations();\n    }, 0);\n}\n\n/**\n * Handle individual slot input change - calculate DPS in real-time\n */\nfunction handleSlotInputChange(slotId: EquipmentSlotId): void {\n    // Save to store\n    saveEquipmentSlots();\n\n    // Calculate this slot's DPS\n    calculateSlotDPS(slotId);\n\n    // Update totals\n    updateSlotTotals();\n}\n\n/**\n * Calculate DPS gain for a single slot\n */\nfunction calculateSlotDPS(slotId: EquipmentSlotId): void {\n    const attackInput = document.getElementById(`slot-${slotId}-attack`) as HTMLInputElement | null;\n    const mainStatInput = document.getElementById(`slot-${slotId}-main-stat`) as HTMLInputElement | null;\n    const damageAmpInput = document.getElementById(`slot-${slotId}-damage-amp`) as HTMLInputElement | null;\n    const dpsDisplay = document.getElementById(`slot-${slotId}-dps`);\n\n    if (!attackInput || !mainStatInput || !damageAmpInput || !dpsDisplay) return;\n\n    const attack = parseFloat(attackInput.value) || 0;\n    const mainStat = parseFloat(mainStatInput.value) || 0;\n    const damageAmp = parseFloat(damageAmpInput.value) || 0;\n\n    // Calculate DPS gain for this slot using StatCalculationService\n    const baseStats = loadoutStore.getBaseStats();\n    const service = new StatCalculationService(baseStats);\n\n    // Base DPS without this slot\n    const baseDPS = service.computeDPS('boss');\n\n    // Add this slot's stats\n    service.add(STAT.ATTACK.id, attack);\n    service.add(STAT.PRIMARY_MAIN_STAT.id, mainStat);\n    service.add(STAT.DAMAGE_AMP.id, damageAmp);\n\n    // New DPS with this slot\n    const newDPS = service.computeDPS('boss');\n    const dpsGain = ((newDPS - baseDPS) / baseDPS * 100);\n\n    dpsDisplay.textContent = `+${dpsGain.toFixed(2)}%`;\n}\n\n/**\n * Update all slot calculations\n */\nfunction updateAllSlotCalculations(): void {\n    VALID_EQUIPMENT_SLOTS.forEach(slotId => {\n        calculateSlotDPS(slotId);\n    });\n    updateSlotTotals();\n}\n\n/**\n * Update summary totals for all slots\n */\nfunction updateSlotTotals(): void {\n    let totalAttack = 0;\n    let totalMainStat = 0;\n    let totalDamageAmp = 0;\n    let totalDPSGain = 0;\n\n    VALID_EQUIPMENT_SLOTS.forEach(slotId => {\n        const attackInput = document.getElementById(`slot-${slotId}-attack`) as HTMLInputElement | null;\n        const mainStatInput = document.getElementById(`slot-${slotId}-main-stat`) as HTMLInputElement | null;\n        const damageAmpInput = document.getElementById(`slot-${slotId}-damage-amp`) as HTMLInputElement | null;\n        const dpsDisplay = document.getElementById(`slot-${slotId}-dps`);\n\n        if (attackInput) totalAttack += parseFloat(attackInput.value) || 0;\n        if (mainStatInput) totalMainStat += parseFloat(mainStatInput.value) || 0;\n        if (damageAmpInput) totalDamageAmp += parseFloat(damageAmpInput.value) || 0;\n        if (dpsDisplay) {\n            const dpsText = dpsDisplay.textContent || '+0.00%';\n            totalDPSGain += parseFloat(dpsText.replace('+', '').replace('%', '')) || 0;\n        }\n    });\n\n    const totalAttackEl = document.getElementById('total-attack');\n    const totalMainEl = document.getElementById('total-main');\n    const totalAmpEl = document.getElementById('total-amp');\n    const totalDpsEl = document.getElementById('total-dps');\n\n    if (totalAttackEl) totalAttackEl.textContent = totalAttack.toFixed(1);\n    if (totalMainEl) totalMainEl.textContent = totalMainStat.toFixed(0);\n    if (totalAmpEl) totalAmpEl.textContent = totalDamageAmp.toFixed(1) + '%';\n    if (totalDpsEl) totalDpsEl.textContent = '+' + totalDPSGain.toFixed(2) + '%';\n}\n\nexport function saveEquipmentSlots() {\n    const slots: Partial<Record<EquipmentSlotId, EquipmentSlotData>> = {};\n\n    VALID_EQUIPMENT_SLOTS.forEach(slotId => {\n        const attackInput = document.getElementById(`slot-${slotId}-attack`) as HTMLInputElement | null;\n        const mainStatInput = document.getElementById(`slot-${slotId}-main-stat`) as HTMLInputElement | null;\n        const damageAmpInput = document.getElementById(`slot-${slotId}-damage-amp`) as HTMLInputElement | null;\n\n        slots[slotId] = {\n            attack: attackInput ? parseFloat(attackInput.value) || 0 : 0,\n            mainStat: mainStatInput ? parseFloat(mainStatInput.value) || 0 : 0,\n            damageAmp: damageAmpInput ? parseFloat(damageAmpInput.value) || 0 : 0\n        };\n    });\n\n    gearLabStore.updateAllEquipmentSlots(slots);\n\n    // Notify stat contributors to update stat breakdown\n    if (window.notifyStatContributors) {\n        window.notifyStatContributors();\n    }\n}\n\nfunction loadEquipmentSlots() {\n    const slots = gearLabStore.getEquipmentSlots();\n\n    VALID_EQUIPMENT_SLOTS.forEach(slotId => {\n        if (slots[slotId]) {\n            const attackInput = document.getElementById(`slot-${slotId}-attack`) as HTMLInputElement | null;\n            const mainStatInput = document.getElementById(`slot-${slotId}-main-stat`) as HTMLInputElement | null;\n            const damageAmpInput = document.getElementById(`slot-${slotId}-damage-amp`) as HTMLInputElement | null;\n\n            if (attackInput) attackInput.value = String(slots[slotId].attack || 0);\n            if (mainStatInput) mainStatInput.value = String(slots[slotId].mainStat || 0);\n            if (damageAmpInput) damageAmpInput.value = String(slots[slotId].damageAmp || 0);\n        }\n    });\n\n    // Recalculate all slots after loading\n    updateAllSlotCalculations();\n}\n\n\n\n/**\n * Render Simulation tab\n */\nfunction renderSimulation(): void {\n    const container = document.getElementById('scrolling-simulation');\n    if (!container) return;\n\n    container.innerHTML = generateSimulationHTML();\n\n    // Initialize scroll level info after DOM is ready\n    setTimeout(() => {\n        updateScrollLevelInfo();\n    }, 0);\n}\n\n/**\n * Generate histogram HTML for attack distribution\n */\nfunction generateHistogramHTML(attacks: number[], numSimulations: number): string {\n    const binSize = 50;\n    const maxAttack = Math.max(...attacks);\n    const numBins = Math.ceil(maxAttack / binSize) + 1;\n    const bins = new Array(numBins).fill(0);\n\n    // Count simulations in each bin\n    attacks.forEach(attack => {\n        const binIndex = Math.floor(attack / binSize);\n        bins[binIndex]++;\n    });\n\n    // Find max count for scaling\n    const maxCount = Math.max(...bins);\n\n    // Generate histogram HTML\n    let histogramHTML = '<div class=\"scrolling-histogram\">';\n\n    // Only show bins that have at least 1 simulation\n    bins.forEach((count, index) => {\n        if (count > 0) {\n            const rangeStart = index * binSize;\n            const rangeEnd = (index + 1) * binSize;\n            const percentage = (count / numSimulations * 100).toFixed(1);\n            const barWidth = (count / maxCount * 100).toFixed(1);\n\n            histogramHTML += `\n                <div class=\"scrolling-histogram__bar-row\">\n                    <div class=\"scrolling-histogram__label\">${rangeStart}-${rangeEnd}:</div>\n                    <div class=\"scrolling-histogram__bar-track\">\n                        <div class=\"scrolling-histogram__bar-fill\" style=\"width: ${barWidth}%\"></div>\n                    </div>\n                    <div class=\"scrolling-histogram__count\">${count} (${percentage}%)</div>\n                </div>\n            `;\n        }\n    });\n\n    histogramHTML += '</div>';\n    return histogramHTML;\n}\n\n/**\n * Display simulation results\n */\nexport function displayScrollResults(\n    results: Record<string, SimulationResult>,\n    budget: number,\n    numSimulations: number\n): void {\n    const container = document.getElementById('scroll-results-container');\n    if (!container) return;\n\n    container.innerHTML = '';\n\n    // Find best strategy by DPS gain\n    let bestStrategy: string | null = null;\n    let bestDPSGain = -Infinity;\n\n    for (const strategyId in results) {\n        if (results[strategyId].dpsGain > bestDPSGain) {\n            bestDPSGain = results[strategyId].dpsGain;\n            bestStrategy = strategyId;\n        }\n    }\n\n    // Create summary table\n    let tableHTML = `\n        <div class=\"scrolling-table-wrapper\">\n            <table class=\"scrolling-results-table\">\n                <thead>\n                    <tr>\n                        <th>Strategy</th>\n                        <th>DPS Gain</th>\n                        <th>Avg Attack</th>\n                        <th>Avg Damage Amp</th>\n                        <th>Avg Success</th>\n                        <th>Avg Resets</th>\n                        <th>Avg Trace Used</th>\n                    </tr>\n                </thead>\n                <tbody>\n    `;\n\n    // Sort strategies by DPS gain (descending)\n    const sortedStrategies = Object.entries(results).sort((a, b) => b[1].dpsGain - a[1].dpsGain);\n\n    for (const [strategyId, data] of sortedStrategies) {\n        const isBest = strategyId === bestStrategy;\n        const rowClass = isBest ? 'scrolling-results-table__row--best' : '';\n\n        tableHTML += `\n            <tr class=\"${rowClass}\">\n                <td class=\"scrolling-results-table__cell--strategy\" title=\"${data.strategy.description}\">\n                    ${data.strategy.name}${isBest ? ' \u2B50' : ''}\n                </td>\n                <td class=\"scrolling-results-table__cell--gain\">\n                    +${data.dpsGain.toFixed(2)}%\n                </td>\n                <td>${data.avgAttack.toFixed(1)}</td>\n                <td>${data.avgDamageAmp.toFixed(2)}%</td>\n                <td>${data.avgSuccess.toFixed(1)} / 10</td>\n                <td>${data.avgResets.toFixed(1)}</td>\n                <td>${data.avgTraceUsed.toFixed(0)}</td>\n            </tr>\n        `;\n    }\n\n    tableHTML += '</tbody></table></div>';\n\n    // Add tabbed breakdown for top 5 strategies\n    tableHTML += `\n        <div class=\"scrolling-strategy-tabs\">\n            <div class=\"scrolling-strategy-tabs__header\">\n                <div id=\"scroll-strategy-tabs\" class=\"scrolling-strategy-tabs__buttons\">\n    `;\n\n    const top5 = sortedStrategies.slice(0, 5);\n\n    // Create tab buttons\n    top5.forEach(([strategyId, data], index) => {\n        const isBest = strategyId === bestStrategy;\n        const isActive = index === 0;\n\n        tableHTML += `\n            <button\n                class=\"scrolling-strategy-tab-btn ${isActive ? 'active' : ''}\"\n                data-strategy-id=\"${strategyId}\"\n                onclick=\"window.switchScrollStrategyTab('${strategyId}')\">\n                ${data.strategy.name}${isBest ? ' \u2B50' : ''}\n            </button>\n        `;\n    });\n\n    tableHTML += `\n                </div>\n            </div>\n            <div id=\"scroll-strategy-tab-contents\" class=\"scrolling-strategy-tabs__content\">\n    `;\n\n    // Create tab content for each strategy\n    top5.forEach(([strategyId, data], index) => {\n        const isBest = strategyId === bestStrategy;\n        const isActive = index === 0;\n        const displayStyle = isActive ? 'display: block' : 'display: none';\n\n        // Calculate percentiles for attack\n        const sortedAttacks = [...data.attacks].sort((a, b) => a - b);\n        const p10 = sortedAttacks[Math.floor(sortedAttacks.length * 0.10)];\n        const p50 = sortedAttacks[Math.floor(sortedAttacks.length * 0.50)];\n        const p90 = sortedAttacks[Math.floor(sortedAttacks.length * 0.90)];\n\n        tableHTML += `\n            <div id=\"scroll-strategy-tab-${strategyId}\" class=\"scrolling-strategy-tab-content\" style=\"${displayStyle};\">\n                <p class=\"scrolling-strategy-description\">\n                    ${data.strategy.description}\n                </p>\n\n                <div class=\"scrolling-metrics-grid\">\n                    <div class=\"scrolling-metric-card scrolling-metric-card--highlight\">\n                        <div class=\"scrolling-metric-card__value\">+${data.dpsGain.toFixed(2)}%</div>\n                        <div class=\"scrolling-metric-card__label\">DPS Gain</div>\n                    </div>\n                    <div class=\"scrolling-metric-card\">\n                        <div class=\"scrolling-metric-card__value\">${data.avgAttack.toFixed(1)}</div>\n                        <div class=\"scrolling-metric-card__label\">Avg Attack</div>\n                    </div>\n                    <div class=\"scrolling-metric-card\">\n                        <div class=\"scrolling-metric-card__value\">${data.avgDamageAmp.toFixed(2)}%</div>\n                        <div class=\"scrolling-metric-card__label\">Avg Damage Amp</div>\n                    </div>\n                    <div class=\"scrolling-metric-card\">\n                        <div class=\"scrolling-metric-card__value\">${data.avgSuccess.toFixed(1)}</div>\n                        <div class=\"scrolling-metric-card__label\">Avg Success Slots</div>\n                    </div>\n                    <div class=\"scrolling-metric-card\">\n                        <div class=\"scrolling-metric-card__value\">${data.avgResets.toFixed(1)}</div>\n                        <div class=\"scrolling-metric-card__label\">Avg Resets</div>\n                    </div>\n                    <div class=\"scrolling-metric-card\">\n                        <div class=\"scrolling-metric-card__value\">${data.avgTraceUsed.toFixed(0)}</div>\n                        <div class=\"scrolling-metric-card__label\">Avg Trace Used</div>\n                    </div>\n                </div>\n\n                <div class=\"scrolling-distribution\">\n                    <div class=\"scrolling-distribution__title\">\n                        Attack Distribution (across ${numSimulations.toLocaleString()} simulations):\n                    </div>\n                    <div class=\"scrolling-distribution__percentiles\">\n                        10th percentile: ${p10} | Median: ${p50} | 90th percentile: ${p90}\n                    </div>\n                    ${generateHistogramHTML(data.attacks, numSimulations)}\n                </div>\n\n                <div class=\"scrolling-damage-breakdown\">\n                    <div class=\"scrolling-damage-breakdown__title\">Damage Breakdown:</div>\n                    <div class=\"scrolling-damage-breakdown__stats\">\n                        Base DPS: ${formatNumber(data.baseDPS)}<br>\n                        New DPS: ${formatNumber(data.newDPS)}<br>\n                        Effective Attack Increase (with weapon bonus): +${formatNumber(data.effectiveAttackIncrease)}\n                    </div>\n                </div>\n            </div>\n        `;\n    });\n\n    tableHTML += `\n            </div>\n        </div>\n    `;\n\n    container.innerHTML = tableHTML;\n}\n\n/**\n * Switch between strategy detail tabs\n */\nexport function switchScrollStrategyTab(strategyId: string): void {\n    // Hide all tab contents\n    const allContents = document.querySelectorAll('.scrolling-strategy-tab-content');\n    allContents.forEach(content => {\n        (content as HTMLElement).style.display = 'none';\n    });\n\n    // Remove active state from all tab buttons\n    const allButtons = document.querySelectorAll('.scrolling-strategy-tab-btn');\n    allButtons.forEach(btn => {\n        btn.classList.remove('active');\n    });\n\n    // Show selected tab content\n    const selectedContent = document.getElementById(`scroll-strategy-tab-${strategyId}`);\n    if (selectedContent) {\n        selectedContent.style.display = 'block';\n    }\n\n    // Highlight selected tab button\n    const selectedButton = document.querySelector(`[data-strategy-id=\"${strategyId}\"]`);\n    if (selectedButton) {\n        selectedButton.classList.add('active');\n    }\n}\n\n/**\n * Main simulation runner\n */\nexport async function runScrollSimulation(): Promise<void> {\n    const numSimsInput = document.getElementById('scroll-simulations') as HTMLInputElement;\n\n    if (!numSimsInput) return;\n\n    const budget = 500000;\n    const numSimulations = parseInt(numSimsInput.value);\n    const scrolls = getScrollsForLevel(currentScrollLevel);\n\n    const button = document.getElementById('scroll-run-btn') as HTMLButtonElement;\n    const progressContainer = document.getElementById('scroll-progress-container') as HTMLElement;\n    const progressBar = document.getElementById('scroll-progress-bar') as HTMLElement;\n    const progressText = document.getElementById('scroll-progress-text') as HTMLElement;\n\n    if (button) button.disabled = true;\n    if (progressContainer) progressContainer.style.display = 'block';\n\n    // Get strategies based on selected scroll level\n    const strategies = currentScrollLevel === '65' ? createL65Strategies() : createL85Strategies();\n    const enhancementBonus = getEnhancementBonus();\n\n    const results: Record<string, SimulationResult> = {};\n\n    // Initialize results tracking\n    for (const strategy of strategies) {\n        results[strategy.id] = {\n            strategy,\n            attacks: [],\n            damageAmps: [],\n            successCounts: [],\n            resetCounts: [],\n            traceUsed: [],\n            avgAttack: 0,\n            avgDamageAmp: 0,\n            avgSuccess: 0,\n            avgResets: 0,\n            avgTraceUsed: 0,\n            dpsGain: 0,\n            baseDPS: 0,\n            newDPS: 0,\n            effectiveAttackIncrease: 0,\n            exampleResult: null\n        };\n    }\n\n    // Run simulations\n    for (let sim = 0; sim < numSimulations; sim++) {\n        if (sim % 50 === 0) {\n            const progress = (sim / numSimulations) * 100;\n            if (progressBar) progressBar.style.width = progress + '%';\n            if (progressText) progressText.textContent = `${sim} / ${numSimulations}`;\n            await new Promise(resolve => setTimeout(resolve, 0));\n        }\n\n        for (const strategy of strategies) {\n            const result = simulateScrollWithResets(strategy, budget, scrolls, enhancementBonus);\n\n            const data = results[strategy.id];\n            data.attacks.push(result.totalAttack);\n            data.damageAmps.push(result.totalDamageAmp);\n            data.successCounts.push(result.successfulSlots);\n            data.resetCounts.push(result.resetCount);\n            data.traceUsed.push(result.traceUsed);\n\n            // Store last result as example\n            if (sim === numSimulations - 1) {\n                data.exampleResult = result;\n            }\n        }\n    }\n\n    // Calculate averages and damage gains\n    for (const strategyId in results) {\n        const data = results[strategyId];\n        data.avgAttack = data.attacks.reduce((a, b) => a + b, 0) / numSimulations;\n        data.avgDamageAmp = data.damageAmps.reduce((a, b) => a + b, 0) / numSimulations;\n        data.avgSuccess = data.successCounts.reduce((a, b) => a + b, 0) / numSimulations;\n        data.avgResets = data.resetCounts.reduce((a, b) => a + b, 0) / numSimulations;\n        data.avgTraceUsed = data.traceUsed.reduce((a, b) => a + b, 0) / numSimulations;\n\n        // Calculate damage gain\n        const damageGain = calculateScrollDamageGain(data.avgAttack, data.avgDamageAmp);\n        data.dpsGain = damageGain.dpsGain;\n        data.baseDPS = damageGain.baseDPS;\n        data.newDPS = damageGain.newDPS;\n        data.effectiveAttackIncrease = damageGain.effectiveAttackIncrease;\n    }\n\n    displayScrollResults(results, budget, numSimulations);\n\n    if (button) button.disabled = false;\n    if (progressContainer) progressContainer.style.display = 'none';\n}\n\n/**\n * Initialize the scrolling optimizer UI\n */\nexport function initializeScrollingUI(): void {\n    const container = document.getElementById('optimization-scroll-optimizer');\n    if (!container) {\n        console.error('Scrolling optimizer container not found');\n        return;\n    }\n\n    // Generate HTML\n    container.innerHTML = generateScrollingHTML();\n\n    // Initialize default tab\n    renderMySlotPerformance();\n    renderSimulation();\n\n    loadoutStore.on('stat:changed', debounce((_) => {\n        updateAllSlotCalculations();\n    }, 3000));    \n}\n\n// ============================================================================\n// WINDOW EXPORTS\n// ============================================================================\n\n// Export functions to window for onclick handlers\nif (typeof window !== 'undefined') {\n    (window as any).switchScrollingSubTab = switchScrollingSubTab;\n    (window as any).runScrollSimulation = runScrollSimulation;\n    (window as any).updateScrollLevelInfo = updateScrollLevelInfo;\n    (window as any).switchScrollStrategyTab = switchScrollStrategyTab;\n    (window as any).updateGuildSkillDisplay = updateGuildSkillDisplay;\n    (window as any).saveEquipmentSlots = saveEquipmentSlots;\n}\n"],
  "mappings": "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",
  "names": []
}
