{
  "version": 3,
  "sources": ["scrolling-ui.ts"],
  "sourcesContent": ["/**\r\n * Scroll Optimizer UI - Pure UI Layer\r\n *\r\n * Handles all HTML generation and UI event handling for the scrolling optimizer tab.\r\n */\r\n\r\nimport { formatNumber } from '@ts/utils/formatters.js';\r\nimport { getScrollsForLevel, calculateScrollDamageGain } from '@ts/page/scrolling/scrolling.js';\r\nimport { gearLabStore } from '@ts/store/gear-lab-store.js';\r\nimport { loadoutStore } from '@ts/store/loadout.store.js';\r\nimport { VALID_EQUIPMENT_SLOTS } from '@ts/types/page/gear-lab/gear-lab.types.js';\r\nimport type { EquipmentSlotId, EquipmentSlotData } from '@ts/types/page/gear-lab/gear-lab.types.js';\r\nimport type {\r\n    ScrollStrategy,\r\n    SimulationResult,\r\n    ScrollLevel,\r\n    EnhancementBonus,\r\n    ScrollRunResult\r\n} from '@ts/types/page/scrolling/scrolling.types.js';\r\nimport { STAT } from '@ts/types/constants.js';\r\nimport { StatCalculationService } from '@ts/services/stat-calculation-service.js';\r\n\r\n// Re-import simulation functions from logic layer\r\nimport {\r\n    simulateScrollWithResets,\r\n    createL65Strategies,\r\n    createL85Strategies\r\n} from '@ts/page/scrolling/scrolling.js';\r\nimport { debounce } from '@ts/utils/event-emitter';\r\n\r\n// ============================================================================\r\n// STATE\r\n// ============================================================================\r\n\r\nlet currentScrollLevel: ScrollLevel = '85';\r\n\r\n// ============================================================================\r\n// HTML GENERATION\r\n// ============================================================================\r\n\r\n/**\r\n * Generate HTML for scroll level info display\r\n */\r\nfunction generateScrollLevelInfoHTML(level: ScrollLevel, enhancementBonus: EnhancementBonus): string {\r\n    const bonusDisplay = enhancementBonus.total > 0\r\n        ? `<br><strong class=\"scrolling-level-info__bonus\">Enhancement Bonus: +${(enhancementBonus.total * 100).toFixed(0)}% success rate</strong>`\r\n        : '';\r\n\r\n    if (level === '65') {\r\n        const scrolls = getScrollsForLevel('65');\r\n        const l65_70_rate = ((scrolls.L65_70.baseSuccess + enhancementBonus.total) * 100).toFixed(0);\r\n        const l65_30_rate = ((scrolls.L65_30.baseSuccess + enhancementBonus.total) * 100).toFixed(0);\r\n\r\n        return `\r\n            <strong>Level 65 Scrolls:</strong>${bonusDisplay}<br>\r\n            \u2022 70%: <strong>${l65_70_rate}%</strong> effective rate (+100 ATK, 250 spell trace)<br>\r\n            \u2022 30%: <strong>${l65_30_rate}%</strong> effective rate (+200 ATK, +0.1% Damage Amp, 300 spell trace)\r\n        `;\r\n    } else {\r\n        const scrolls = getScrollsForLevel('85');\r\n        const l85_70_rate = ((scrolls.L85_70.baseSuccess + enhancementBonus.total) * 100).toFixed(0);\r\n        const l85_30_rate = ((scrolls.L85_30.baseSuccess + enhancementBonus.total) * 100).toFixed(0);\r\n        const l85_15_rate = ((scrolls.L85_15.baseSuccess + enhancementBonus.total) * 100).toFixed(0);\r\n\r\n        return `\r\n            <strong>Level 85 Scrolls:</strong>${bonusDisplay}<br>\r\n            \u2022 70%: <strong>${l85_70_rate}%</strong> effective rate (+200 ATK, +0.2% Damage Amp, 500 spell trace)<br>\r\n            \u2022 30%: <strong>${l85_30_rate}%</strong> effective rate (+400 ATK, +0.4% Damage Amp, 650 spell trace)<br>\r\n            \u2022 15%: <strong>${l85_15_rate}%</strong> effective rate (+800 ATK, +0.8% Damage Amp, 800 spell trace)\r\n        `;\r\n    }\r\n}\r\n\r\n/**\r\n * Generate HTML for My Slot Performance tab\r\n */\r\nfunction generateMySlotPerformanceHTML(): string {\r\n    return `\r\n        <div class=\"optimization-info-banner\">\r\n            <span class=\"optimization-info-banner-icon\">\u2139\uFE0F</span>\r\n            <div class=\"optimization-info-banner__text\">\r\n                <strong>Equipment Slot Analysis:</strong> Track individual equipment slot values in isolation. Each slot's DPS gain is calculated by comparing damage WITH that slot's stats vs damage WITH zero stats from that slot. DPS updates automatically as you type.\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Summary Header -->\r\n        <div class=\"slot-summary-header\">\r\n            <div class=\"summary-metric\">\r\n                <div class=\"summary-metric-label\">Total Attack</div>\r\n                <div class=\"summary-metric-value atk\" id=\"total-attack\">0</div>\r\n            </div>\r\n            <div class=\"summary-metric\">\r\n                <div class=\"summary-metric-label\">Total Main Stat</div>\r\n                <div class=\"summary-metric-value main\" id=\"total-main\">0</div>\r\n            </div>\r\n            <div class=\"summary-metric\">\r\n                <div class=\"summary-metric-label\">Total Dmg Amp</div>\r\n                <div class=\"summary-metric-value amp\" id=\"total-amp\">0%</div>\r\n            </div>\r\n            <div class=\"summary-metric\">\r\n                <div class=\"summary-metric-label\">Total DPS Gain</div>\r\n                <div class=\"summary-metric-value dps\" id=\"total-dps\">0%</div>\r\n            </div>\r\n        </div>\r\n\r\n        <div id=\"equipment-slots-grid\" class=\"scrolling-slots-grid\">\r\n            <!-- Slot cards generated by JavaScript -->\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Generate HTML for Simulation tab\r\n */\r\nfunction generateSimulationHTML(): string {\r\n    return `\r\n        <div class=\"optimization-info-banner\">\r\n            <span class=\"optimization-info-banner-icon\">\u26A1</span>\r\n            <div class=\"optimization-info-banner__text\">\r\n                <strong>Scroll Optimizer:</strong> Simulates different scrolling strategies using Level 65 scrolls to find the optimal approach. The damage gain shows how much your DPS will increase from the average scroll results.\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"scrolling-inputs-grid\">\r\n            <div class=\"input-group\">\r\n                <label>Spell Trace Budget</label>\r\n                <input type=\"number\" id=\"scroll-spell-trace-budget\" value=\"7000\" min=\"500\" max=\"50000\" step=\"100\">\r\n            </div>\r\n            <div class=\"input-group\">\r\n                <label>Number of Simulations</label>\r\n                <input type=\"number\" id=\"scroll-simulations\" value=\"1000\" min=\"100\" max=\"10000\" step=\"100\">\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"scrolling-enhancements\">\r\n            <div class=\"scrolling-enhancements__grid\">\r\n                <label class=\"scrolling-premium__label\">\r\n                    <input type=\"checkbox\" id=\"scroll-premium-membership\" class=\"scrolling-premium__checkbox\" onchange=\"window.updateScrollLevelInfo()\">\r\n                    <span class=\"scrolling-premium__text\">\r\n                        Premium\r\n                        <span class=\"scrolling-premium__badge\">+2%</span>\r\n                    </span>\r\n                </label>\r\n\r\n                <div class=\"scrolling-guild\">\r\n                    <span class=\"scrolling-guild__icon\">\u2694\uFE0F</span>\r\n                    <span class=\"scrolling-guild__label\">Guild Skill</span>\r\n                    <div class=\"scrolling-guild__slider-container\">\r\n                        <input type=\"range\" id=\"scroll-guild-skill\" class=\"scrolling-guild__slider\" min=\"0\" max=\"3\" step=\"1\" value=\"0\"\r\n                               oninput=\"window.updateGuildSkillDisplay(); window.updateScrollLevelInfo();\"\r\n                               data-value=\"0\">\r\n                    </div>\r\n                    <span id=\"guild-skill-value\" class=\"scrolling-guild__value\">0%</span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"scrolling-level-selector\">\r\n            <label class=\"scrolling-level-selector__label\">Scroll Level</label>\r\n            <div class=\"scrolling-level-selector__options\">\r\n                <label class=\"scrolling-level-radio\">\r\n                    <input type=\"radio\" name=\"scroll-level\" value=\"65\" onchange=\"window.updateScrollLevelInfo()\">\r\n                    <span>Level 65 Scrolls</span>\r\n                </label>\r\n                <label class=\"scrolling-level-radio\">\r\n                    <input type=\"radio\" name=\"scroll-level\" value=\"85\" checked onchange=\"window.updateScrollLevelInfo()\">\r\n                    <span>Level 85 Scrolls</span>\r\n                </label>\r\n            </div>\r\n            <div id=\"scroll-level-info\" class=\"scrolling-level-info\">\r\n                <!-- Info populated by JavaScript -->\r\n            </div>\r\n        </div>\r\n\r\n        <button class=\"calculate-btn scrolling-run-btn\" onclick=\"window.runScrollSimulation()\" id=\"scroll-run-btn\">Run Simulation</button>\r\n\r\n        <div id=\"scroll-progress-container\" class=\"scrolling-progress\" style=\"display: none;\">\r\n            <div class=\"scrolling-progress__track\">\r\n                <div id=\"scroll-progress-bar\" class=\"scrolling-progress__bar\"></div>\r\n            </div>\r\n            <p id=\"scroll-progress-text\" class=\"scrolling-progress__text\"></p>\r\n        </div>\r\n\r\n        <div id=\"scroll-results-container\" class=\"scrolling-results\">\r\n            <!-- Results populated by JavaScript -->\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Generate the complete HTML for the scrolling optimizer tab\r\n */\r\nexport function generateScrollingHTML(): string {\r\n    return `\r\n        <div class=\"tab-navigation\">\r\n            <button id=\"scrolling-tab-button\" class=\"tab-button active\" onclick=\"window.switchScrollingSubTab('my-slot-performance')\">My Slot Performance</button>\r\n            <button id=\"scrolling-tab-button\" class=\"tab-button\" onclick=\"window.switchScrollingSubTab('simulation')\">Simulation</button>\r\n        </div>\r\n\r\n        <!-- My Slot Performance Sub-Tab -->\r\n        <div id=\"scrolling-my-slot-performance\" class=\"scrolling-subtab active\">\r\n            ${generateMySlotPerformanceHTML()}\r\n        </div>\r\n\r\n        <!-- Simulation Sub-Tab -->\r\n        <div id=\"scrolling-simulation\" class=\"scrolling-subtab\" style=\"display: none;\">\r\n            ${generateSimulationHTML()}\r\n        </div>\r\n    `;\r\n}\r\n\r\n// ============================================================================\r\n// UI FUNCTIONS\r\n// ============================================================================\r\n\r\n/**\r\n * Update Guild Skill display value\r\n */\r\nexport function updateGuildSkillDisplay(): void {\r\n    const slider = document.getElementById('scroll-guild-skill') as HTMLInputElement;\r\n    const display = document.getElementById('guild-skill-value');\r\n    if (slider && display) {\r\n        const value = slider.value;\r\n        display.textContent = value + '%';\r\n\r\n        // Update styling based on value\r\n        if (parseInt(value) > 0) {\r\n            display.classList.add('boosted');\r\n        } else {\r\n            display.classList.remove('boosted');\r\n        }\r\n\r\n        // Update slider data attribute for CSS styling\r\n        slider.setAttribute('data-value', value);\r\n\r\n        // Update tick marks\r\n        const ticks = document.querySelectorAll('.scrolling-guild__tick');\r\n        ticks.forEach((tick, index) => {\r\n            if (index <= parseInt(value)) {\r\n                tick.classList.add('active');\r\n            } else {\r\n                tick.classList.remove('active');\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Update scroll level info display\r\n */\r\nexport function updateScrollLevelInfo(): void {\r\n    const levelRadio = document.querySelector<HTMLInputElement>('input[name=\"scroll-level\"]:checked');\r\n    const level = (levelRadio?.value || '65') as ScrollLevel;\r\n    currentScrollLevel = level;\r\n\r\n    const infoDiv = document.getElementById('scroll-level-info');\r\n    if (!infoDiv) return;\r\n\r\n    const enhancementBonus = getEnhancementBonus();\r\n    infoDiv.innerHTML = generateScrollLevelInfoHTML(level, enhancementBonus);\r\n}\r\n\r\n/**\r\n * Get enhancement bonus from UI\r\n */\r\nfunction getEnhancementBonus(): EnhancementBonus {\r\n    const premiumCheckbox = document.getElementById('scroll-premium-membership') as HTMLInputElement;\r\n    const guildSlider = document.getElementById('scroll-guild-skill') as HTMLInputElement;\r\n\r\n    const premium = premiumCheckbox && premiumCheckbox.checked ? 0.02 : 0;\r\n    const guild = guildSlider ? (parseInt(guildSlider.value) / 100) : 0;\r\n\r\n    return {\r\n        premium,\r\n        guild,\r\n        total: premium + guild\r\n    };\r\n}\r\n\r\n/**\r\n * Switch scrolling sub-tabs\r\n */\r\nexport function switchScrollingSubTab(tabName: string): void {\r\n    const allSubTabContent = document.querySelectorAll('.scrolling-subtab');\r\n    const allSubTabButtons = document.querySelectorAll('#scrolling-tab-button');\r\n\r\n    // Hide all subtabs\r\n    allSubTabContent.forEach(tab => {\r\n        tab.classList.remove('active');\r\n        (tab as HTMLElement).style.display = 'none';\r\n    });\r\n\r\n    // Remove active from all buttons\r\n    allSubTabButtons.forEach(btn => {\r\n        btn.classList.remove('active');\r\n    });\r\n\r\n    // Show selected subtab\r\n    const selectedTab = document.getElementById(`scrolling-${tabName}`);\r\n    if (selectedTab) {\r\n        selectedTab.classList.add('active');\r\n        selectedTab.style.display = 'block';\r\n    }\r\n\r\n    // Activate button\r\n    allSubTabButtons.forEach(btn => {\r\n        const onclickAttr = btn.getAttribute('onclick');\r\n        if (onclickAttr && onclickAttr.includes(`'${tabName}'`)) {\r\n            btn.classList.add('active');\r\n        }\r\n    });\r\n\r\n    // Render content\r\n    if (tabName === 'my-slot-performance') {\r\n        renderMySlotPerformance();\r\n    } else if (tabName === 'simulation') {\r\n        renderSimulation();\r\n    }\r\n}\r\n\r\n/**\r\n * Render My Slot Performance tab\r\n */\r\nfunction renderMySlotPerformance(): void {\r\n    const container = document.getElementById('scrolling-my-slot-performance');\r\n    if (!container) return;\r\n\r\n    container.innerHTML = generateMySlotPerformanceHTML();\r\n\r\n    // Initialize equipment slots after DOM is ready\r\n    setTimeout(() => {\r\n        initializeEquipmentSlots();\r\n        loadEquipmentSlots();\r\n    }, 0);\r\n}\r\n\r\nfunction initializeEquipmentSlots() {\r\n    const slots = ['Head', 'Cape', 'Chest', 'Shoulders', 'Legs', 'Belt', 'Gloves', 'Boots', 'Ring', 'Neck', 'Eye Accessory'];\r\n    const container = document.getElementById('equipment-slots-grid');\r\n    if (!container) return;\r\n\r\n    let html = '';\r\n    slots.forEach((slotName) => {\r\n        const slotId = slotName.toLowerCase().replace(/\\s+/g, '-');\r\n        html += `\r\n            <div class=\"slot-card\" data-slot-id=\"${slotId}\">\r\n                <div class=\"slot-card-header\">\r\n                    <div class=\"slot-name\">${slotName}</div>\r\n                    <div class=\"slot-dps\" id=\"slot-${slotId}-dps\">+0.00%</div>\r\n                </div>\r\n                <div class=\"slot-inputs\">\r\n                    <div class=\"slot-input-row\">\r\n                        <label class=\"slot-input-label atk\">ATTACK</label>\r\n                        <input type=\"number\" class=\"slot-input\" id=\"slot-${slotId}-attack\" data-slot=\"${slotId}\" step=\"0.1\" min=\"0\" value=\"0\">\r\n                    </div>\r\n                    <div class=\"slot-input-row\">\r\n                        <label class=\"slot-input-label main\">MAIN STAT</label>\r\n                        <input type=\"number\" class=\"slot-input\" id=\"slot-${slotId}-main-stat\" data-slot=\"${slotId}\" step=\"1\" min=\"0\" value=\"0\">\r\n                    </div>\r\n                    <div class=\"slot-input-row\">\r\n                        <label class=\"slot-input-label amp\">DAMAGE AMP</label>\r\n                        <input type=\"number\" class=\"slot-input\" id=\"slot-${slotId}-damage-amp\" data-slot=\"${slotId}\" step=\"0.1\" min=\"0\" value=\"0\">\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        `;\r\n    });\r\n\r\n    container.innerHTML = html;\r\n\r\n    // Attach input listeners for real-time calculation\r\n    setTimeout(() => {\r\n        slots.forEach(slot => {\r\n            const slotId = slot.toLowerCase().replace(/\\s+/g, '-');\r\n            const attackInput = document.getElementById(`slot-${slotId}-attack`);\r\n            const mainStatInput = document.getElementById(`slot-${slotId}-main-stat`);\r\n            const damageAmpInput = document.getElementById(`slot-${slotId}-damage-amp`);\r\n\r\n            if (attackInput) {\r\n                attackInput.addEventListener('input', (e) => handleSlotInputChange(slotId as EquipmentSlotId));\r\n            }\r\n            if (mainStatInput) {\r\n                mainStatInput.addEventListener('input', (e) => handleSlotInputChange(slotId as EquipmentSlotId));\r\n            }\r\n            if (damageAmpInput) {\r\n                damageAmpInput.addEventListener('input', (e) => handleSlotInputChange(slotId as EquipmentSlotId));\r\n            }\r\n        });\r\n\r\n        // Initial calculation\r\n        updateAllSlotCalculations();\r\n    }, 0);\r\n}\r\n\r\n/**\r\n * Handle individual slot input change - calculate DPS in real-time\r\n */\r\nfunction handleSlotInputChange(slotId: EquipmentSlotId): void {\r\n    // Save to store\r\n    saveEquipmentSlots();\r\n\r\n    // Calculate this slot's DPS\r\n    calculateSlotDPS(slotId);\r\n\r\n    // Update totals\r\n    updateSlotTotals();\r\n}\r\n\r\n/**\r\n * Calculate DPS gain for a single slot\r\n */\r\nfunction calculateSlotDPS(slotId: EquipmentSlotId): void {\r\n    const attackInput = document.getElementById(`slot-${slotId}-attack`) as HTMLInputElement | null;\r\n    const mainStatInput = document.getElementById(`slot-${slotId}-main-stat`) as HTMLInputElement | null;\r\n    const damageAmpInput = document.getElementById(`slot-${slotId}-damage-amp`) as HTMLInputElement | null;\r\n    const dpsDisplay = document.getElementById(`slot-${slotId}-dps`);\r\n\r\n    if (!attackInput || !mainStatInput || !damageAmpInput || !dpsDisplay) return;\r\n\r\n    const attack = parseFloat(attackInput.value) || 0;\r\n    const mainStat = parseFloat(mainStatInput.value) || 0;\r\n    const damageAmp = parseFloat(damageAmpInput.value) || 0;\r\n\r\n    // Calculate DPS gain for this slot using StatCalculationService\r\n    const baseStats = loadoutStore.getBaseStats();\r\n    const service = new StatCalculationService(baseStats);\r\n\r\n    // Base DPS without this slot\r\n    const baseDPS = service.computeDPS('boss');\r\n\r\n    // Add this slot's stats\r\n    service.add(STAT.ATTACK.id, attack);\r\n    service.add(STAT.PRIMARY_MAIN_STAT.id, mainStat);\r\n    service.add(STAT.DAMAGE_AMP.id, damageAmp);\r\n\r\n    // New DPS with this slot\r\n    const newDPS = service.computeDPS('boss');\r\n    const dpsGain = ((newDPS - baseDPS) / baseDPS * 100);\r\n\r\n    dpsDisplay.textContent = `+${dpsGain.toFixed(2)}%`;\r\n}\r\n\r\n/**\r\n * Update all slot calculations\r\n */\r\nfunction updateAllSlotCalculations(): void {\r\n    VALID_EQUIPMENT_SLOTS.forEach(slotId => {\r\n        calculateSlotDPS(slotId);\r\n    });\r\n    updateSlotTotals();\r\n}\r\n\r\n/**\r\n * Update summary totals for all slots\r\n */\r\nfunction updateSlotTotals(): void {\r\n    let totalAttack = 0;\r\n    let totalMainStat = 0;\r\n    let totalDamageAmp = 0;\r\n    let totalDPSGain = 0;\r\n\r\n    VALID_EQUIPMENT_SLOTS.forEach(slotId => {\r\n        const attackInput = document.getElementById(`slot-${slotId}-attack`) as HTMLInputElement | null;\r\n        const mainStatInput = document.getElementById(`slot-${slotId}-main-stat`) as HTMLInputElement | null;\r\n        const damageAmpInput = document.getElementById(`slot-${slotId}-damage-amp`) as HTMLInputElement | null;\r\n        const dpsDisplay = document.getElementById(`slot-${slotId}-dps`);\r\n\r\n        if (attackInput) totalAttack += parseFloat(attackInput.value) || 0;\r\n        if (mainStatInput) totalMainStat += parseFloat(mainStatInput.value) || 0;\r\n        if (damageAmpInput) totalDamageAmp += parseFloat(damageAmpInput.value) || 0;\r\n        if (dpsDisplay) {\r\n            const dpsText = dpsDisplay.textContent || '+0.00%';\r\n            totalDPSGain += parseFloat(dpsText.replace('+', '').replace('%', '')) || 0;\r\n        }\r\n    });\r\n\r\n    const totalAttackEl = document.getElementById('total-attack');\r\n    const totalMainEl = document.getElementById('total-main');\r\n    const totalAmpEl = document.getElementById('total-amp');\r\n    const totalDpsEl = document.getElementById('total-dps');\r\n\r\n    if (totalAttackEl) totalAttackEl.textContent = totalAttack.toFixed(1);\r\n    if (totalMainEl) totalMainEl.textContent = totalMainStat.toFixed(0);\r\n    if (totalAmpEl) totalAmpEl.textContent = totalDamageAmp.toFixed(1) + '%';\r\n    if (totalDpsEl) totalDpsEl.textContent = '+' + totalDPSGain.toFixed(2) + '%';\r\n}\r\n\r\nexport function saveEquipmentSlots() {\r\n    const slots: Partial<Record<EquipmentSlotId, EquipmentSlotData>> = {};\r\n\r\n    VALID_EQUIPMENT_SLOTS.forEach(slotId => {\r\n        const attackInput = document.getElementById(`slot-${slotId}-attack`) as HTMLInputElement | null;\r\n        const mainStatInput = document.getElementById(`slot-${slotId}-main-stat`) as HTMLInputElement | null;\r\n        const damageAmpInput = document.getElementById(`slot-${slotId}-damage-amp`) as HTMLInputElement | null;\r\n\r\n        slots[slotId] = {\r\n            attack: attackInput ? parseFloat(attackInput.value) || 0 : 0,\r\n            mainStat: mainStatInput ? parseFloat(mainStatInput.value) || 0 : 0,\r\n            damageAmp: damageAmpInput ? parseFloat(damageAmpInput.value) || 0 : 0\r\n        };\r\n    });\r\n\r\n    gearLabStore.updateAllEquipmentSlots(slots);\r\n\r\n    // Notify stat contributors to update stat breakdown\r\n    if (window.notifyStatContributors) {\r\n        window.notifyStatContributors();\r\n    }\r\n}\r\n\r\nfunction loadEquipmentSlots() {\r\n    const slots = gearLabStore.getEquipmentSlots();\r\n\r\n    VALID_EQUIPMENT_SLOTS.forEach(slotId => {\r\n        if (slots[slotId]) {\r\n            const attackInput = document.getElementById(`slot-${slotId}-attack`) as HTMLInputElement | null;\r\n            const mainStatInput = document.getElementById(`slot-${slotId}-main-stat`) as HTMLInputElement | null;\r\n            const damageAmpInput = document.getElementById(`slot-${slotId}-damage-amp`) as HTMLInputElement | null;\r\n\r\n            if (attackInput) attackInput.value = String(slots[slotId].attack || 0);\r\n            if (mainStatInput) mainStatInput.value = String(slots[slotId].mainStat || 0);\r\n            if (damageAmpInput) damageAmpInput.value = String(slots[slotId].damageAmp || 0);\r\n        }\r\n    });\r\n\r\n    // Recalculate all slots after loading\r\n    updateAllSlotCalculations();\r\n}\r\n\r\n\r\n\r\n/**\r\n * Render Simulation tab\r\n */\r\nfunction renderSimulation(): void {\r\n    const container = document.getElementById('scrolling-simulation');\r\n    if (!container) return;\r\n\r\n    container.innerHTML = generateSimulationHTML();\r\n\r\n    // Initialize scroll level info after DOM is ready\r\n    setTimeout(() => {\r\n        updateScrollLevelInfo();\r\n    }, 0);\r\n}\r\n\r\n/**\r\n * Generate histogram HTML for attack distribution\r\n */\r\nfunction generateHistogramHTML(attacks: number[], numSimulations: number): string {\r\n    const binSize = 50;\r\n    const maxAttack = Math.max(...attacks);\r\n    const numBins = Math.ceil(maxAttack / binSize) + 1;\r\n    const bins = new Array(numBins).fill(0);\r\n\r\n    // Count simulations in each bin\r\n    attacks.forEach(attack => {\r\n        const binIndex = Math.floor(attack / binSize);\r\n        bins[binIndex]++;\r\n    });\r\n\r\n    // Find max count for scaling\r\n    const maxCount = Math.max(...bins);\r\n\r\n    // Generate histogram HTML\r\n    let histogramHTML = '<div class=\"scrolling-histogram\">';\r\n\r\n    // Only show bins that have at least 1 simulation\r\n    bins.forEach((count, index) => {\r\n        if (count > 0) {\r\n            const rangeStart = index * binSize;\r\n            const rangeEnd = (index + 1) * binSize;\r\n            const percentage = (count / numSimulations * 100).toFixed(1);\r\n            const barWidth = (count / maxCount * 100).toFixed(1);\r\n\r\n            histogramHTML += `\r\n                <div class=\"scrolling-histogram__bar-row\">\r\n                    <div class=\"scrolling-histogram__label\">${rangeStart}-${rangeEnd}:</div>\r\n                    <div class=\"scrolling-histogram__bar-track\">\r\n                        <div class=\"scrolling-histogram__bar-fill\" style=\"width: ${barWidth}%\"></div>\r\n                    </div>\r\n                    <div class=\"scrolling-histogram__count\">${count} (${percentage}%)</div>\r\n                </div>\r\n            `;\r\n        }\r\n    });\r\n\r\n    histogramHTML += '</div>';\r\n    return histogramHTML;\r\n}\r\n\r\n/**\r\n * Display simulation results\r\n */\r\nexport function displayScrollResults(\r\n    results: Record<string, SimulationResult>,\r\n    budget: number,\r\n    numSimulations: number\r\n): void {\r\n    const container = document.getElementById('scroll-results-container');\r\n    if (!container) return;\r\n\r\n    container.innerHTML = '';\r\n\r\n    // Find best strategy by DPS gain\r\n    let bestStrategy: string | null = null;\r\n    let bestDPSGain = -Infinity;\r\n\r\n    for (const strategyId in results) {\r\n        if (results[strategyId].dpsGain > bestDPSGain) {\r\n            bestDPSGain = results[strategyId].dpsGain;\r\n            bestStrategy = strategyId;\r\n        }\r\n    }\r\n\r\n    // Create summary table\r\n    let tableHTML = `\r\n        <div class=\"scrolling-table-wrapper\">\r\n            <table class=\"scrolling-results-table\">\r\n                <thead>\r\n                    <tr>\r\n                        <th>Strategy</th>\r\n                        <th>DPS Gain</th>\r\n                        <th>Avg Attack</th>\r\n                        <th>Avg Damage Amp</th>\r\n                        <th>Avg Success</th>\r\n                        <th>Avg Resets</th>\r\n                        <th>Avg Trace Used</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n    `;\r\n\r\n    // Sort strategies by DPS gain (descending)\r\n    const sortedStrategies = Object.entries(results).sort((a, b) => b[1].dpsGain - a[1].dpsGain);\r\n\r\n    for (const [strategyId, data] of sortedStrategies) {\r\n        const isBest = strategyId === bestStrategy;\r\n        const rowClass = isBest ? 'scrolling-results-table__row--best' : '';\r\n\r\n        tableHTML += `\r\n            <tr class=\"${rowClass}\">\r\n                <td class=\"scrolling-results-table__cell--strategy\" title=\"${data.strategy.description}\">\r\n                    ${data.strategy.name}${isBest ? ' \u2B50' : ''}\r\n                </td>\r\n                <td class=\"scrolling-results-table__cell--gain\">\r\n                    +${data.dpsGain.toFixed(2)}%\r\n                </td>\r\n                <td>${data.avgAttack.toFixed(1)}</td>\r\n                <td>${data.avgDamageAmp.toFixed(2)}%</td>\r\n                <td>${data.avgSuccess.toFixed(1)} / 10</td>\r\n                <td>${data.avgResets.toFixed(1)}</td>\r\n                <td>${data.avgTraceUsed.toFixed(0)} / ${budget}</td>\r\n            </tr>\r\n        `;\r\n    }\r\n\r\n    tableHTML += '</tbody></table></div>';\r\n\r\n    // Add tabbed breakdown for top 5 strategies\r\n    tableHTML += `\r\n        <div class=\"scrolling-strategy-tabs\">\r\n            <div class=\"scrolling-strategy-tabs__header\">\r\n                <div id=\"scroll-strategy-tabs\" class=\"scrolling-strategy-tabs__buttons\">\r\n    `;\r\n\r\n    const top5 = sortedStrategies.slice(0, 5);\r\n\r\n    // Create tab buttons\r\n    top5.forEach(([strategyId, data], index) => {\r\n        const isBest = strategyId === bestStrategy;\r\n        const isActive = index === 0;\r\n\r\n        tableHTML += `\r\n            <button\r\n                class=\"scrolling-strategy-tab-btn ${isActive ? 'active' : ''}\"\r\n                data-strategy-id=\"${strategyId}\"\r\n                onclick=\"window.switchScrollStrategyTab('${strategyId}')\">\r\n                ${data.strategy.name}${isBest ? ' \u2B50' : ''}\r\n            </button>\r\n        `;\r\n    });\r\n\r\n    tableHTML += `\r\n                </div>\r\n            </div>\r\n            <div id=\"scroll-strategy-tab-contents\" class=\"scrolling-strategy-tabs__content\">\r\n    `;\r\n\r\n    // Create tab content for each strategy\r\n    top5.forEach(([strategyId, data], index) => {\r\n        const isBest = strategyId === bestStrategy;\r\n        const isActive = index === 0;\r\n        const displayStyle = isActive ? 'display: block' : 'display: none';\r\n\r\n        // Calculate percentiles for attack\r\n        const sortedAttacks = [...data.attacks].sort((a, b) => a - b);\r\n        const p10 = sortedAttacks[Math.floor(sortedAttacks.length * 0.10)];\r\n        const p50 = sortedAttacks[Math.floor(sortedAttacks.length * 0.50)];\r\n        const p90 = sortedAttacks[Math.floor(sortedAttacks.length * 0.90)];\r\n\r\n        tableHTML += `\r\n            <div id=\"scroll-strategy-tab-${strategyId}\" class=\"scrolling-strategy-tab-content\" style=\"${displayStyle};\">\r\n                <p class=\"scrolling-strategy-description\">\r\n                    ${data.strategy.description}\r\n                </p>\r\n\r\n                <div class=\"scrolling-metrics-grid\">\r\n                    <div class=\"scrolling-metric-card scrolling-metric-card--highlight\">\r\n                        <div class=\"scrolling-metric-card__value\">+${data.dpsGain.toFixed(2)}%</div>\r\n                        <div class=\"scrolling-metric-card__label\">DPS Gain</div>\r\n                    </div>\r\n                    <div class=\"scrolling-metric-card\">\r\n                        <div class=\"scrolling-metric-card__value\">${data.avgAttack.toFixed(1)}</div>\r\n                        <div class=\"scrolling-metric-card__label\">Avg Attack</div>\r\n                    </div>\r\n                    <div class=\"scrolling-metric-card\">\r\n                        <div class=\"scrolling-metric-card__value\">${data.avgDamageAmp.toFixed(2)}%</div>\r\n                        <div class=\"scrolling-metric-card__label\">Avg Damage Amp</div>\r\n                    </div>\r\n                    <div class=\"scrolling-metric-card\">\r\n                        <div class=\"scrolling-metric-card__value\">${data.avgSuccess.toFixed(1)}</div>\r\n                        <div class=\"scrolling-metric-card__label\">Avg Success Slots</div>\r\n                    </div>\r\n                    <div class=\"scrolling-metric-card\">\r\n                        <div class=\"scrolling-metric-card__value\">${data.avgResets.toFixed(1)}</div>\r\n                        <div class=\"scrolling-metric-card__label\">Avg Resets</div>\r\n                    </div>\r\n                    <div class=\"scrolling-metric-card\">\r\n                        <div class=\"scrolling-metric-card__value\">${data.avgTraceUsed.toFixed(0)}</div>\r\n                        <div class=\"scrolling-metric-card__label\">Avg Trace Used</div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class=\"scrolling-distribution\">\r\n                    <div class=\"scrolling-distribution__title\">\r\n                        Attack Distribution (across ${numSimulations.toLocaleString()} simulations):\r\n                    </div>\r\n                    <div class=\"scrolling-distribution__percentiles\">\r\n                        10th percentile: ${p10} | Median: ${p50} | 90th percentile: ${p90}\r\n                    </div>\r\n                    ${generateHistogramHTML(data.attacks, numSimulations)}\r\n                </div>\r\n\r\n                <div class=\"scrolling-damage-breakdown\">\r\n                    <div class=\"scrolling-damage-breakdown__title\">Damage Breakdown:</div>\r\n                    <div class=\"scrolling-damage-breakdown__stats\">\r\n                        Base DPS: ${formatNumber(data.baseDPS)}<br>\r\n                        New DPS: ${formatNumber(data.newDPS)}<br>\r\n                        Effective Attack Increase (with weapon bonus): +${formatNumber(data.effectiveAttackIncrease)}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        `;\r\n    });\r\n\r\n    tableHTML += `\r\n            </div>\r\n        </div>\r\n    `;\r\n\r\n    container.innerHTML = tableHTML;\r\n}\r\n\r\n/**\r\n * Switch between strategy detail tabs\r\n */\r\nexport function switchScrollStrategyTab(strategyId: string): void {\r\n    // Hide all tab contents\r\n    const allContents = document.querySelectorAll('.scrolling-strategy-tab-content');\r\n    allContents.forEach(content => {\r\n        (content as HTMLElement).style.display = 'none';\r\n    });\r\n\r\n    // Remove active state from all tab buttons\r\n    const allButtons = document.querySelectorAll('.scrolling-strategy-tab-btn');\r\n    allButtons.forEach(btn => {\r\n        btn.classList.remove('active');\r\n    });\r\n\r\n    // Show selected tab content\r\n    const selectedContent = document.getElementById(`scroll-strategy-tab-${strategyId}`);\r\n    if (selectedContent) {\r\n        selectedContent.style.display = 'block';\r\n    }\r\n\r\n    // Highlight selected tab button\r\n    const selectedButton = document.querySelector(`[data-strategy-id=\"${strategyId}\"]`);\r\n    if (selectedButton) {\r\n        selectedButton.classList.add('active');\r\n    }\r\n}\r\n\r\n/**\r\n * Main simulation runner\r\n */\r\nexport async function runScrollSimulation(): Promise<void> {\r\n    const budgetInput = document.getElementById('scroll-spell-trace-budget') as HTMLInputElement;\r\n    const numSimsInput = document.getElementById('scroll-simulations') as HTMLInputElement;\r\n\r\n    if (!budgetInput || !numSimsInput) return;\r\n\r\n    const budget = parseInt(budgetInput.value);\r\n    const numSimulations = parseInt(numSimsInput.value);\r\n    const scrolls = getScrollsForLevel(currentScrollLevel);\r\n\r\n    const button = document.getElementById('scroll-run-btn') as HTMLButtonElement;\r\n    const progressContainer = document.getElementById('scroll-progress-container') as HTMLElement;\r\n    const progressBar = document.getElementById('scroll-progress-bar') as HTMLElement;\r\n    const progressText = document.getElementById('scroll-progress-text') as HTMLElement;\r\n\r\n    if (button) button.disabled = true;\r\n    if (progressContainer) progressContainer.style.display = 'block';\r\n\r\n    // Get strategies based on selected scroll level\r\n    const strategies = currentScrollLevel === '65' ? createL65Strategies() : createL85Strategies();\r\n    const enhancementBonus = getEnhancementBonus();\r\n\r\n    const results: Record<string, SimulationResult> = {};\r\n\r\n    // Initialize results tracking\r\n    for (const strategy of strategies) {\r\n        results[strategy.id] = {\r\n            strategy,\r\n            attacks: [],\r\n            damageAmps: [],\r\n            successCounts: [],\r\n            resetCounts: [],\r\n            traceUsed: [],\r\n            avgAttack: 0,\r\n            avgDamageAmp: 0,\r\n            avgSuccess: 0,\r\n            avgResets: 0,\r\n            avgTraceUsed: 0,\r\n            dpsGain: 0,\r\n            baseDPS: 0,\r\n            newDPS: 0,\r\n            effectiveAttackIncrease: 0,\r\n            exampleResult: null\r\n        };\r\n    }\r\n\r\n    // Run simulations\r\n    for (let sim = 0; sim < numSimulations; sim++) {\r\n        if (sim % 50 === 0) {\r\n            const progress = (sim / numSimulations) * 100;\r\n            if (progressBar) progressBar.style.width = progress + '%';\r\n            if (progressText) progressText.textContent = `${sim} / ${numSimulations}`;\r\n            await new Promise(resolve => setTimeout(resolve, 0));\r\n        }\r\n\r\n        for (const strategy of strategies) {\r\n            const result = simulateScrollWithResets(strategy, budget, scrolls, enhancementBonus);\r\n\r\n            const data = results[strategy.id];\r\n            data.attacks.push(result.totalAttack);\r\n            data.damageAmps.push(result.totalDamageAmp);\r\n            data.successCounts.push(result.successfulSlots);\r\n            data.resetCounts.push(result.resetCount);\r\n            data.traceUsed.push(result.traceUsed);\r\n\r\n            // Store last result as example\r\n            if (sim === numSimulations - 1) {\r\n                data.exampleResult = result;\r\n            }\r\n        }\r\n    }\r\n\r\n    // Calculate averages and damage gains\r\n    for (const strategyId in results) {\r\n        const data = results[strategyId];\r\n        data.avgAttack = data.attacks.reduce((a, b) => a + b, 0) / numSimulations;\r\n        data.avgDamageAmp = data.damageAmps.reduce((a, b) => a + b, 0) / numSimulations;\r\n        data.avgSuccess = data.successCounts.reduce((a, b) => a + b, 0) / numSimulations;\r\n        data.avgResets = data.resetCounts.reduce((a, b) => a + b, 0) / numSimulations;\r\n        data.avgTraceUsed = data.traceUsed.reduce((a, b) => a + b, 0) / numSimulations;\r\n\r\n        // Calculate damage gain\r\n        const damageGain = calculateScrollDamageGain(data.avgAttack, data.avgDamageAmp);\r\n        data.dpsGain = damageGain.dpsGain;\r\n        data.baseDPS = damageGain.baseDPS;\r\n        data.newDPS = damageGain.newDPS;\r\n        data.effectiveAttackIncrease = damageGain.effectiveAttackIncrease;\r\n    }\r\n\r\n    displayScrollResults(results, budget, numSimulations);\r\n\r\n    if (button) button.disabled = false;\r\n    if (progressContainer) progressContainer.style.display = 'none';\r\n}\r\n\r\n/**\r\n * Initialize the scrolling optimizer UI\r\n */\r\nexport function initializeScrollingUI(): void {\r\n    const container = document.getElementById('optimization-scroll-optimizer');\r\n    if (!container) {\r\n        console.error('Scrolling optimizer container not found');\r\n        return;\r\n    }\r\n\r\n    // Generate HTML\r\n    container.innerHTML = generateScrollingHTML();\r\n\r\n    // Initialize default tab\r\n    renderMySlotPerformance();\r\n    renderSimulation();\r\n\r\n    loadoutStore.on('stat:changed', debounce((_) => {\r\n        updateAllSlotCalculations();\r\n    }, 3000));    \r\n}\r\n\r\n// ============================================================================\r\n// WINDOW EXPORTS\r\n// ============================================================================\r\n\r\n// Export functions to window for onclick handlers\r\nif (typeof window !== 'undefined') {\r\n    (window as any).switchScrollingSubTab = switchScrollingSubTab;\r\n    (window as any).runScrollSimulation = runScrollSimulation;\r\n    (window as any).updateScrollLevelInfo = updateScrollLevelInfo;\r\n    (window as any).switchScrollStrategyTab = switchScrollStrategyTab;\r\n    (window as any).updateGuildSkillDisplay = updateGuildSkillDisplay;\r\n    (window as any).saveEquipmentSlots = saveEquipmentSlots;\r\n}\r\n"],
  "mappings": "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",
  "names": []
}
