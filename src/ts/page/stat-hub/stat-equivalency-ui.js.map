{
  "version": 3,
  "sources": ["stat-equivalency-ui.ts"],
  "sourcesContent": ["/**\r\n * Stat Equivalency UI\r\n * HTML generation and event handling for stat equivalency calculator\r\n */\r\n\r\nimport { calculateEquivalency, createStatConfig, calculateTargetDPSGain } from './stat-equivalency';\r\nimport type { EquivalencyStatConfig } from '@ts/types/page/stat-hub/stat-hub.types';\r\nimport { loadoutStore } from '@ts/store/loadout.store';\r\n\r\n// Constants for equivalency UI\r\nconst EQUIV_PREFIX = 'equiv';\r\n\r\n// Stat input configuration for UI generation\r\ninterface StatInputConfig {\r\n    id: string;\r\n    label: string;\r\n    default: number;\r\n    step: number;\r\n    min: number;\r\n    info?: string;\r\n}\r\n\r\ninterface EquivalencyInputs {\r\n    flat: StatInputConfig[];\r\n    percentage: StatInputConfig[];\r\n}\r\n\r\nconst EQUIVALENCY_INPUTS: EquivalencyInputs = {\r\n    flat: [\r\n        { id: `${EQUIV_PREFIX}Attack`, label: 'Attack', default: 1000, step: 100, min: 0 },\r\n        { id: `${EQUIV_PREFIX}MainStat`, label: 'Main Stat', default: 500, step: 50, min: 0 }\r\n    ],\r\n    percentage: [\r\n        { id: `${EQUIV_PREFIX}SkillCoeff`, label: 'Skill Coefficient (%)', default: 10, step: 1, min: 0 },\r\n        { id: `${EQUIV_PREFIX}SkillMastery`, label: 'Skill Mastery (%)', default: 5, step: 1, min: 0 },\r\n        { id: `${EQUIV_PREFIX}Damage`, label: 'Damage (%)', default: 10, step: 1, min: 0 },\r\n        { id: `${EQUIV_PREFIX}FinalDamage`, label: 'Final Damage (%)', default: 10, step: 1, min: 0, info: 'Increases to this stat are multiplicative rather than additive.' },\r\n        { id: `${EQUIV_PREFIX}BossDamage`, label: 'Boss Damage (%)', default: 10, step: 1, min: 0 },\r\n        { id: `${EQUIV_PREFIX}NormalDamage`, label: 'Monster Damage (%)', default: 10, step: 1, min: 0 },\r\n        { id: `${EQUIV_PREFIX}MainStatPct`, label: 'Main Stat %', default: 10, step: 1, min: 0 },\r\n        { id: `${EQUIV_PREFIX}DamageAmp`, label: 'Damage Amplification (x)', default: 1, step: 0.1, min: 0 },\r\n        { id: `${EQUIV_PREFIX}MinDamage`, label: 'Min Damage Multiplier (%)', default: 10, step: 1, min: 0 },\r\n        { id: `${EQUIV_PREFIX}MaxDamage`, label: 'Max Damage Multiplier (%)', default: 10, step: 1, min: 0 },\r\n        { id: `${EQUIV_PREFIX}CritRate`, label: 'Critical Rate (%)', default: 10, step: 1, min: 0 },\r\n        { id: `${EQUIV_PREFIX}CritDamage`, label: 'Critical Damage (%)', default: 10, step: 1, min: 0 },\r\n        { id: `${EQUIV_PREFIX}AttackSpeed`, label: 'Attack Speed (%)', default: 10, step: 1, min: 0 },\r\n        { id: `${EQUIV_PREFIX}DefPen`, label: 'Defense Penetration (%)', default: 10, step: 1, min: 0 }\r\n    ]\r\n};\r\n\r\n/**\r\n * Generate HTML for a stat input row\r\n */\r\nfunction generateStatInputHTML(input: StatInputConfig): string {\r\n    const infoIcon = input.info\r\n        ? `<span class=\"info-icon\" role=\"img\" aria-label=\"Info\" title=\"${input.info}\">\u2139\uFE0F</span>`\r\n        : '';\r\n\r\n    return `\r\n        <div class=\"stat-row\">\r\n            <label>${input.label} ${infoIcon}</label>\r\n            <input\r\n                type=\"number\"\r\n                id=\"${input.id}\"\r\n                value=\"${input.default}\"\r\n                min=\"${input.min}\"\r\n                step=\"${input.step}\"\r\n                oninput=\"handleStatEquivalencyInput('${extractStatKey(input.id)}')\"\r\n            >\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Extract stat key from input ID\r\n * Convert from equivCritRate format to critRate format\r\n */\r\nfunction extractStatKey(inputId: string): string {\r\n    // Remove 'equiv' prefix and convert first character to lowercase\r\n    // equivCritRate \u2192 critRate\r\n    return inputId.charAt(EQUIV_PREFIX.length).toLowerCase() + inputId.slice(EQUIV_PREFIX.length + 1);\r\n}\r\n\r\n/**\r\n * Get stat value from DOM input\r\n * Constructs input ID from stat key: critRate \u2192 equivCritRate\r\n */\r\nfunction getStatValueFromDOM(statId: string): number {\r\n    // Convert statId to input ID: capitalize first char after equiv\r\n    const inputId = EQUIV_PREFIX + statId.charAt(0).toUpperCase() + statId.slice(1);\r\n    const element = document.getElementById(inputId) as HTMLInputElement;\r\n    return parseFloat(element?.value) || 0;\r\n}\r\n\r\n/**\r\n * Generate HTML for flat stats inputs section\r\n */\r\nfunction generateFlatStatsSection(): string {\r\n    let html = `\r\n        <div style=\"margin-bottom: 24px;\">\r\n            <h4 style=\"color: var(--accent-primary); font-weight: 700; margin-bottom: 12px; font-size: 1em; text-transform: uppercase; letter-spacing: 0.05em;\">Flat Stats</h4>\r\n            <div class=\"stats-list-column\">\r\n    `;\r\n\r\n    EQUIVALENCY_INPUTS.flat.forEach(input => {\r\n        html += generateStatInputHTML(input);\r\n    });\r\n\r\n    html += `\r\n            </div>\r\n        </div>\r\n    `;\r\n\r\n    return html;\r\n}\r\n\r\n/**\r\n * Generate HTML for percentage stats inputs section\r\n */\r\nfunction generatePercentageStatsSection(): string {\r\n    let html = `\r\n        <div>\r\n            <h4 style=\"color: var(--accent-primary); font-weight: 700; margin-bottom: 12px; font-size: 1em; text-transform: uppercase; letter-spacing: 0.05em;\">Percentage Stats</h4>\r\n            <div class=\"stats-list-column\">\r\n    `;\r\n\r\n    EQUIVALENCY_INPUTS.percentage.forEach(input => {\r\n        html += generateStatInputHTML(input);\r\n    });\r\n\r\n    html += `\r\n            </div>\r\n        </div>\r\n    `;\r\n\r\n    return html;\r\n}\r\n\r\n/**\r\n * Generate results display HTML\r\n */\r\nfunction generateResultsPlaceholderHTML(): string {\r\n    return `\r\n        <div style=\"text-align: center; color: var(--text-secondary); padding: 60px 20px;\">\r\n            <div style=\"font-size: 4em; margin-bottom: 20px; opacity: 0.4;\">\uD83D\uDCCA</div>\r\n            <p style=\"font-size: 1.1em;\">Enter a value in any stat field to see the equivalent damage gain across all stats.</p>\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Generate complete HTML for stat equivalency calculator\r\n */\r\nexport function generateStatEquivalencyHTML(): string {\r\n    let html = `\r\n        <div style=\"margin-bottom: 20px;\">\r\n            <h3 style=\"color: var(--accent-primary); margin-bottom: 10px; font-size: 1.2em; font-weight: 600;\">\r\n                Stat Equivalency Calculator\r\n            </h3>\r\n            <p style=\"color: var(--text-secondary); font-size: 0.9em; line-height: 1.6;\">\r\n                Enter a value for any stat below to see what that gain translates to for all other stats. Perfect for comparing upgrade paths and understanding relative stat values.\r\n            </p>\r\n        </div>\r\n\r\n        <div class=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n            <!-- Left Column: Input Fields -->\r\n            <div>\r\n    `;\r\n\r\n    html += generateFlatStatsSection();\r\n    html += generatePercentageStatsSection();\r\n\r\n    html += `\r\n            </div>\r\n\r\n            <!-- Right Column: Results Display -->\r\n            <div style=\"position: sticky; top: 20px;\">\r\n                <h4 style=\"color: var(--accent-success); font-weight: 700; margin-bottom: 12px; font-size: 1em; text-transform: uppercase; letter-spacing: 0.05em;\">Results</h4>\r\n                <div id=\"equivalency-results\" style=\"border-radius: 12px; padding: 20px; min-height: 500px;\">\r\n    `;\r\n\r\n    html += generateResultsPlaceholderHTML();\r\n\r\n    html += `\r\n                </div>\r\n            </div>\r\n        </div>\r\n    `;\r\n\r\n    return html;\r\n}\r\n\r\n/**\r\n * Generate HTML for equivalency results table\r\n */\r\nfunction generateEquivalencyResultsHTML(\r\n    sourceStat: string,\r\n    sourceValue: number,\r\n    statConfig: Record<string, EquivalencyStatConfig>,\r\n    targetDPSGain: number,\r\n    equivalents: Record<string, { value: number; label: string }>\r\n): string {\r\n    let html = '<div style=\"background: linear-gradient(135deg, rgba(0, 122, 255, 0.08), rgba(88, 86, 214, 0.05)); border: 2px solid rgba(0, 122, 255, 0.2); border-radius: 16px; padding: 25px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);\">';\r\n\r\n    // Header section\r\n    html += '<div style=\"text-align: center; margin-bottom: 25px;\">';\r\n    html += `<div style=\"font-size: 1.4em; font-weight: 700; color: var(--accent-primary); margin-bottom: 10px;\">`;\r\n    html += `${statConfig[sourceStat].formatValue(sourceValue)} ${statConfig[sourceStat].label}`;\r\n    html += '</div>';\r\n    html += `<div style=\"font-size: 1.1em; color: var(--accent-success); font-weight: 600;\">`;\r\n    html += `= ${targetDPSGain.toFixed(2)}% DPS Gain`;\r\n    html += '</div>';\r\n    html += '</div>';\r\n\r\n    // Results table\r\n    html += '<table class=\"table\" style=\"margin: 0;\">';\r\n    html += '<thead><tr>';\r\n    html += '<th style=\"text-align: left; font-size: 1em;\">Equivalent Stat</th>';\r\n    html += '<th style=\"text-align: right; font-size: 1em;\">Required Amount</th>';\r\n    html += '<th style=\"text-align: right; font-size: 1em;\">DPS Gain</th>';\r\n    html += '</tr></thead><tbody>';\r\n\r\n    // Generate rows for each equivalent stat\r\n    Object.entries(equivalents).forEach(([statId, result]) => {\r\n        const statConfigItem = statConfig[statId];\r\n        html += '<tr>';\r\n        html += `<td style=\"font-weight: 600;\">${statConfigItem.label}</td>`;\r\n\r\n        if (result.value === 0 && result.label.includes('Ineffective')) {\r\n            html += `<td style=\"text-align: right; font-size: 1.05em; color: var(--text-secondary); font-style: italic;\">-</td>`;\r\n            html += `<td style=\"text-align: right; color: var(--text-secondary); font-style: italic;\">${result.label}</td>`;\r\n        } else if (result.label === 'Unable to match') {\r\n            html += `<td style=\"text-align: right; font-size: 1.05em; color: var(--text-secondary); font-style: italic;\">-</td>`;\r\n            html += `<td style=\"text-align: right; color: var(--text-secondary); font-style: italic;\">Unable to match</td>`;\r\n        } else {\r\n            html += `<td style=\"text-align: right; font-size: 1.05em; color: var(--accent-primary); font-weight: 600;\">${statConfigItem.formatValue(result.value)}</td>`;\r\n            html += `<td style=\"text-align: right;\"><span class=\"gain-positive\">${result.label}</span></td>`;\r\n        }\r\n\r\n        html += '</tr>';\r\n    });\r\n\r\n    html += '</tbody></table>';\r\n    html += '</div>';\r\n\r\n    return html;\r\n}\r\n\r\n/**\r\n * Update stat equivalency display\r\n */\r\nexport function updateStatEquivalency(sourceStat: string): void {\r\n    const stats = loadoutStore.getBaseStats();\r\n    const sourceValue = getStatValueFromDOM(sourceStat);\r\n\r\n    if (sourceValue === 0) {\r\n        const resultsContainer = document.getElementById('equivalency-results');\r\n        if (resultsContainer) {\r\n            resultsContainer.innerHTML = generateResultsPlaceholderHTML();\r\n        }\r\n        return;\r\n    }\r\n\r\n    const statConfig = createStatConfig(getStatValueFromDOM);\r\n    const result = calculateEquivalency(stats, sourceStat, sourceValue, statConfig);\r\n\r\n    if (!result) {\r\n        const resultsContainer = document.getElementById('equivalency-results');\r\n        if (resultsContainer) {\r\n            resultsContainer.innerHTML = generateResultsPlaceholderHTML();\r\n        }\r\n        return;\r\n    }\r\n\r\n    // Recalculate to get actual DPS gain\r\n    const { targetDPSGain } = calculateTargetDPSGain(stats, sourceStat, sourceValue, statConfig);\r\n\r\n    const html = generateEquivalencyResultsHTML(\r\n        sourceStat,\r\n        sourceValue,\r\n        statConfig,\r\n        targetDPSGain,\r\n        result.equivalents\r\n    );\r\n\r\n    const resultsContainer = document.getElementById('equivalency-results');\r\n    if (resultsContainer) {\r\n        resultsContainer.innerHTML = html;\r\n    }\r\n}\r\n\r\n/**\r\n * Handle stat equivalency input change\r\n */\r\nexport function handleStatEquivalencyInput(sourceStat: string): void {\r\n    updateStatEquivalency(sourceStat);\r\n}\r\n\r\nwindow.handleStatEquivalencyInput = handleStatEquivalencyInput;"],
  "mappings": "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",
  "names": ["resultsContainer"]
}
