{
  "version": 3,
  "sources": ["stat-equivalency-ui.ts"],
  "sourcesContent": ["/**\n * Stat Equivalency UI\n * HTML generation and event handling for stat equivalency calculator\n */\n\nimport { calculateEquivalency, createStatConfig, calculateTargetDPSGain } from './stat-equivalency';\nimport type { EquivalencyStatConfig } from '@ts/types/page/stat-hub/stat-hub.types';\nimport { loadoutStore } from '@ts/store/loadout.store';\n\n// Constants for equivalency UI\nconst EQUIV_PREFIX = 'equiv';\n\n// Stat input configuration for UI generation\ninterface StatInputConfig {\n    id: string;\n    label: string;\n    default: number;\n    step: number;\n    min: number;\n    info?: string;\n}\n\ninterface EquivalencyInputs {\n    flat: StatInputConfig[];\n    percentage: StatInputConfig[];\n}\n\nconst EQUIVALENCY_INPUTS: EquivalencyInputs = {\n    flat: [\n        { id: `${EQUIV_PREFIX}Attack`, label: 'Attack', default: 1000, step: 100, min: 0 },\n        { id: `${EQUIV_PREFIX}MainStat`, label: 'Main Stat', default: 500, step: 50, min: 0 }\n    ],\n    percentage: [\n        { id: `${EQUIV_PREFIX}SkillCoeff`, label: 'Skill Coefficient (%)', default: 10, step: 1, min: 0 },\n        { id: `${EQUIV_PREFIX}Mastery`, label: 'Skill Mastery (%)', default: 5, step: 1, min: 0 },\n        { id: `${EQUIV_PREFIX}Damage`, label: 'Damage (%)', default: 10, step: 1, min: 0 },\n        { id: `${EQUIV_PREFIX}FinalDamage`, label: 'Final Damage (%)', default: 10, step: 1, min: 0, info: 'Increases to this stat are multiplicative rather than additive.' },\n        { id: `${EQUIV_PREFIX}BossDamage`, label: 'Boss Damage (%)', default: 10, step: 1, min: 0 },\n        { id: `${EQUIV_PREFIX}NormalDamage`, label: 'Monster Damage (%)', default: 10, step: 1, min: 0 },\n        { id: `${EQUIV_PREFIX}MainStatPct`, label: 'Main Stat %', default: 10, step: 1, min: 0 },\n        { id: `${EQUIV_PREFIX}DamageAmp`, label: 'Damage Amplification (x)', default: 1, step: 0.1, min: 0 },\n        { id: `${EQUIV_PREFIX}MinDamage`, label: 'Min Damage Multiplier (%)', default: 10, step: 1, min: 0 },\n        { id: `${EQUIV_PREFIX}MaxDamage`, label: 'Max Damage Multiplier (%)', default: 10, step: 1, min: 0 },\n        { id: `${EQUIV_PREFIX}CritRate`, label: 'Critical Rate (%)', default: 10, step: 1, min: 0 },\n        { id: `${EQUIV_PREFIX}CritDamage`, label: 'Critical Damage (%)', default: 10, step: 1, min: 0 },\n        { id: `${EQUIV_PREFIX}AttackSpeed`, label: 'Attack Speed (%)', default: 10, step: 1, min: 0 },\n        { id: `${EQUIV_PREFIX}DefPen`, label: 'Defense Penetration (%)', default: 10, step: 1, min: 0 }\n    ]\n};\n\n/**\n * Generate HTML for a stat input row\n */\nfunction generateStatInputHTML(input: StatInputConfig): string {\n    const infoIcon = input.info\n        ? `<span class=\"info-icon\" role=\"img\" aria-label=\"Info\" title=\"${input.info}\">\u2139\uFE0F</span>`\n        : '';\n\n    return `\n        <div class=\"stat-row\">\n            <label>${input.label} ${infoIcon}</label>\n            <input\n                type=\"number\"\n                id=\"${input.id}\"\n                value=\"${input.default}\"\n                min=\"${input.min}\"\n                step=\"${input.step}\"\n                oninput=\"handleStatEquivalencyInput('${extractStatKey(input.id)}')\"\n            >\n        </div>\n    `;\n}\n\n/**\n * Extract stat key from input ID\n * Convert from equivCritRate format to critRate format\n */\nfunction extractStatKey(inputId: string): string {\n    // Remove 'equiv' prefix and convert first character to lowercase\n    // equivCritRate \u2192 critRate\n    return inputId.charAt(EQUIV_PREFIX.length).toLowerCase() + inputId.slice(EQUIV_PREFIX.length + 1);\n}\n\n/**\n * Get stat value from DOM input\n * Constructs input ID from stat key: critRate \u2192 equivCritRate\n */\nfunction getStatValueFromDOM(statId: string): number {\n    // Convert statId to input ID: capitalize first char after equiv\n    const inputId = EQUIV_PREFIX + statId.charAt(0).toUpperCase() + statId.slice(1);\n    const element = document.getElementById(inputId) as HTMLInputElement;\n    return parseFloat(element?.value) || 0;\n}\n\n/**\n * Generate HTML for flat stats inputs section\n */\nfunction generateFlatStatsSection(): string {\n    let html = `\n        <div style=\"margin-bottom: 24px;\">\n            <h4 style=\"color: var(--tab-pink); font-weight: 700; margin-bottom: 12px; font-size: 1em; text-transform: uppercase; letter-spacing: 0.05em;\">Flat Stats</h4>\n            <div class=\"stats-list-column\">\n    `;\n\n    EQUIVALENCY_INPUTS.flat.forEach(input => {\n        html += generateStatInputHTML(input);\n    });\n\n    html += `\n            </div>\n        </div>\n    `;\n\n    return html;\n}\n\n/**\n * Generate HTML for percentage stats inputs section\n */\nfunction generatePercentageStatsSection(): string {\n    let html = `\n        <div>\n            <h4 style=\"color: var(--tab-pink); font-weight: 700; margin-bottom: 12px; font-size: 1em; text-transform: uppercase; letter-spacing: 0.05em;\">Percentage Stats</h4>\n            <div class=\"stats-list-column\">\n    `;\n\n    EQUIVALENCY_INPUTS.percentage.forEach(input => {\n        html += generateStatInputHTML(input);\n    });\n\n    html += `\n            </div>\n        </div>\n    `;\n\n    return html;\n}\n\n/**\n * Generate results display HTML\n */\nfunction generateResultsPlaceholderHTML(): string {\n    return `\n        <div style=\"text-align: center; color: var(--text-secondary); padding: 60px 20px;\">\n            <div style=\"font-size: 4em; margin-bottom: 20px; opacity: 0.4;\">\uD83D\uDCCA</div>\n            <p style=\"font-size: 1.1em;\">Enter a value in any stat field to see the equivalent damage gain across all stats.</p>\n        </div>\n    `;\n}\n\n/**\n * Generate complete HTML for stat equivalency calculator\n */\nexport function generateStatEquivalencyHTML(): string {\n    let html = `\n        <div style=\"margin-bottom: 20px;\">\n            <h3 style=\"color: var(--tab-pink); margin-bottom: 10px; font-size: 1.2em; font-weight: 600;\">\n                Stat Equivalency Calculator\n            </h3>\n            <p style=\"color: var(--text-secondary); font-size: 0.9em; line-height: 1.6;\">\n                Enter a value for any stat below to see what that gain translates to for all other stats. Perfect for comparing upgrade paths and understanding relative stat values.\n            </p>\n        </div>\n\n        <div class=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n            <!-- Left Column: Input Fields -->\n            <div>\n    `;\n\n    html += generateFlatStatsSection();\n    html += generatePercentageStatsSection();\n\n    html += `\n            </div>\n\n            <!-- Right Column: Results Display -->\n            <div style=\"position: sticky; top: 20px;\">\n                <h4 style=\"color: var(--tab-pink); font-weight: 700; margin-bottom: 12px; font-size: 1em; text-transform: uppercase; letter-spacing: 0.05em;\">Results</h4>\n                <div id=\"equivalency-results\" style=\"border-radius: 12px; padding: 20px; min-height: 500px;\">\n    `;\n\n    html += generateResultsPlaceholderHTML();\n\n    html += `\n                </div>\n            </div>\n        </div>\n    `;\n\n    return html;\n}\n\n/**\n * Generate HTML for equivalency results table\n */\nfunction generateEquivalencyResultsHTML(\n    sourceStat: string,\n    sourceValue: number,\n    statConfig: Record<string, EquivalencyStatConfig>,\n    targetDPSGain: number,\n    equivalents: Record<string, { value: number; label: string }>\n): string {\n    let html = '<div>';\n\n    // Header section\n    html += '<div style=\"text-align: center; margin-bottom: 25px;\">';\n    html += `<div style=\"font-size: 1.4em; font-weight: 700; color: var(--tab-pink); margin-bottom: 10px;\">`;\n    html += `${statConfig[sourceStat].formatValue(sourceValue)} ${statConfig[sourceStat].label}`;\n    html += '</div>';\n    html += `<div style=\"font-size: 1.1em; color: var(--accent-success); font-weight: 600;\">`;\n    html += `= ${targetDPSGain.toFixed(2)}% DPS Gain`;\n    html += '</div>';\n    html += '</div>';\n\n    // Results table\n    html += '<div class=\"table-wrapper\">';\n    html += '<table class=\"table\" style=\"margin: 0;\">';\n    html += '<thead><tr>';\n    html += '<th style=\"text-align: left; font-size: 1em;\">Equivalent Stat</th>';\n    html += '<th style=\"text-align: right; font-size: 1em;\">Required Amount</th>';\n    html += '<th style=\"text-align: right; font-size: 1em;\">DPS Gain</th>';\n    html += '</tr></thead><tbody>';\n\n    // Generate rows for each equivalent stat\n    Object.entries(equivalents).forEach(([statId, result]) => {\n        const statConfigItem = statConfig[statId];\n        html += '<tr>';\n        html += `<td style=\"font-weight: 600;\">${statConfigItem.label}</td>`;\n\n        if (result.value === 0 && result.label.includes('Ineffective')) {\n            html += `<td style=\"text-align: right; font-size: 1.05em; color: var(--text-secondary); font-style: italic;\">-</td>`;\n            html += `<td style=\"text-align: right; color: var(--text-secondary); font-style: italic;\">${result.label}</td>`;\n        } else if (result.label === 'Unable to match') {\n            html += `<td style=\"text-align: right; font-size: 1.05em; color: var(--text-secondary); font-style: italic;\">-</td>`;\n            html += `<td style=\"text-align: right; color: var(--text-secondary); font-style: italic;\">Unable to match</td>`;\n        } else {\n            html += `<td style=\"text-align: right; font-size: 1.05em; color: var(--tab-pink); font-weight: 600;\">${statConfigItem.formatValue(result.value)}</td>`;\n            html += `<td style=\"text-align: right;\"><span class=\"gain-positive\">${result.label}</span></td>`;\n        }\n\n        html += '</tr>';\n    });\n\n    html += '</tbody></table>';\n    html += '</div>';\n    html += '</div>';\n\n    return html;\n}\n\n/**\n * Update stat equivalency display\n */\nexport function updateStatEquivalency(sourceStat: string): void {\n    const stats = loadoutStore.getBaseStats();\n    const sourceValue = getStatValueFromDOM(sourceStat);\n\n    if (sourceValue === 0) {\n        const resultsContainer = document.getElementById('equivalency-results');\n        if (resultsContainer) {\n            resultsContainer.innerHTML = generateResultsPlaceholderHTML();\n        }\n        return;\n    }\n\n    const statConfig = createStatConfig(getStatValueFromDOM);\n    const result = calculateEquivalency(stats, sourceStat, sourceValue, statConfig);\n\n    if (!result) {\n        const resultsContainer = document.getElementById('equivalency-results');\n        if (resultsContainer) {\n            resultsContainer.innerHTML = generateResultsPlaceholderHTML();\n        }\n        return;\n    }\n\n    // Recalculate to get actual DPS gain\n    const { targetDPSGain } = calculateTargetDPSGain(stats, sourceStat, sourceValue, statConfig);\n\n    const html = generateEquivalencyResultsHTML(\n        sourceStat,\n        sourceValue,\n        statConfig,\n        targetDPSGain,\n        result.equivalents\n    );\n\n    const resultsContainer = document.getElementById('equivalency-results');\n    if (resultsContainer) {\n        resultsContainer.innerHTML = html;\n    }\n}\n\n/**\n * Handle stat equivalency input change\n */\nexport function handleStatEquivalencyInput(sourceStat: string): void {\n    updateStatEquivalency(sourceStat);\n}\n\nwindow.handleStatEquivalencyInput = handleStatEquivalencyInput;"],
  "mappings": "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",
  "names": ["resultsContainer"]
}
