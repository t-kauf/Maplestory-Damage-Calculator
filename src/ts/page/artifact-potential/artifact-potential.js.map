{
  "version": 3,
  "sources": ["artifact-potential.ts"],
  "sourcesContent": ["/**\n * Artifact Potential Core Logic\n *\n * Pure calculation functions for artifact potential stat mapping\n * and DPS gain rankings.\n */\n\nimport { artifactPotentialData } from '@ts/data/artifact-potential-data.js';\nimport { StatCalculationService } from '@ts/services/stat-calculation-service.js';\nimport { loadoutStore } from '@ts/store/loadout.store.js';\nimport type { BaseStats } from '@ts/types/loadout.js';\nimport type {\n    ArtifactRankingResult,\n    ArtifactStatName,\n    ArtifactRarity\n} from '@ts/types/page/artifact-potential/artifact-potential.types.js';\nimport { IGNORED_ARTIFACT_STATS } from '@ts/types/page/artifact-potential/artifact-potential.types.js';\n\n// ============================================================================\n// STAT MAPPING\n// ============================================================================\n\n/**\n * Map an artifact potential stat to base stats using StatCalculationService\n * @param statName - Name of the stat (e.g., \"Main Stat %\", \"Boss Monster Damage %\")\n * @param value - Value of the stat\n * @param baseStats - Base stats to modify\n * @returns Modified base stats\n */\nexport function mapArtifactStat(statName: string, value: number, baseStats: BaseStats): BaseStats {\n    // Remove \"(prime)\" suffix if present for mapping\n    const cleanStatName = statName.replace(' (prime)', '');\n\n    // Use StatCalculationService for consistent stat manipulation\n    const service = new StatCalculationService(baseStats);\n\n    switch (cleanStatName) {\n        case 'Main Stat %':\n            // StatCalculationService handles complex main stat % calculations including Dark Knight\n            service.add('mainStatPct', value);\n            break;\n        case 'Critical Rate %':\n            service.add('critRate', value);\n            break;\n        case 'Min Damage Multiplier %':\n            service.add('minDamage', value);\n            break;\n        case 'Max Damage Multiplier %':\n            service.add('maxDamage', value);\n            break;\n        case 'Boss Monster Damage %':\n            service.add('bossDamage', value);\n            break;\n        case 'Normal Monster Damage %':\n            service.add('normalDamage', value);\n            break;\n        case 'Damage %':\n            service.add('damage', value);\n            break;\n        case 'Defense Penetration %':\n            // Defense Penetration uses diminishing returns with factor 100\n            service.add('defPen', value);\n            break;\n        // Ignored stats: Damage Taken Decrease %, Defense %, Accuracy, Status Effect Damage %\n        default:\n            // No effect on damage\n            break;\n    }\n\n    return service.getStats();\n}\n\n// ============================================================================\n// RANKING CALCULATIONS\n// ============================================================================\n\n/**\n * Calculate baseline stats from loadout store\n * @returns Base stats\n */\nexport function getBaselineStats(): BaseStats {\n    return loadoutStore.getBaseStats();\n}\n\n/**\n * Calculate all possible artifact potential rolls and rank them\n * @returns Array of ranking results sorted by average DPS gain\n */\nexport function calculateArtifactPotentialRankings(): ArtifactRankingResult[] {\n    const baseStats = getBaselineStats();\n\n    // Calculate baseline damage using StatCalculationService\n    const baselineService = new StatCalculationService(baseStats);\n    const baselineBossDamage = baselineService.compute('boss');\n    const baselineNormalDamage = baselineService.compute('normal');\n\n    const results: ArtifactRankingResult[] = [];\n\n    // Process each rarity tier\n    Object.entries(artifactPotentialData).forEach(([rarity, stats]) => {\n        Object.entries(stats).forEach(([statName, value]) => {\n            // Skip stats that don't affect damage\n            if (IGNORED_ARTIFACT_STATS.includes(statName as ArtifactStatName)) {\n                return;\n            }\n\n            // Apply this stat and calculate DPS gains\n            const modifiedStats = mapArtifactStat(statName, value as number, baseStats);\n            const testService = new StatCalculationService(modifiedStats);\n            const bossDamage = testService.compute('boss');\n            const normalDamage = testService.compute('normal');\n\n            const bossDPSGain = bossDamage.dps - baselineBossDamage.dps;\n            const normalDPSGain = normalDamage.dps - baselineNormalDamage.dps;\n            const avgDPSGain = (bossDPSGain + normalDPSGain) / 2;\n\n            const bossDPSPercentChange = baselineBossDamage.dps > 0 ? (bossDPSGain / baselineBossDamage.dps) * 100 : 0;\n            const normalDPSPercentChange = baselineNormalDamage.dps > 0 ? (normalDPSGain / baselineNormalDamage.dps) * 100 : 0;\n            const avgDPSPercentChange = (bossDPSPercentChange + normalDPSPercentChange) / 2;\n\n            // Only include stats that give positive DPS gain\n            if (avgDPSGain > 0) {\n                // Format the display name\n                let displayName = statName;\n                if (statName.includes('(prime)')) {\n                    displayName = statName.replace(' (prime)', ' (Prime)');\n                }\n\n                results.push({\n                    rarity: rarity as ArtifactRarity,\n                    stat: displayName,\n                    value: `${value}%`,\n                    bossDPSGain,\n                    normalDPSGain,\n                    avgDPSGain,\n                    bossDPSPercentChange,\n                    normalDPSPercentChange,\n                    avgDPSPercentChange\n                });\n            }\n        });\n    });\n\n    // Sort by average DPS gain (descending)\n    results.sort((a, b) => b.avgDPSGain - a.avgDPSGain);\n\n    return results;\n}\n\n// ============================================================================\n// SORTING STATE\n// ============================================================================\n\nlet artifactSortColumn = 5;\nlet artifactSortAsc = false;\n\n/**\n * Get current sort column\n */\nexport function getArtifactSortColumn(): number {\n    return artifactSortColumn;\n}\n\n/**\n * Set sort column\n */\nexport function setArtifactSortColumn(column: number): void {\n    artifactSortColumn = column;\n}\n\n/**\n * Get sort direction\n */\nexport function getArtifactSortAsc(): boolean {\n    return artifactSortAsc;\n}\n\n/**\n * Toggle sort direction\n */\nexport function toggleArtifactSortAsc(): void {\n    artifactSortAsc = !artifactSortAsc;\n}\n\n// ============================================================================\n// WINDOW EXPORTS\n// ============================================================================\n"],
  "mappings": "AAOA,SAAS,6BAA6B;AACtC,SAAS,8BAA8B;AACvC,SAAS,oBAAoB;AAO7B,SAAS,8BAA8B;AAahC,SAAS,gBAAgB,UAAkB,OAAe,WAAiC;AAE9F,QAAM,gBAAgB,SAAS,QAAQ,YAAY,EAAE;AAGrD,QAAM,UAAU,IAAI,uBAAuB,SAAS;AAEpD,UAAQ,eAAe;AAAA,IACnB,KAAK;AAED,cAAQ,IAAI,eAAe,KAAK;AAChC;AAAA,IACJ,KAAK;AACD,cAAQ,IAAI,YAAY,KAAK;AAC7B;AAAA,IACJ,KAAK;AACD,cAAQ,IAAI,aAAa,KAAK;AAC9B;AAAA,IACJ,KAAK;AACD,cAAQ,IAAI,aAAa,KAAK;AAC9B;AAAA,IACJ,KAAK;AACD,cAAQ,IAAI,cAAc,KAAK;AAC/B;AAAA,IACJ,KAAK;AACD,cAAQ,IAAI,gBAAgB,KAAK;AACjC;AAAA,IACJ,KAAK;AACD,cAAQ,IAAI,UAAU,KAAK;AAC3B;AAAA,IACJ,KAAK;AAED,cAAQ,IAAI,UAAU,KAAK;AAC3B;AAAA;AAAA,IAEJ;AAEI;AAAA,EACR;AAEA,SAAO,QAAQ,SAAS;AAC5B;AAUO,SAAS,mBAA8B;AAC1C,SAAO,aAAa,aAAa;AACrC;AAMO,SAAS,qCAA8D;AAC1E,QAAM,YAAY,iBAAiB;AAGnC,QAAM,kBAAkB,IAAI,uBAAuB,SAAS;AAC5D,QAAM,qBAAqB,gBAAgB,QAAQ,MAAM;AACzD,QAAM,uBAAuB,gBAAgB,QAAQ,QAAQ;AAE7D,QAAM,UAAmC,CAAC;AAG1C,SAAO,QAAQ,qBAAqB,EAAE,QAAQ,CAAC,CAAC,QAAQ,KAAK,MAAM;AAC/D,WAAO,QAAQ,KAAK,EAAE,QAAQ,CAAC,CAAC,UAAU,KAAK,MAAM;AAEjD,UAAI,uBAAuB,SAAS,QAA4B,GAAG;AAC/D;AAAA,MACJ;AAGA,YAAM,gBAAgB,gBAAgB,UAAU,OAAiB,SAAS;AAC1E,YAAM,cAAc,IAAI,uBAAuB,aAAa;AAC5D,YAAM,aAAa,YAAY,QAAQ,MAAM;AAC7C,YAAM,eAAe,YAAY,QAAQ,QAAQ;AAEjD,YAAM,cAAc,WAAW,MAAM,mBAAmB;AACxD,YAAM,gBAAgB,aAAa,MAAM,qBAAqB;AAC9D,YAAM,cAAc,cAAc,iBAAiB;AAEnD,YAAM,uBAAuB,mBAAmB,MAAM,IAAK,cAAc,mBAAmB,MAAO,MAAM;AACzG,YAAM,yBAAyB,qBAAqB,MAAM,IAAK,gBAAgB,qBAAqB,MAAO,MAAM;AACjH,YAAM,uBAAuB,uBAAuB,0BAA0B;AAG9E,UAAI,aAAa,GAAG;AAEhB,YAAI,cAAc;AAClB,YAAI,SAAS,SAAS,SAAS,GAAG;AAC9B,wBAAc,SAAS,QAAQ,YAAY,UAAU;AAAA,QACzD;AAEA,gBAAQ,KAAK;AAAA,UACT;AAAA,UACA,MAAM;AAAA,UACN,OAAO,GAAG,KAAK;AAAA,UACf;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,QACJ,CAAC;AAAA,MACL;AAAA,IACJ,CAAC;AAAA,EACL,CAAC;AAGD,UAAQ,KAAK,CAAC,GAAG,MAAM,EAAE,aAAa,EAAE,UAAU;AAElD,SAAO;AACX;AAMA,IAAI,qBAAqB;AACzB,IAAI,kBAAkB;AAKf,SAAS,wBAAgC;AAC5C,SAAO;AACX;AAKO,SAAS,sBAAsB,QAAsB;AACxD,uBAAqB;AACzB;AAKO,SAAS,qBAA8B;AAC1C,SAAO;AACX;AAKO,SAAS,wBAA8B;AAC1C,oBAAkB,CAAC;AACvB;",
  "names": []
}
