{
  "version": 3,
  "sources": ["loadout-page.ts"],
  "sourcesContent": ["import { BasePage } from \"./base-page\";\r\nimport {\r\n    initializeBaseStatsUI,\r\n    loadBaseStatsUI,\r\n    attachBaseStatsEventListeners\r\n} from \"./base-stats/base-stats-ui\";\r\nimport {\r\n    loadClassSelectUI,\r\n    attachClassSelectEventListeners\r\n} from \"./base-stats/class-select-ui\";\r\nimport {\r\n    loadTargetSelectUI,\r\n    attachTargetSelectEventListeners\r\n} from \"./base-stats/target-select-ui\";\r\nimport {\r\n    loadMasteryBonusesUI,\r\n    attachMasteryEventListeners\r\n} from \"./base-stats/mastery-bonus-ui\";\r\nimport {\r\n    initializeWeaponsUI,\r\n    loadWeaponsUI,\r\n    attachWeaponEventListeners\r\n} from \"./weapon-levels/weapon-ui\";\r\nimport {\r\n    initializeWeaponPriorityUI\r\n} from \"./weapon-levels/weapon-priority-ui\";\r\nimport { loadoutStore } from \"@ts/store/loadout.store\";\r\nimport { attachCompanionsEventListeners, initializeCompanionsUI, loadCompanionsUI } from \"./companions/companions-ui\";\r\n\r\n/**\r\n * LoadoutPage - Manages the Loadout/Setup page\r\n * Extends BasePage to get consistent lifecycle and tab management\r\n */\r\nclass LoadoutPage extends BasePage {\r\n    private initialized: boolean = false;\r\n\r\n    constructor() {\r\n        super('setup', 'base-stats');\r\n    }\r\n\r\n    /**\r\n     * Lifecycle: Called after page is visible\r\n     * Initialize the page on first visit, switch tabs on subsequent visits\r\n     */\r\n    onPageVisible(tabName: string | null): void {\r\n        // Call parent to handle tab switching\r\n        super.onPageVisible(tabName);\r\n\r\n        // Initialize page components on first visit\r\n        if (!this.initialized) {\r\n            this.initializeComponents();\r\n            this.initialized = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Initialize all page components (HTML, state, event listeners)\r\n     * Called once on first page visit\r\n     */\r\n    private async initializeComponents(): Promise<void> {\r\n        // Step 0: Initialize the loadout store (migrates data from legacy format if needed)\r\n        await loadoutStore.initialize();\r\n\r\n        // Step 1: Initialize all UI elements (HTML generation)\r\n        initializeBaseStatsUI();\r\n        initializeWeaponsUI(); // Handles tab HTML and weapon grid\r\n        initializeWeaponPriorityUI(); // Initialize priority UI\r\n        initializeCompanionsUI();\r\n\r\n        // Step 2: Load UI from saved state\r\n        loadBaseStatsUI();\r\n        loadClassSelectUI();\r\n        loadTargetSelectUI();\r\n        loadMasteryBonusesUI();\r\n        loadWeaponsUI();\r\n        loadCompanionsUI();\r\n\r\n        // Step 3: Attach all event listeners (must be last to avoid triggering during load)\r\n        attachBaseStatsEventListeners();\r\n        attachWeaponEventListeners();\r\n        attachClassSelectEventListeners();\r\n        attachTargetSelectEventListeners();\r\n        attachMasteryEventListeners();\r\n        attachCompanionsEventListeners();\r\n\r\n        // Debug: Verify store is working\r\n        const baseStats = loadoutStore.getBaseStats();\r\n        console.log('Loadout page initialized. Base stats loaded:', baseStats.ATTACK);\r\n    }\r\n}\r\n\r\n// Export singleton instance for use by router and window\r\nexport const loadoutPage = new LoadoutPage();\r\n\r\n// Expose switchToTab method to window for HTML onclick handlers\r\nwindow.loadoutSwitchToTab = (tabName: string) => loadoutPage.switchToTab(tabName);\r\n\r\n// Declare the window function for TypeScript\r\ndeclare global {\r\n    interface Window {\r\n        loadoutSwitchToTab: (tabName: string) => void;\r\n    }\r\n}"],
  "mappings": "AAAA,SAAS,gBAAgB;AACzB;AAAA,EACI;AAAA,EACA;AAAA,EACA;AAAA,OACG;AACP;AAAA,EACI;AAAA,EACA;AAAA,OACG;AACP;AAAA,EACI;AAAA,EACA;AAAA,OACG;AACP;AAAA,EACI;AAAA,EACA;AAAA,OACG;AACP;AAAA,EACI;AAAA,EACA;AAAA,EACA;AAAA,OACG;AACP;AAAA,EACI;AAAA,OACG;AACP,SAAS,oBAAoB;AAC7B,SAAS,gCAAgC,wBAAwB,wBAAwB;AAMzF,MAAM,oBAAoB,SAAS;AAAA,EAG/B,cAAc;AACV,UAAM,SAAS,YAAY;AAH/B,SAAQ,cAAuB;AAAA,EAI/B;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,cAAc,SAA8B;AAExC,UAAM,cAAc,OAAO;AAG3B,QAAI,CAAC,KAAK,aAAa;AACnB,WAAK,qBAAqB;AAC1B,WAAK,cAAc;AAAA,IACvB;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,MAAc,uBAAsC;AAEhD,UAAM,aAAa,WAAW;AAG9B,0BAAsB;AACtB,wBAAoB;AACpB,+BAA2B;AAC3B,2BAAuB;AAGvB,oBAAgB;AAChB,sBAAkB;AAClB,uBAAmB;AACnB,yBAAqB;AACrB,kBAAc;AACd,qBAAiB;AAGjB,kCAA8B;AAC9B,+BAA2B;AAC3B,oCAAgC;AAChC,qCAAiC;AACjC,gCAA4B;AAC5B,mCAA+B;AAG/B,UAAM,YAAY,aAAa,aAAa;AAC5C,YAAQ,IAAI,gDAAgD,UAAU,MAAM;AAAA,EAChF;AACJ;AAGO,MAAM,cAAc,IAAI,YAAY;AAG3C,OAAO,qBAAqB,CAAC,YAAoB,YAAY,YAAY,OAAO;",
  "names": []
}
