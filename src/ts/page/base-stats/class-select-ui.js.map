{
  "version": 3,
  "sources": ["class-select-ui.ts"],
  "sourcesContent": ["/**\r\n * DOM manipulation layer for Class Selection\r\n * All functions handle only DOM operations and delegate logic to class-select.ts\r\n */\r\n\r\nimport { updateSkillCoefficient } from './base-stats';\r\nimport { updateMasteryBonuses } from './mastery-bonus';\r\nimport type { JobTier, ClassName } from '@ts/types';\r\nimport { CLASS, JOB_TIER } from '@ts/types/constants';\r\nimport {\r\n    isStrMainStatClass,\r\n    isDexMainStatClass,\r\n    isIntMainStatClass,\r\n    isLukMainStatClass\r\n} from './class-select';\r\nimport { syncMainStatsToHidden } from './base-stats-ui';\r\nimport type { ClassConfig } from '@ts/types/page/base-stats/base-stats.types';\r\nimport { loadoutStore } from '@ts/store/loadout.store';\r\n\r\n// ============================================================================\r\n// CLASSES CONFIGURATION\r\n// ============================================================================\r\n\r\n// Classes configuration for generating class selector HTML\r\nconst CLASSES: ClassConfig[] = [\r\n    { id: CLASS.HERO, name: 'Hero', image: 'media/classes/hero.png' },\r\n    { id: CLASS.DARK_KNIGHT, name: 'Dark Knight', image: 'media/classes/dk.png' },\r\n    { id: CLASS.BOWMASTER, name: 'Bowmaster', image: 'media/classes/bowmaster.png' },\r\n    { id: CLASS.MARKSMAN, name: 'Marksman', image: 'media/classes/marksman.png' },\r\n    { id: CLASS.NIGHT_LORD, name: 'Night Lord', image: 'media/classes/nl.png' },\r\n    { id: CLASS.SHADOWER, name: 'Shadower', image: 'media/classes/shadower.png' },\r\n    { id: CLASS.ARCH_MAGE_IL, name: 'Arch Mage (I/L)', image: 'media/classes/mage-il.png' },\r\n    { id: CLASS.ARCH_MAGE_FP, name: 'Arch Mage (F/P)', image: 'media/classes/mage-fp.png' }\r\n];\r\n\r\n// ============================================================================\r\n// WINDOW GLOBALS - HTML onclick handlers\r\n// ============================================================================\r\n\r\nif (typeof window !== 'undefined') {\r\n    window.selectJobTier = selectJobTier;\r\n    window.selectClass = selectClass;\r\n    window.selectMasteryTab = selectMasteryTab;\r\n}\r\n\r\n// ============================================================================\r\n// USER INTERACTION METHODS\r\n// ============================================================================\r\n\r\n/**\r\n * Handle user clicking on a job tier button\r\n */\r\nexport function selectJobTier(tier: JobTier): void {\r\n    loadoutStore.setSelectedJobTier(tier);\r\n    updateJobTierButtonUI(tier);\r\n    updateMasteryTableVisibility(tier);\r\n    updateMasteryTabUI(tier);\r\n    updateSkillCoefficient();\r\n    updateMasteryBonuses();\r\n    //updateAnalysisTabs();\r\n}\r\n\r\n/**\r\n * Handle user clicking on a class card\r\n */\r\nexport function selectClass(className: ClassName): void {\r\n    loadoutStore.setSelectedClass(className);\r\n    updateClassSelectionUI(className);\r\n    updateClassUI(className);\r\n\r\n    try {\r\n        //updateClassWarning();\r\n    } catch (error) {\r\n        // Cube module may not be initialized yet\r\n    }\r\n}\r\n\r\n/**\r\n * Handle user clicking on a mastery tab (3rd Job / 4th Job)\r\n * Switches the visible mastery table without changing job tier state\r\n */\r\nexport function selectMasteryTab(tier: JobTier): void {\r\n    updateMasteryTabUI(tier);\r\n    updateMasteryTableVisibility(tier);\r\n}\r\n\r\n// ============================================================================\r\n// INITIALIZATION METHODS\r\n// ============================================================================\r\n\r\n/**\r\n * Initialize class select state from saved localStorage data\r\n */\r\nexport function initializeClassSelectUI(): void {\r\n    const character = loadoutStore.getCharacter();\r\n\r\n    if (character.jobTier) {\r\n        initializeJobTierState(character.jobTier);\r\n    }\r\n\r\n    if (character.class) {\r\n        initializeClassState(character.class as ClassName);\r\n    }\r\n}\r\n\r\n/**\r\n * Load class select UI from saved state\r\n */\r\nexport function loadClassSelectUI(): void {\r\n    const character = loadoutStore.getCharacter();\r\n\r\n    if (character.jobTier) {\r\n        restoreJobTierSelection(character.jobTier);\r\n    }\r\n\r\n    if (character.class) {\r\n        restoreClassSelection(character.class as ClassName);\r\n    }\r\n}\r\n\r\n// ============================================================================\r\n// STATE INITIALIZATION (UI-LESS)\r\n// ============================================================================\r\n\r\n/**\r\n * Initialize job tier state only - does NOT update UI\r\n */\r\nfunction initializeJobTierState(tier: JobTier): void {\r\n    loadoutStore.setSelectedJobTier(tier);\r\n}\r\n\r\n/**\r\n * Initialize class state only - does NOT update UI\r\n */\r\nfunction initializeClassState(className: ClassName): void {\r\n    loadoutStore.setSelectedClass(className);\r\n}\r\n\r\n// ============================================================================\r\n// UI RESTORATION\r\n// ============================================================================\r\n\r\nfunction restoreJobTierSelection(tier: JobTier): void {\r\n    updateJobTierButtonUI(tier);\r\n    updateMasteryTableVisibility(tier);\r\n    updateMasteryTabUI(tier);\r\n    updateSkillCoefficient();\r\n}\r\n\r\nfunction restoreClassSelection(className: ClassName): void {\r\n    updateClassSelectionUI(className);\r\n    updateClassUI(className);\r\n}\r\n\r\n// ============================================================================\r\n// UI HELPERS\r\n// ============================================================================\r\n\r\nfunction updateJobTierButtonUI(tier: JobTier): void {\r\n    document.querySelectorAll('.bgstats-tier-btn').forEach(el => {\r\n        el.classList.remove('active');\r\n    });\r\n\r\n    const tierElement = document.getElementById(`job-tier-${tier}`);\r\n    if (tierElement) {\r\n        tierElement.classList.add('active');\r\n    }\r\n}\r\n\r\nfunction updateClassSelectionUI(className: ClassName): void {\r\n    document.querySelectorAll('.class-selector').forEach(el => {\r\n        el.classList.remove('selected');\r\n    });\r\n\r\n    const classElement = document.getElementById(`class-${className}`);\r\n    if (classElement) {\r\n        classElement.classList.add('selected');\r\n    }\r\n}\r\n\r\nfunction updateMasteryTabUI(tier: JobTier): void {\r\n    document.querySelectorAll('.bgstats-mastery-tab').forEach(el => {\r\n        el.classList.remove('active');\r\n    });\r\n\r\n    const masteryTab = document.getElementById(`mastery-tab-${tier}`);\r\n    if (masteryTab) {\r\n        masteryTab.classList.add('active');\r\n    }\r\n}\r\n\r\nfunction updateMasteryTableVisibility(tier: JobTier): void {\r\n    const mastery3rdTable = document.getElementById('mastery-table-3rd');\r\n    const mastery4thTable = document.getElementById('mastery-table-4th');\r\n\r\n    if (!mastery3rdTable || !mastery4thTable) return;\r\n\r\n    if (tier === JOB_TIER.THIRD) {\r\n        mastery3rdTable.style.display = 'block';\r\n        mastery4thTable.style.display = 'none';\r\n    } else if (tier === JOB_TIER.FOURTH) {\r\n        mastery3rdTable.style.display = 'none';\r\n        mastery4thTable.style.display = 'block';\r\n    }\r\n}\r\n\r\n/**\r\n * Update UI elements that depend on the selected class\r\n * Defense input only shows for Dark Knight\r\n */\r\nfunction updateClassUI(className: ClassName): void {\r\n    const defenseInputGroup = document.getElementById('defense-input-group');\r\n    if (defenseInputGroup) {\r\n        defenseInputGroup.style.display = className === CLASS.DARK_KNIGHT ? 'flex' : 'none';\r\n    }\r\n\r\n    const strRow = document.getElementById('str-row');\r\n    const dexRow = document.getElementById('dex-row');\r\n    const intRow = document.getElementById('int-row');\r\n    const lukRow = document.getElementById('luk-row');\r\n\r\n    if (strRow) strRow.style.display = 'none';\r\n    if (dexRow) dexRow.style.display = 'none';\r\n    if (intRow) intRow.style.display = 'none';\r\n    if (lukRow) lukRow.style.display = 'none';\r\n\r\n    if (isStrMainStatClass(className)) {\r\n        if (strRow) strRow.style.display = 'flex';\r\n        if (dexRow) dexRow.style.display = 'flex';\r\n    } else if (isDexMainStatClass(className)) {\r\n        if (dexRow) dexRow.style.display = 'flex';\r\n        if (strRow) strRow.style.display = 'flex';\r\n    } else if (isIntMainStatClass(className)) {\r\n        if (intRow) intRow.style.display = 'flex';\r\n        if (lukRow) lukRow.style.display = 'flex';\r\n    } else if (isLukMainStatClass(className)) {\r\n        if (lukRow) lukRow.style.display = 'flex';\r\n        if (dexRow) dexRow.style.display = 'flex';\r\n    }\r\n\r\n    syncMainStatsToHidden();\r\n}\r\n\r\n// ============================================================================\r\n// EVENT LISTENERS\r\n// ============================================================================\r\n\r\n/**\r\n * Attach event listeners to class selector cards\r\n */\r\nfunction attachClassSelectorListeners(): void {\r\n    CLASSES.forEach(cls => {\r\n        const element = document.getElementById(`class-${cls.id}`);\r\n        if (element) {\r\n            element.addEventListener('click', () => selectClass(cls.id));\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * Attach event listeners to job tier buttons\r\n */\r\nfunction attachJobTierListeners(): void {\r\n    const tier3rd = document.getElementById('job-tier-3rd');\r\n    const tier4th = document.getElementById('job-tier-4th');\r\n\r\n    if (tier3rd) {\r\n        tier3rd.addEventListener('click', () => selectJobTier(JOB_TIER.THIRD));\r\n    }\r\n    if (tier4th) {\r\n        tier4th.addEventListener('click', () => selectJobTier(JOB_TIER.FOURTH));\r\n    }\r\n}\r\n\r\n/**\r\n * Attach all event listeners for class select UI\r\n */\r\nexport function attachClassSelectEventListeners(): void {\r\n    attachClassSelectorListeners();\r\n    attachJobTierListeners();\r\n}\r\n\r\n// ============================================================================\r\n// HTML GENERATION\r\n// ============================================================================\r\n\r\n/**\r\n * Generate HTML for class selector cards\r\n */\r\nexport function generateClassSelectorHTML(): string {\r\n    return CLASSES.map(cls => `\r\n        <div id=\"class-${cls.id}\" class=\"class-selector bgstats-class-card\" title=\"${cls.title || cls.name}\">\r\n            <div class=\"bgstats-class-image-wrapper\">\r\n                <img src=\"${cls.image}\" alt=\"${cls.name}\" class=\"bgstats-class-image\">\r\n            </div>\r\n            <span class=\"bgstats-class-name\">${cls.name}</span>\r\n        </div>\r\n    `).join('');\r\n}\r\n"],
  "mappings": "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",
  "names": []
}
