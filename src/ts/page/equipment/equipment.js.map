{
  "version": 3,
  "sources": ["equipment.ts"],
  "sourcesContent": ["/**\r\n * Equipment Logic - Core business logic for equipment management\r\n * Handles data operations, state management, and calculations\r\n */\r\n\r\nimport type {\r\n    EquipmentSlotId,\r\n    EquipmentData,\r\n    EquipmentSlotData,\r\n    StatLineType,\r\n    EquipmentSlotStats,\r\n    EquipmentContributions,\r\n    EquipmentSlotConfig,\r\n} from '@ts/types/page/equipment/equipment.types';\r\nimport { STAT_KEY_MAP } from '@ts/types/page/equipment/equipment.types';\r\nimport { availableStats } from '@core/constants';\r\nimport { loadoutStore } from '@ts/store/loadout.store';\r\n\r\n// ============================================================================\r\n// EQUIPMENT SLOT DEFINITIONS\r\n// ============================================================================\r\n\r\n/**\r\n * All equipment slot configurations\r\n */\r\nexport const EQUIPMENT_SLOTS: readonly EquipmentSlotConfig[] = [\r\n    { id: 'head', name: 'Head', hasMainStat: false },\r\n    { id: 'cape', name: 'Cape', hasMainStat: false },\r\n    { id: 'chest', name: 'Chest', hasMainStat: false },\r\n    { id: 'shoulders', name: 'Shoulders', hasMainStat: false },\r\n    { id: 'legs', name: 'Legs', hasMainStat: false },\r\n    { id: 'belt', name: 'Belt', hasMainStat: false },\r\n    { id: 'gloves', name: 'Gloves', hasMainStat: false },\r\n    { id: 'boots', name: 'Boots', hasMainStat: false },\r\n    { id: 'ring', name: 'Ring', hasMainStat: true },\r\n    { id: 'neck', name: 'Neck', hasMainStat: true },\r\n    { id: 'eye-accessory', name: 'Eye Accessory', hasMainStat: true }\r\n] as const;\r\n\r\n// ============================================================================\r\n// STATE MANAGEMENT\r\n// ============================================================================\r\n\r\n/**\r\n * In-memory equipment data store\r\n */\r\nlet equipmentData: EquipmentData = {\r\n    head: null,\r\n    cape: null,\r\n    chest: null,\r\n    shoulders: null,\r\n    legs: null,\r\n    belt: null,\r\n    gloves: null,\r\n    boots: null,\r\n    ring: null,\r\n    neck: null,\r\n    'eye-accessory': null\r\n};\r\n\r\n// ============================================================================\r\n// DATA OPERATIONS\r\n// ============================================================================\r\n\r\n/**\r\n * Get data for a specific equipment slot\r\n */\r\nexport function getSlotData(slotId: EquipmentSlotId): EquipmentSlotData | null {\r\n    return equipmentData[slotId];\r\n}\r\n\r\n/**\r\n * Get all equipment data\r\n */\r\nexport function getAllEquipmentData(): EquipmentData {\r\n    return equipmentData;\r\n}\r\n\r\n/**\r\n * Set equipment data for a specific slot\r\n * Updates both in-memory store and localStorage\r\n */\r\nexport function setSlotData(slotId: EquipmentSlotId, data: EquipmentSlotData): void {\r\n    equipmentData[slotId] = data;\r\n    saveSlotToStorage(slotId, data);\r\n}\r\n\r\n/**\r\n * Clear all data for a specific slot\r\n */\r\nexport function clearSlotData(slotId: EquipmentSlotId): void {\r\n    const emptyData: EquipmentSlotData = {\r\n        name: '',\r\n        attack: 0,\r\n        mainStat: 0,\r\n        statLines: []\r\n    };\r\n    setSlotData(slotId, emptyData);\r\n}\r\n\r\n/**\r\n * Load equipment data from loadout store for all slots\r\n */\r\nexport function loadAllEquipmentData(): void {\r\n    const storeData = loadoutStore.getEquipmentData();\r\n    EQUIPMENT_SLOTS.forEach(slot => {\r\n        equipmentData[slot.id] = storeData[slot.id];\r\n    });\r\n}\r\n\r\n/**\r\n * Save a single slot's data via loadout store\r\n */\r\nfunction saveSlotToStorage(slotId: EquipmentSlotId, data: EquipmentSlotData): void {\r\n    loadoutStore.updateEquipment(slotId, data);\r\n}\r\n\r\n/**\r\n * Create empty slot data with defaults\r\n */\r\nexport function createEmptySlotData(hasMainStat: boolean): EquipmentSlotData {\r\n    return {\r\n        name: '',\r\n        attack: 0,\r\n        mainStat: hasMainStat ? 0 : undefined,\r\n        statLines: []\r\n    };\r\n}\r\n\r\n// ============================================================================\r\n// STAT LINE OPERATIONS\r\n// ============================================================================\r\n\r\n/**\r\n * Get available stat types for dropdown\r\n */\r\nexport function getAvailableStats(): Array<{ value: string; label: string }> {\r\n    return availableStats;\r\n}\r\n\r\n/**\r\n * Convert stat type string to property key\r\n */\r\nexport function getStatKey(statType: StatLineType): keyof EquipmentSlotStats | null {\r\n    return STAT_KEY_MAP[statType] || null;\r\n}\r\n\r\n// ============================================================================\r\n// CALCULATIONS\r\n// ============================================================================\r\n\r\n/**\r\n * Calculate stat contributions from a single equipment slot\r\n */\r\nexport function calculateSlotContributions(\r\n    slotConfig: EquipmentSlotConfig,\r\n    slotData: EquipmentSlotData | null\r\n): EquipmentSlotStats | null {\r\n    if (!slotData) return null;\r\n\r\n    const stats: EquipmentSlotStats = {\r\n        attack: slotData.attack || 0\r\n    };\r\n\r\n    // Add main stat if applicable\r\n    if (slotConfig.hasMainStat && slotData.mainStat !== undefined) {\r\n        stats.mainStat = slotData.mainStat;\r\n    }\r\n\r\n    // Add stat lines\r\n    if (slotData.statLines && Array.isArray(slotData.statLines)) {\r\n        slotData.statLines.forEach(statLine => {\r\n            const statKey = getStatKey(statLine.type);\r\n            if (statKey) {\r\n                stats[statKey] = (stats[statKey] || 0) + statLine.value;\r\n            }\r\n        });\r\n    }\r\n\r\n    return stats;\r\n}\r\n\r\n/**\r\n * Calculate all stat contributions from equipment\r\n * Returns contributions keyed by slot ID\r\n */\r\nexport function calculateAllContributions(): EquipmentContributions {\r\n    const contributions: Partial<EquipmentContributions> = {};\r\n\r\n    EQUIPMENT_SLOTS.forEach(slot => {\r\n        contributions[slot.id] = calculateSlotContributions(slot, equipmentData[slot.id]);\r\n    });\r\n\r\n    return contributions as EquipmentContributions;\r\n}\r\n\r\n/**\r\n * Get slot configuration by ID\r\n */\r\nexport function getSlotConfig(slotId: EquipmentSlotId): EquipmentSlotConfig | undefined {\r\n    return EQUIPMENT_SLOTS.find(slot => slot.id === slotId);\r\n}\r\n\r\n/**\r\n * Check if a slot exists\r\n */\r\nexport function isValidSlot(slotId: string): slotId is EquipmentSlotId {\r\n    return EQUIPMENT_SLOTS.some(slot => slot.id === slotId);\r\n}\r\n"],
  "mappings": "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",
  "names": []
}
