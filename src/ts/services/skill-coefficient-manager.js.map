{
  "version": 3,
  "sources": ["skill-coefficient-manager.ts"],
  "sourcesContent": ["/**\n * Skill Coefficient Manager\n *\n * Listens for changes to character level and skill levels (3rd/4th/all)\n * and automatically updates the SKILL_COEFFICIENT stat in the loadout store.\n *\n * This provides an event-driven approach to keeping skill coefficients\n * in sync with the underlying character data.\n */\n\nimport { loadoutStore } from '@ts/store/loadout.store';\nimport { calculate3rdJobSkillCoefficient, calculate4thJobSkillCoefficient } from '@ts/services/skill-coefficient.service';\nimport { JOB_TIER } from '@ts/types/constants';\n\n/**\n * Manages skill coefficient updates through event subscriptions\n */\nclass SkillCoefficientManager {\n    private unsubscribeFunctions: (() => void)[] = [];\n    private isInitialized: boolean = false;\n\n    /**\n     * Initialize the manager and subscribe to relevant events\n     * Call this during app initialization\n     */\n    initialize(): void {\n        if (this.isInitialized) {\n            console.warn('SkillCoefficientManager already initialized');\n            return;\n        }\n\n        // Subscribe to skill level changes\n        this.unsubscribeFunctions.push(\n            loadoutStore.on('skill:level:changed', () => {\n                this.updateSkillCoefficient();\n            })\n        );\n\n        // Subscribe to character level changes\n        this.unsubscribeFunctions.push(\n            loadoutStore.on('character:level:changed', () => {\n                this.updateSkillCoefficient();\n            })\n        );\n\n        // Subscribe to job tier changes\n        this.unsubscribeFunctions.push(\n            loadoutStore.on('character:jobtier:changed', () => {\n                this.updateSkillCoefficient();\n            })\n        );\n\n        // Calculate initial coefficient on load to ensure it's up-to-date\n        this.updateSkillCoefficient();\n\n        this.isInitialized = true;\n    }\n\n    /**\n     * Update the skill coefficient based on current character data\n     * Reads from the store and writes back to the store\n     */\n    private updateSkillCoefficient(): void {\n        const character = loadoutStore.getCharacter();\n        const baseStats = loadoutStore.getBaseStats();\n\n        let coefficient: number;\n\n        // Calculate coefficient based on job tier\n        if (character.jobTier === JOB_TIER.FOURTH) {\n            coefficient = calculate4thJobSkillCoefficient(\n                character.level,\n                baseStats.SKILL_LEVEL_4TH + baseStats.SKILL_LEVEL_ALL\n            );\n        } else if (character.jobTier === JOB_TIER.THIRD) {\n            coefficient = calculate3rdJobSkillCoefficient(\n                character.level,\n                baseStats.SKILL_LEVEL_3RD + baseStats.SKILL_LEVEL_ALL\n            );\n        } else {\n            // Not applicable for 1st/2nd job\n            return;\n        }\n\n        // Update the coefficient in the store\n        loadoutStore.updateBaseStat('SKILL_COEFFICIENT', coefficient);\n    }\n\n    /**\n     * Clean up event subscriptions\n     * Call this during app teardown (if applicable)\n     */\n    destroy(): void {\n        this.unsubscribeFunctions.forEach(fn => fn());\n        this.unsubscribeFunctions = [];\n        this.isInitialized = false;\n    }\n\n    /**\n     * Check if manager is initialized\n     */\n    isActive(): boolean {\n        return this.isInitialized;\n    }\n}\n\n// Export singleton instance\nexport const skillCoefficientManager = new SkillCoefficientManager();\n"],
  "mappings": "AAUA,SAAS,oBAAoB;AAC7B,SAAS,iCAAiC,uCAAuC;AACjF,SAAS,gBAAgB;AAKzB,MAAM,wBAAwB;AAAA,EAA9B;AACI,SAAQ,uBAAuC,CAAC;AAChD,SAAQ,gBAAyB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMjC,aAAmB;AACf,QAAI,KAAK,eAAe;AACpB,cAAQ,KAAK,6CAA6C;AAC1D;AAAA,IACJ;AAGA,SAAK,qBAAqB;AAAA,MACtB,aAAa,GAAG,uBAAuB,MAAM;AACzC,aAAK,uBAAuB;AAAA,MAChC,CAAC;AAAA,IACL;AAGA,SAAK,qBAAqB;AAAA,MACtB,aAAa,GAAG,2BAA2B,MAAM;AAC7C,aAAK,uBAAuB;AAAA,MAChC,CAAC;AAAA,IACL;AAGA,SAAK,qBAAqB;AAAA,MACtB,aAAa,GAAG,6BAA6B,MAAM;AAC/C,aAAK,uBAAuB;AAAA,MAChC,CAAC;AAAA,IACL;AAGA,SAAK,uBAAuB;AAE5B,SAAK,gBAAgB;AAAA,EACzB;AAAA;AAAA;AAAA;AAAA;AAAA,EAMQ,yBAA+B;AACnC,UAAM,YAAY,aAAa,aAAa;AAC5C,UAAM,YAAY,aAAa,aAAa;AAE5C,QAAI;AAGJ,QAAI,UAAU,YAAY,SAAS,QAAQ;AACvC,oBAAc;AAAA,QACV,UAAU;AAAA,QACV,UAAU,kBAAkB,UAAU;AAAA,MAC1C;AAAA,IACJ,WAAW,UAAU,YAAY,SAAS,OAAO;AAC7C,oBAAc;AAAA,QACV,UAAU;AAAA,QACV,UAAU,kBAAkB,UAAU;AAAA,MAC1C;AAAA,IACJ,OAAO;AAEH;AAAA,IACJ;AAGA,iBAAa,eAAe,qBAAqB,WAAW;AAAA,EAChE;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,UAAgB;AACZ,SAAK,qBAAqB,QAAQ,QAAM,GAAG,CAAC;AAC5C,SAAK,uBAAuB,CAAC;AAC7B,SAAK,gBAAgB;AAAA,EACzB;AAAA;AAAA;AAAA;AAAA,EAKA,WAAoB;AAChB,WAAO,KAAK;AAAA,EAChB;AACJ;AAGO,MAAM,0BAA0B,IAAI,wBAAwB;",
  "names": []
}
